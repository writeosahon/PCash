"use strict";var _utopiasoftware$saveu;function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}utopiasoftware.saveup.controller=(_utopiasoftware$saveu={appReady:function appReady(){ons.ready(function(){ons.setDefaultDeviceBackButtonListener(function(){console.log("DEFAULT BACK BUTTON LISTENER")});document.addEventListener("hold",function(event){if($(event.target).closest("#security-pin-lock-backspace","#security-pin-lock-modal").is("#security-pin-lock-backspace")){$("#security-pin-lock-modal #security-pin-lock-pin").val("");return}});if(utopiasoftware.saveup.model.isAppReady===false){$("#loader-modal-message").html("Preparing App...");$("#loader-modal").get(0).show()}if(window.localStorage.getItem("app-status")&&window.localStorage.getItem("app-status")!=""){$("ons-splitter").get(0).content.load("login-template")}else{$("ons-splitter").get(0).content.load("onboarding-template")}$("#verify-account-bottom-sheet").modal({ready:function ready(){$("#verify-account-bottom-sheet").data("saveupSheetState","open")},complete:function complete(){$("#verify-account-bottom-sheet").data("saveupSheetState","closed")}});$("#privacy-policy-fixed-modal").modal({ready:function ready(){$("#privacy-policy-fixed-modal").data("fixedModalState","open")},complete:function complete(){$("#privacy-policy-fixed-modal").data("fixedModalState","closed")}});$("#terms-of-use-fixed-modal").modal({ready:function ready(){$("#terms-of-use-fixed-modal").data("fixedModalState","open")},complete:function complete(){$("#terms-of-use-fixed-modal").data("fixedModalState","closed")}});$("#security-pin-lock-modal").get(0).onDeviceBackButton=utopiasoftware.saveup.controller.securityPinLockModalViewModel.exitButtonClicked;$("#transfer-cash-card-authorise-modal").get(0).onDeviceBackButton=function(){$("#transfer-cash-card-authorise-modal").get(0).hide();$("#transfer-cash-card-authorise-iframe").attr("src","")};$("#transfer-cash-bank-authorise-modal").get(0).onDeviceBackButton=function(){$("#transfer-cash-bank-authorise-modal").get(0).hide();$("#transfer-cash-bank-authorise-iframe").attr("src","")}});Parsley.addAsyncValidator("financialcardcheck",utopiasoftware.saveup.controller.addCardPageViewModel.financialCardValidator,utopiasoftware.saveup.paystackObject.gateway+"decision/bin/{value}");Parsley.addAsyncValidator("accountnumbercheck",utopiasoftware.saveup.controller.addAccountPageViewModel.accountNumberValidator,utopiasoftware.saveup.moneyWaveObject.gateway+"v1/resolve/account");Parsley.addAsyncValidator("recipientaccountnumbercheck",utopiasoftware.saveup.controller.addRecipientPageViewModel.recipientAccountNumberValidator,utopiasoftware.saveup.moneyWaveObject.gateway+"v1/resolve/account");document.addEventListener("offline",function(){window.plugins.toast.showWithOptions({message:"No Internet Connection. App functionality may be limited",duration:4e3,position:"bottom",styling:{opacity:1,backgroundColor:"#000000",textColor:"#FFFFFF",textSize:14}})},false);document.addEventListener("pause",utopiasoftware.saveup.controller.onShowSecurityLockModal=function(){if($("#login-tabbar").get(0)&&$("#login-tabbar").get(0).visible){return}if($("#onboarding-navigator").get(0)&&$("#onboarding-navigator").get(0).topPage.alwaysShowSecurityLockModal==false){return}if($("#app-main-navigator").get(0)&&$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal==false){return}if(!utopiasoftware.saveup.model.appUserDetails.settings||utopiasoftware.saveup.model.appUserDetails.settings.alwaysShowSecurityLockModal!==false){$("#security-pin-lock-modal #security-pin-lock-message").html("");if($("#pin-security-check").get(0)&&$("#pin-security-check").get(0).visible){$("#pin-security-check").remove()}cordova.plugins.Keyboard.close();$("#security-pin-lock-modal").get(0).show()}},false);window.addEventListener("message",function(event){try{if(event.origin=="https://postcash.000webhostapp.com"&&event.data=="c done"){utopiasoftware.saveup.controller.transferCashCardPageViewModel.transferCashCardOtpAuthorize();return}if(event.origin=="https://postcash.000webhostapp.com"&&event.data=="b loaded"){utopiasoftware.saveup.controller.transferCashBankPageViewModel.transferCashBankRemoteAuthorize("stage 1");return}if(event.origin=="https://postcash.000webhostapp.com"&&JSON.parse(event.data)&&JSON.parse(event.data).state=="b completed"){utopiasoftware.saveup.controller.transferCashBankPageViewModel.transferCashBankRemoteAuthorize("stage 2",JSON.parse(event.data));return}}catch(err){}},false);try{screen.lockOrientation("portrait")}catch(err){}StatusBar.backgroundColorByHexString("#000000");window.open=cordova.InAppBrowser.open;new Promise(function(resolve,reject){window.plugins.uniqueDeviceID.get(resolve,reject)}).then(function(deviceUUID){utopiasoftware.saveup.model.deviceUUID=deviceUUID;return}).then(function(){if(!window.localStorage.getItem("app-status")||window.localStorage.getItem("app-status")==""){return null}return Promise.resolve(intel.security.secureStorage.read({id:"postcash-user-details"}))}).then(function(instanceId){if(instanceId==null){return null}return Promise.resolve(intel.security.secureData.getData(instanceId))}).then(function(secureData){if(secureData==null){return null}utopiasoftware.saveup.model.appUserDetails=JSON.parse(secureData);$("#side-menu-username").html(utopiasoftware.saveup.model.appUserDetails.firstName);return null}).then(function(){return new Promise(function(resolve,reject){hockeyapp.start(resolve,reject,"fcb296e2bce24c5a8e9eedcf079f9b47")})}).then(function(){return new Promise(function(resolve,reject){var promisesArray=[];promisesArray.push(new Promise(function(resolve2,reject2){window.plugins.sslCertificateChecker.check(resolve2,function(message){if(message.indexOf("CONNECTION_FAILED")>-1){resolve2()}else{reject2()}},"https://live.moneywaveapi.co","c2 b1 e6 b9 64 3c 12 d7 1b 57 8e 2c 81 63 5c 7f 8a 78 8e 60")}));promisesArray.push(new Promise(function(resolve2,reject2){window.plugins.sslCertificateChecker.check(resolve2,function(message){if(message.indexOf("CONNECTION_FAILED")>-1){resolve2()}else{reject2()}},"https://api.paystack.co","36 7f e8 f1 48 97 87 81 9c 4f c7 d4 96 55 3e 1b 37 45 1e a7")}));Promise.all(promisesArray).then(function(){resolve()}).catch(function(){reject()})})}).then(function(){window.plugins.OneSignal.startInit("2058559d-c18d-4023-87da-b9b28dba1c96").inFocusDisplaying(window.plugins.OneSignal.OSInFocusDisplayOption.Notification).handleNotificationReceived(function(){}).handleNotificationOpened(function(){}).endInit()}).then(function(){utopiasoftware.saveup.model.isAppReady=true;navigator.splashscreen.hide()}).catch(function(){utopiasoftware.saveup.model.deviceUUID="";utopiasoftware.saveup.model.isAppReady=true;navigator.splashscreen.hide();window.plugins.toast.showWithOptions({message:"Startup Error. App functionality may be limited. Always update the app to "+"get the best secure experience. Please contact us if problem continues",duration:5e3,position:"bottom",styling:{opacity:1,backgroundColor:"#000000",textColor:"#FFFFFF",textSize:14}})})},createAppSecondaryMenus:function createAppSecondaryMenus(popOverQuerySelector,targetElem){$(popOverQuerySelector).get(0).show(targetElem)},pinSecurityCheckPreShow:function pinSecurityCheckPreShow(){$("#pin-security-check").find("input").addClass("utopiasoftware-no-style")},appSecondaryMenuListClicked:function appSecondaryMenuListClicked(label){if(label=="sign out"){window.sessionStorage.clear();$("#secondary-menu-options").get(0).hide().then(function(){$("ons-splitter").get(0).content.load("login-template")}).catch();return}if(label=="share app"){var security_lock_modal_flag=$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal;var shareOptions={message:"download PostCash app. A secure digital wallet for easy money transfer in Nigeria",files:null,subject:"download PostCash app",chooserTitle:"share PostCash with...",url:"https://jh8tj.app.goo.gl/rniX"};$("#secondary-menu-options").get(0).hide().then(function(){$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal=false;return new Promise(function(resolve,reject){window.plugins.toast.showWithOptions({message:"share link was also copied to device memory, so you can paste easily!",duration:5e3,position:"top",styling:{opacity:1,backgroundColor:"#808080",textColor:"#FFFFFF",textSize:14}},function(toastEvent){if(toastEvent&&toastEvent.event=="touch"){window.plugins.toast.hide()}});window.setTimeout(function(){cordova.plugins.clipboard.copy(shareOptions.message+"\n"+shareOptions.url,resolve,resolve)},3800)})}).then(function(){return new Promise(function(resolve,reject){window.plugins.socialsharing.shareWithOptions(shareOptions,resolve,reject)})}).then(function(){$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal=security_lock_modal_flag;utopiasoftware.saveup.controller.onShowSecurityLockModal()}).catch(function(){window.plugins.toast.showWithOptions({message:"app share link could not be created. Try again",duration:4e3,position:"top",styling:{opacity:1,backgroundColor:"#ff0000",textColor:"#FFFFFF",textSize:14}},function(toastEvent){if(toastEvent&&toastEvent.event=="touch"){window.plugins.toast.hide()}})});return}if(label=="rate app"){$("#secondary-menu-options").get(0).hide().then(function(){cordova.InAppBrowser.open("market://details?id=utopiasoftware.writeosahon.postcash","_system")}).catch();return}},sideMenuViewModel:{sideMenuListClicked:function sideMenuListClicked(label){if(label=="transfer cash"){$("ons-splitter").get(0).left.close().then(function(){return ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true})}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#transfer-cash-page").remove();$("#app-main-navigator").get(0).pushPage("transfer-cash-page.html",{})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}if(label=="verify account"){$("ons-splitter").get(0).left.close().then(function(){$("#app-main-navigator").get(0).bringPageTop("verify-account-page.html",{})}).catch(function(){});return}if(label=="my cards"){$("ons-splitter").get(0).left.close().then(function(){return ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true})}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#app-main-navigator").get(0).bringPageTop("my-cards-page.html",{})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}if(label=="my accounts"){$("ons-splitter").get(0).left.close().then(function(){return ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true})}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#app-main-navigator").get(0).bringPageTop("my-accounts-page.html",{})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}if(label=="saved recipients"){$("ons-splitter").get(0).left.close().then(function(){return ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true})}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#app-main-navigator").get(0).bringPageTop("saved-recipients-page.html",{})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}if(label=="intro"){$("ons-splitter").get(0).left.close().then(function(){$("#app-main-navigator").get(0).bringPageTop("onboarding-page.html",{})}).catch(function(){});return}if(label=="transaction history"){$("ons-splitter").get(0).left.close().then(function(){return ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true})}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#app-main-navigator").get(0).bringPageTop("transaction-history-page.html",{})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}if(label=="settings"){$("ons-splitter").get(0).left.close().then(function(){$("#app-main-navigator").get(0).bringPageTop("settings-page.html",{})}).catch();return}if(label=="contact us"){$("ons-splitter").get(0).left.close().then(function(){$("#app-main-navigator").get(0).bringPageTop("contact-us-page.html",{})}).catch();return}if(label=="app info"){$("ons-splitter").get(0).left.close().then(function(){$("#app-main-navigator").get(0).bringPageTop("app-info-page.html",{})}).catch();return}}},securityPinLockModalViewModel:{$pinLockInputField:null,clearTimeoutId:-1,numberButtonClicked:function numberButtonClicked(numberInput){if(!utopiasoftware.saveup.controller.securityPinLockModalViewModel.$pinLockInputField){utopiasoftware.saveup.controller.securityPinLockModalViewModel.$pinLockInputField=$("#security-pin-lock-modal #security-pin-lock-pin")}$("#security-pin-lock-modal #security-pin-lock-message").html("");utopiasoftware.saveup.controller.securityPinLockModalViewModel.$pinLockInputField.val(utopiasoftware.saveup.controller.securityPinLockModalViewModel.$pinLockInputField.val()+numberInput);utopiasoftware.saveup.controller.securityPinLockModalViewModel.$pinLockInputField.css("-webkit-text-security","none");window.clearTimeout(utopiasoftware.saveup.controller.securityPinLockModalViewModel.clearTimeoutId);utopiasoftware.saveup.controller.securityPinLockModalViewModel.clearTimeoutId=setTimeout(function(){utopiasoftware.saveup.controller.securityPinLockModalViewModel.$pinLockInputField.css("-webkit-text-security","disc")},1e3)},exitButtonClicked:function exitButtonClicked(){ons.notification.confirm("Do you want to close the app?",{title:"Exit",buttonLabels:["No","Yes"]}).then(function(index){if(index===1){navigator.app.exitApp()}})},okButtonClicked:function okButtonClicked(){if(!utopiasoftware.saveup.controller.securityPinLockModalViewModel.$pinLockInputField){utopiasoftware.saveup.controller.securityPinLockModalViewModel.$pinLockInputField=$("#security-pin-lock-modal #security-pin-lock-pin")}if(utopiasoftware.saveup.controller.securityPinLockModalViewModel.$pinLockInputField.val()===utopiasoftware.saveup.model.appUserDetails.securePin){$("#security-pin-lock-modal").get(0).hide()}else{$("#security-pin-lock-modal #security-pin-lock-message").html("WRONG INPUT!")}utopiasoftware.saveup.controller.securityPinLockModalViewModel.$pinLockInputField.val("")},backspaceButtonClicked:function backspaceButtonClicked(){if(!utopiasoftware.saveup.controller.securityPinLockModalViewModel.$pinLockInputField){utopiasoftware.saveup.controller.securityPinLockModalViewModel.$pinLockInputField=$("#security-pin-lock-modal #security-pin-lock-pin")}var inputString=$("#security-pin-lock-modal #security-pin-lock-pin").val();$("#security-pin-lock-modal #security-pin-lock-pin").val(inputString.substring(0,inputString.length-1))},preventContextMenuForInput:function preventContextMenuForInput(event){event.preventDefault();event.stopPropagation();return false}},signInPageViewModel:{formValidator:null,pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-input input",$thisPage).addClass("utopiasoftware-no-style");$("ons-splitter-side").removeAttr("swipeable");loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$thisPage.get(0).onDeviceBackButton=function(){ons.notification.confirm("Do you want to close the app?",{title:"Exit",buttonLabels:["No","Yes"]}).then(function(index){if(index===1){navigator.app.exitApp()}})};if(window.localStorage.getItem("app-status")&&window.localStorage.getItem("app-status")!=""){$("#login-form #user-phone").val(utopiasoftware.saveup.model.appUserDetails.phoneNumber)}utopiasoftware.saveup.controller.signInPageViewModel.formValidator=$("#login-form").parsley();$("#login-signin").get(0).onclick=function(){utopiasoftware.saveup.controller.signInPageViewModel.formValidator.whenValidate()};utopiasoftware.saveup.controller.signInPageViewModel.formValidator.on("field:error",function(fieldInstance){$(fieldInstance.$element).addClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).attr("data-hint",fieldInstance.getErrorsMessages()[0])});utopiasoftware.saveup.controller.signInPageViewModel.formValidator.on("field:success",function(fieldInstance){$(fieldInstance.$element).removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).removeAttr("data-hint")});utopiasoftware.saveup.controller.signInPageViewModel.formValidator.on("form:success",utopiasoftware.saveup.controller.signInPageViewModel.signinFormValidated);$("#loader-modal").get(0).hide();$("ons-icon.first,ons-icon.second",$thisPage).addClass("animated swing");setTimeout(function(){$("#login-create-account",$thisPage).removeClass("pulse")},4e3)}},pageHide:function pageHide(event){try{$("#sign-in-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#sign-in-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.signInPageViewModel.formValidator.reset()}catch(err){}},pageDestroy:function pageDestroy(event){try{$("#sign-in-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#sign-in-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.signInPageViewModel.formValidator.destroy()}catch(err){}},signinFormValidated:function signinFormValidated(){$("#loader-modal-message").html("Signing In...");$("#loader-modal").get(0).show();if(utopiasoftware.saveup.model.appUserDetails&&$("#login-form #user-phone").val()===utopiasoftware.saveup.model.appUserDetails.phoneNumber&&$("#login-form #secure-pin").val()===utopiasoftware.saveup.model.appUserDetails.securePin){$("#loader-modal").get(0).hide();$("#side-menu-username").html(utopiasoftware.saveup.model.appUserDetails.firstName);$("ons-splitter").get(0).content.load("app-main-template");Materialize.toast("Welcome "+utopiasoftware.saveup.model.appUserDetails.firstName,4e3)}else{$("#loader-modal").get(0).hide();ons.notification.alert({title:"Sign In Failed",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Invalid Credentials"+"</span>",cancelable:false})}},createAccountButtonClicked:function createAccountButtonClicked(){$("#login-tabbar").get(0).setActiveTab(1,{animation:"slide"})},forgotPinButtonClicked:function forgotPinButtonClicked(element){$("#forgot-pin-popover").get(0).show(element,{})}},createAccountPageViewModel:{formValidator:null,pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-input input",$thisPage).addClass("utopiasoftware-no-style");loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$thisPage.get(0).onDeviceBackButton=function(){$("#login-tabbar").get(0).setActiveTab(0,{animation:"slide"})};utopiasoftware.saveup.controller.createAccountPageViewModel.formValidator=$("#create-account-form").parsley();$("#create-account-button").get(0).onclick=function(){utopiasoftware.saveup.controller.createAccountPageViewModel.formValidator.whenValidate()};utopiasoftware.saveup.controller.createAccountPageViewModel.formValidator.on("field:error",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").addClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").attr("data-hint",fieldInstance.getErrorsMessages()[0])});utopiasoftware.saveup.controller.createAccountPageViewModel.formValidator.on("field:success",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").removeAttr("data-hint")});utopiasoftware.saveup.controller.createAccountPageViewModel.formValidator.on("form:success",utopiasoftware.saveup.controller.createAccountPageViewModel.createAccountFormValidated);$("#loader-modal").get(0).hide()}},pageHide:function pageHide(event){try{$("#create-account-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#create-account-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.createAccountPageViewModel.formValidator.reset()}catch(err){}},pageDestroy:function pageDestroy(event){try{$("#create-account-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#create-account-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.createAccountPageViewModel.formValidator.destroy()}catch(err){}},createAccountFormValidated:function createAccountFormValidated(){new Promise(function(resolve,reject){ons.notification.confirm("To complete sign up, your phone number must be verified. <br>"+"Usual SMS charge from your phone network provider will apply.<br> "+"Please ensure you have sufficient airtime to send/receive one SMS",{title:"Verify Phone Number",buttonLabels:["Cancel","Ok"]}).then(function(index){if(index===1){resolve()}else{reject("your phone number could not be verified")}})}).then(function(){return utopiasoftware.saveup.validatePhoneNumber($("#create-phone").val())}).then(function(){$("#loader-modal-message").html("Completing Sign Up...");return Promise.resolve($("#loader-modal").get(0).show())}).then(function(){var promisesArray=[];var promiseObject=new Promise(function(resolve,reject){Promise.resolve(intel.security.secureStorage.delete({id:"postcash-user-details"})).then(function(){resolve()},function(){resolve()})});promisesArray.push(promiseObject);promiseObject=new Promise(function(resolve,reject){utopiasoftware.saveup.financialCardOperations.deleteAllCards().then(function(){resolve()},function(){resolve()})});promisesArray.push(promiseObject);promiseObject=new Promise(function(resolve,reject){utopiasoftware.saveup.bankAccountOperations.deleteAllMyAccounts().then(function(){resolve()},function(){resolve()})});promisesArray.push(promiseObject);promiseObject=new Promise(function(resolve,reject){utopiasoftware.saveup.savedRecipientsBankAccountOperations.deleteAllSavedRecipientAccounts().then(function(){resolve()},function(){resolve()})});promisesArray.push(promiseObject);promiseObject=new Promise(function(resolve,reject){utopiasoftware.saveup.transactionHistoryOperations.deleteAllTransactionHistory().then(function(){resolve()},function(){resolve()})});promisesArray.push(promiseObject);return Promise.all(promisesArray)}).then(function(){window.localStorage.clear();window.sessionStorage.clear();return null}).then(function(){utopiasoftware.saveup.model.appUserDetails={firstName:$("#create-account-form #create-first-name").val(),lastName:$("#create-account-form #create-last-name").val(),phoneNumber:$("#create-account-form #create-phone").val(),phoneNumber_intlFormat:$("#create-account-form #create-phone").val().startsWith("0")?$("#create-account-form #create-phone").val().replace("0","+234"):$("#create-account-form #create-phone").val(),securePin:$("#create-account-form #create-secure-pin").val()};return utopiasoftware.saveup.model.appUserDetails}).then(function(newUser){return Promise.resolve(intel.security.secureData.createFromData({data:JSON.stringify(newUser)}))}).then(function(instanceId){return Promise.resolve(intel.security.secureStorage.write({id:"postcash-user-details",instanceID:instanceId}))}).then(function(){$("#loader-modal").get(0).hide();window.localStorage.setItem("app-status",utopiasoftware.saveup.model.appUserDetails.phoneNumber);$("#side-menu-username").html(utopiasoftware.saveup.model.appUserDetails.firstName);$("ons-splitter").get(0).content.load("app-main-template");Materialize.toast("Sign Up completed! Welcome",4e3)}).catch(function(err){if(typeof err!=="string"){err="Sorry. Sign Up could not be completed"}$("#loader-modal").get(0).hide();ons.notification.alert({title:"Sign Up Failed",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+err+"</span>",cancelable:false})})},pinVisibilityButtonClicked:function pinVisibilityButtonClicked(buttonElement){if($(buttonElement).attr("data-saveup-visible")==="no"){$("#create-secure-pin").css("-webkit-text-security","none");$(buttonElement).find("ons-icon").attr("icon","md-eye-off");$(buttonElement).attr("data-saveup-visible","yes")}else{$("#create-secure-pin").css("-webkit-text-security","disc");$(buttonElement).find("ons-icon").attr("icon","md-eye");$(buttonElement).attr("data-saveup-visible","no")}}},onboardingPageViewModel:{pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-splitter-side").removeAttr("swipeable");loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#onboarding-navigator").get(0).topPage.onDeviceBackButton=function(){ons.notification.confirm("Do you want to close the app?",{title:"Exit",buttonLabels:["No","Yes"]}).then(function(index){if(index===1){navigator.app.exitApp()}})};$("#onboarding-carousel",$thisPage).carousel({dist:0,fullWidth:true,indicators:true,noWrap:true});$("#loader-modal").get(0).hide()}},nextSlideButtonClicked:function nextSlideButtonClicked(buttonElem){$("#onboarding-carousel").carousel("next");setTimeout(function(){if($(".carousel-item.active").is('[href="#three!"]')){$(buttonElem).css("display","none")}},205)},endButtonClicked:function endButtonClicked(){$("ons-splitter").get(0).content.load("app-main-template")}},mainMenuPageViewModel:{pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-splitter-side").removeAttr("swipeable");loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){ons.notification.confirm("Do you want to close the app?",{title:"Exit",buttonLabels:["No","Yes"]}).then(function(index){if(index===1){navigator.app.exitApp()}})};$("#loader-modal").get(0).hide()}},pageShow:function pageShow(){$("ons-splitter-side").removeAttr("swipeable")},mainMenuButtonsClicked:function mainMenuButtonsClicked(label){if(label=="transfer cash"){ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#app-main-navigator").get(0).pushPage("transfer-cash-page.html",{})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}if(label=="verify account"){$("#app-main-navigator").get(0).pushPage("verify-account-page.html",{});return}if(label=="my cards"){ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#app-main-navigator").get(0).pushPage("my-cards-page.html",{})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}if(label=="my accounts"){ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#app-main-navigator").get(0).pushPage("my-accounts-page.html",{})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}if(label=="saved recipients"){ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#app-main-navigator").get(0).pushPage("saved-recipients-page.html",{})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}if(label=="intro"){$("#app-main-navigator").get(0).pushPage("onboarding-page.html",{});return}if(label=="transaction history"){ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#app-main-navigator").get(0).pushPage("transaction-history-page.html",{})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}if(label=="settings"){$("#app-main-navigator").get(0).pushPage("settings-page.html",{});return}if(label=="contact us"){$("#app-main-navigator").get(0).pushPage("contact-us-page.html",{});return}if(label=="app info"){$("#app-main-navigator").get(0).pushPage("app-info-page.html",{});return}}},verifyAccountPageViewModel:{formValidator:null,pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-input input",$thisPage).addClass("utopiasoftware-no-style");$("ons-splitter-side").attr("swipeable",true);loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){if($("ons-splitter").get(0).left.isOpen){$("ons-splitter").get(0).left.close();return}if($("#verify-account-bottom-sheet").data("saveupSheetState")==="open"){$("#verify-account-bottom-sheet").modal("close");return}$("#app-main-navigator").get(0).resetToPage("main-menu-page.html")};utopiasoftware.saveup.controller.verifyAccountPageViewModel.formValidator=$("#verify-account-form").parsley();$("#verify-account-button").get(0).onclick=function(){utopiasoftware.saveup.controller.verifyAccountPageViewModel.formValidator.whenValidate()};utopiasoftware.saveup.controller.verifyAccountPageViewModel.formValidator.on("field:error",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").addClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").attr("data-hint",fieldInstance.getErrorsMessages()[0])});utopiasoftware.saveup.controller.verifyAccountPageViewModel.formValidator.on("field:success",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").removeAttr("data-hint")});utopiasoftware.saveup.controller.verifyAccountPageViewModel.formValidator.on("form:success",utopiasoftware.saveup.controller.verifyAccountPageViewModel.verifyAccountFormValidated);Promise.resolve(utopiasoftware.saveup.sortBanksData()).then(function(bankArrayData){var optionTags="";for(var index=0;index<bankArrayData.length;index++){var bankObject=bankArrayData[index];for(var prop in bankObject){optionTags+='<option value="'+prop+'">'+bankObject[prop]+"</option>"}}$("#verify-account-choose-bank",$thisPage).append(optionTags);$("#verify-account-choose-bank",$thisPage).material_select();$("#verify-account-number",$thisPage).characterCounter();$(".progress",$thisPage).remove();$("#verify-account-form",$thisPage).css("display","block");$("#verify-account-button",$thisPage).removeAttr("disabled");$("#loader-modal").get(0).hide()}).catch()}},pageHide:function pageHide(event){try{$("#verify-account-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#verify-account-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.verifyAccountPageViewModel.formValidator.reset()}catch(err){}},pageDestroy:function pageDestroy(event){try{$("#verify-account-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#verify-account-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.verifyAccountPageViewModel.formValidator.destroy();$("#verify-account-choose-bank").material_select("destroy");$("#verify-account-number").off();$("#verify-account-number").removeData()}catch(err){}},verifyAccountFormValidated:function verifyAccountFormValidated(){if(navigator.connection.type===Connection.NONE){window.plugins.toast.showWithOptions({message:"You cannot verify accounts without an Internet Connection",duration:4e3,position:"top",styling:{opacity:1,backgroundColor:"#ff0000",textColor:"#FFFFFF",textSize:14}},function(toastEvent){if(toastEvent&&toastEvent.event=="touch"){window.plugins.toast.hide()}});return}$("#loader-modal-message").html("Verifying Bank Account...");$("#loader-modal").get(0).show();utopiasoftware.saveup.moneyWaveObject.useToken.then(function(tokenData){return new Promise(function(resolve,reject){var verifyAccountRequest=$.ajax({url:utopiasoftware.saveup.moneyWaveObject.gateway+"v1/resolve/account",type:"post",contentType:"application/json",beforeSend:function beforeSend(jqxhr){jqxhr.setRequestHeader("Authorization",tokenData)},dataType:"json",timeout:24e4,processData:false,data:JSON.stringify({account_number:$("#verify-account-form #verify-account-number").val(),bank_code:$("#verify-account-form #verify-account-choose-bank").val()})});verifyAccountRequest.done(function(responseData){if(responseData.status==="success"){$("#verify-account-form #verify-account-name").val(responseData.data.account_name);resolve()}else{reject()}});verifyAccountRequest.fail(function(){reject()})})}).then(function(){return $("#loader-modal").get(0).hide()}).then(function(){Materialize.toast('Bank account verified <ons-button modifier="quiet" style="color: #82b1ff" onclick="utopiasoftware.saveup.controller.verifyAccountPageViewModel.moreActions();">More</ons-button>',4e3);$("#verify-account-form .verify-account-success").css("display","block");$("#verify-account-form .verify-account-success").addClass("scale-in")}).catch(function(){$("#loader-modal").get(0).hide();$("#verify-account-form .verify-account-failed").css("display","block");$("#verify-account-form .verify-account-failed").addClass("scale-in")})},resetVerifiedAcctDisplay:function resetVerifiedAcctDisplay(){$("#verify-account-form .verify-account-success").css("display","none");$("#verify-account-form .verify-account-success").removeClass("scale-in");$("#verify-account-form .verify-account-failed").css("display","none");$("#verify-account-form .verify-account-failed").removeClass("scale-in")},moreActions:function moreActions(){$("#verify-account-bottom-sheet").modal("open")},verifyAcctBottomSheetListItemClicked:function verifyAcctBottomSheetListItemClicked(label){if(label=="transfer cash"){ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#verify-account-bottom-sheet").modal("close");$("#transfer-cash-page").remove();$("#app-main-navigator").get(0).pushPage("transfer-cash-page.html",{data:{recipient_details:{recipientAccountName:$("#verify-account-name").val(),recipientAccount:$("#verify-account-page #verify-account-number").val(),recipientBankCode:$("#verify-account-page #verify-account-choose-bank").val()}}})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}if(label=="add to my accounts"){ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#verify-account-bottom-sheet").modal("close");$("#secure-storage-modal .modal-message").html("Storing Bank Account on Device...");$("#secure-storage-modal").get(0).show();utopiasoftware.saveup.bankAccountOperations.addMyAccount({uniqueAccountId:""+utopiasoftware.saveup.model.deviceUUID+Date.now(),bankAccountNumber:$("#verify-account-form #verify-account-number").val(),bankAccountName:$("#verify-account-form #verify-account-name").val(),bankName:$("#verify-account-form #verify-account-choose-bank option:selected").text().trim(),flutterwave_bankCode:$("#verify-account-form #verify-account-choose-bank").val(),bankAccountAvatar:"css/app-images/avatar-"+new Random(Random.engines.nativeMath).integer(1,6)+".png"}).then(function(){window.setTimeout(function(){$("#secure-storage-modal").get(0).hide();Materialize.toast("New bank account added",4e3)},4e3)}).catch(function(err){$("#secure-storage-modal").get(0).hide();ons.notification.alert({title:"Save Error",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+(err.message||"")+" Sorry, this bank account could not be added. "+"<br>You can try again"+"</span>",cancelable:true})})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}if(label=="add to my recipients"){ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#verify-account-bottom-sheet").modal("close");$("#secure-storage-modal .modal-message").html("Storing Recipient's Bank Account on Device...");$("#secure-storage-modal").get(0).show();utopiasoftware.saveup.savedRecipientsBankAccountOperations.addSavedRecipientAccount({uniqueAccountId:""+utopiasoftware.saveup.model.deviceUUID+Date.now(),bankAccountNumber:$("#verify-account-form #verify-account-number").val(),bankAccountName:$("#verify-account-form #verify-account-name").val(),bankName:$("#verify-account-form #verify-account-choose-bank option:selected").text().trim(),flutterwave_bankCode:$("#verify-account-form #verify-account-choose-bank").val(),bankAccountAvatar:"css/app-images/avatar-"+new Random(Random.engines.nativeMath).integer(1,6)+".png"}).then(function(){window.setTimeout(function(){$("#secure-storage-modal").get(0).hide();Materialize.toast("Recipient's bank account added",4e3)},4e3)}).catch(function(err){$("#secure-storage-modal").get(0).hide();ons.notification.alert({title:"Save Error",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+(err.message||"")+" Sorry, this recipient's bank account could not be added. "+"<br>You can try again"+"</span>",cancelable:true})})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}}},myCardsPageViewModel:{pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-splitter-side").attr("swipeable",true);loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){if($("ons-splitter").get(0).left.isOpen){$("ons-splitter").get(0).left.close();return}$("#app-main-navigator").get(0).resetToPage("main-menu-page.html")};$("#my-cards-pull-hook",$thisPage).on("changestate",function(event){switch(event.originalEvent.state){case"initial":$("#my-cards-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="fa-long-arrow-down" size="24px"></ons-icon>');break;case"preaction":$("#my-cards-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="fa-long-arrow-up" size="24px"></ons-icon>');break;case"action":$("#my-cards-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="fa-repeat" size="24px" spin></ons-icon>');break}});$("#my-cards-pull-hook",$thisPage).get(0).onAction=function(loadingDone){$("#my-cards-pull-hook",$thisPage).attr("disabled",true);utopiasoftware.saveup.financialCardOperations.loadCardData().then(function(cardsArray){if(cardsArray.length==0){$(".progress",$thisPage).remove();$("#my-cards-help-1",$thisPage).css("display","inline-block");$("#my-cards-pull-hook",$thisPage).removeAttr("disabled");$("#my-cards-page-message",$thisPage).css("display","block");$("#my-cards-page-error",$thisPage).css("display","none");$("#my-cards-list",$thisPage).css("display","none");$("#my-cards-add-card-button",$thisPage).removeAttr("disabled");loadingDone()}else{$("#my-cards-list",$thisPage).html("");for(var index=0;index<cardsArray.length;index++){var cardContent='<div class="row"><div class="col s1"></div><div class="col s10">\n                                <div class="card small">\n                                <div class="card-image" style="padding-top: 3%; padding-left: 3%; padding-right: 3%;\n                                background-image: url(\''+cardsArray[index].cardImage+'\'); background-position: center; background-size: contain; background-origin: content-box; background-repeat: no-repeat;">\n                                <img src="css/app-images/blank.png">\n                                </div>\n                                <div class="card-content" style="padding-bottom: 5px;">\n                                <div style="font-weight: bold; font-style: italic; color: #464646">'+cardsArray[index].cardNickName+'</div>\n                                <div style="font-weight: bold; font-size: 0.8em; color: #464646">'+cardsArray[index].cardBrand+"\n                                "+(cardsArray[index].cardLocale=="international"?"(International)":"")+'</div>\n                                </div>\n                                <div class="card-action" style="padding: 0;">\n                                <ons-button data-id="'+cardsArray[index].cardUniqueId+"\"\n                                data-acct-object='"+JSON.stringify({senderCardNickName:cardsArray[index].cardNickName,senderCardNumber:cardsArray[index].cardNumber,senderCardCvv:cardsArray[index].cvv,senderCardExpiryMonth:cardsArray[index].cardExpiryMonth,senderCardExpiryYear:cardsArray[index].cardExpiryYear})+'\' modifier="quiet" disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em; margin-right: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.myCardsPageViewModel.transferCashButtonClicked(this);">\n                                <ons-icon icon="md-saveup-icon-saveup-transfer-cash" size="29px">\n                                </ons-icon>\n                                </ons-button>\n                                <ons-button data-id="'+cardsArray[index].cardUniqueId+'" modifier="quiet" disable-auto-styling class="right"\n                                    style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                    onclick="utopiasoftware.saveup.controller.myCardsPageViewModel.editCardButtonClicked(this)">\n                            <ons-icon icon="md-edit" size="25px">\n                            </ons-icon>\n                            </ons-button>\n                            <ons-button data-id="'+cardsArray[index].cardUniqueId+'" modifier="quiet" disable-auto-styling class="right"\n                                    style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                    onclick="utopiasoftware.saveup.controller.myCardsPageViewModel.deleteCardButtonClicked(this)">\n                            <ons-icon icon="md-delete" size="25px">\n                            </ons-icon>\n                            </ons-button>\n                                </div>\n                                </div>\n                                </div>\n                                <div class="col s1"></div>\n                                </div>';$("#my-cards-list",$thisPage).append(cardContent)}$(".progress",$thisPage).remove();$("#my-cards-help-1",$thisPage).css("display","inline-block");$("#my-cards-pull-hook",$thisPage).removeAttr("disabled");$("#my-cards-page-message",$thisPage).css("display","none");$("#my-cards-page-error",$thisPage).css("display","none");$("#my-cards-list",$thisPage).css("display","block");$("#my-cards-add-card-button",$thisPage).removeAttr("disabled");loadingDone()}}).catch(function(){$(".progress",$thisPage).remove();$("#my-cards-help-1",$thisPage).css("display","inline-block");$("#my-cards-pull-hook",$thisPage).removeAttr("disabled");$("#my-cards-page-message",$thisPage).css("display","none");$("#my-cards-page-error",$thisPage).css("display","block");$("#my-cards-list",$thisPage).css("display","none");$("#my-cards-add-card-button",$thisPage).attr("disabled",true);loadingDone()})};utopiasoftware.saveup.financialCardOperations.loadCardData().then(function(cardsArray){if(cardsArray.length==0){$(".progress",$thisPage).remove();$("#my-cards-help-1",$thisPage).css("display","inline-block");$("#my-cards-pull-hook",$thisPage).removeAttr("disabled");$("#my-cards-page-message",$thisPage).css("display","block");$("#my-cards-page-error",$thisPage).css("display","none");$("#my-cards-list",$thisPage).css("display","none");$("#my-cards-add-card-button",$thisPage).removeAttr("disabled")}else{$("#my-cards-list",$thisPage).html("");for(var index=0;index<cardsArray.length;index++){var cardContent='<div class="row"><div class="col s1"></div><div class="col s10">\n                            <div class="card small">\n                            <div class="card-image" style="padding-top: 3%; padding-left: 3%; padding-right: 3%;\n                            background-image: url(\''+cardsArray[index].cardImage+'\'); background-position: center; background-size: contain; background-origin: content-box; background-repeat: no-repeat;">\n                            <img src="css/app-images/blank.png">\n                            </div>\n                            <div class="card-content" style="padding-bottom: 5px;">\n                            <div style="font-weight: bold; font-style: italic; color: #464646">'+cardsArray[index].cardNickName+'</div>\n                            <div style="font-weight: bold; font-size: 0.8em; color: #464646">'+cardsArray[index].cardBrand+"\n                            "+(cardsArray[index].cardLocale=="international"?"(International)":"")+'</div>\n                            </div>\n                            <div class="card-action" style="padding: 0;">\n                            <ons-button data-id="'+cardsArray[index].cardUniqueId+"\"\n                                data-acct-object='"+JSON.stringify({senderCardNickName:cardsArray[index].cardNickName,senderCardNumber:cardsArray[index].cardNumber,senderCardCvv:cardsArray[index].cvv,senderCardExpiryMonth:cardsArray[index].cardExpiryMonth,senderCardExpiryYear:cardsArray[index].cardExpiryYear})+'\' modifier="quiet" disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em; margin-right: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.myCardsPageViewModel.transferCashButtonClicked(this);">\n                                <ons-icon icon="md-saveup-icon-saveup-transfer-cash" size="29px">\n                                </ons-icon>\n                                </ons-button>\n                            <ons-button data-id="'+cardsArray[index].cardUniqueId+'" modifier="quiet" disable-auto-styling class="right"\n                                    style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                    onclick="utopiasoftware.saveup.controller.myCardsPageViewModel.editCardButtonClicked(this)">\n                            <ons-icon icon="md-edit" size="25px">\n                            </ons-icon>\n                            </ons-button>\n                            <ons-button data-id="'+cardsArray[index].cardUniqueId+'" modifier="quiet" disable-auto-styling class="right"\n                                    style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                    onclick="utopiasoftware.saveup.controller.myCardsPageViewModel.deleteCardButtonClicked(this)">\n                            <ons-icon icon="md-delete" size="25px">\n                            </ons-icon>\n                            </ons-button>\n                            </div>\n                            </div>\n                            </div>\n                            <div class="col s1"></div>\n                            </div>';$("#my-cards-list",$thisPage).append(cardContent)}$(".progress",$thisPage).remove();$("#my-cards-help-1",$thisPage).css("display","inline-block");$("#my-cards-pull-hook",$thisPage).removeAttr("disabled");$("#my-cards-page-message",$thisPage).css("display","none");$("#my-cards-page-error",$thisPage).css("display","none");$("#my-cards-list",$thisPage).css("display","block");$("#my-cards-add-card-button",$thisPage).removeAttr("disabled")}}).catch(function(){$(".progress",$thisPage).remove();$("#my-cards-help-1",$thisPage).css("display","inline-block");$("#my-cards-pull-hook",$thisPage).removeAttr("disabled");$("#my-cards-page-message",$thisPage).css("display","none");$("#my-cards-page-error",$thisPage).css("display","block");$("#my-cards-list",$thisPage).css("display","none");$("#my-cards-add-card-button",$thisPage).attr("disabled",true)});$("#loader-modal").get(0).hide()}},pageShow:function pageShow(event){var $thisPage=$(event.target);$("ons-splitter-side").attr("swipeable",true);if($("#app-main-navigator").get(0).topPage.data&&$("#app-main-navigator").get(0).topPage.data.refresh&&$("#app-main-navigator").get(0).topPage.data.refresh===true){$("#my-cards-pull-hook",$thisPage).after('<div class="progress"><div class="indeterminate"></div> </div>');utopiasoftware.saveup.financialCardOperations.loadCardData().then(function(cardsArray){if(cardsArray.length==0){$(".progress",$thisPage).remove();$("#my-cards-help-1",$thisPage).css("display","inline-block");$("#my-cards-pull-hook",$thisPage).removeAttr("disabled");$("#my-cards-page-message",$thisPage).css("display","block");$("#my-cards-page-error",$thisPage).css("display","none");$("#my-cards-list",$thisPage).css("display","none");$("#my-cards-add-card-button",$thisPage).removeAttr("disabled")}else{$("#my-cards-list",$thisPage).html("");for(var index=0;index<cardsArray.length;index++){var cardContent='<div class="row"><div class="col s1"></div><div class="col s10">\n                            <div class="card small">\n                            <div class="card-image" style="padding-top: 3%; padding-left: 3%; padding-right: 3%;\n                            background-image: url(\''+cardsArray[index].cardImage+'\'); background-position: center; background-size: contain; background-origin: content-box; background-repeat: no-repeat;">\n                            <img src="css/app-images/blank.png">\n                            </div>\n                            <div class="card-content" style="padding-bottom: 5px;">\n                            <div style="font-weight: bold; font-style: italic; color: #464646">'+cardsArray[index].cardNickName+'</div>\n                            <div style="font-weight: bold; font-size: 0.8em; color: #464646">'+cardsArray[index].cardBrand+"\n                            "+(cardsArray[index].cardLocale=="international"?"(International)":"")+'</div>\n                            </div>\n                            <div class="card-action" style="padding: 0;">\n                            <ons-button data-id="'+cardsArray[index].cardUniqueId+"\"\n                                data-acct-object='"+JSON.stringify({senderCardNickName:cardsArray[index].cardNickName,senderCardNumber:cardsArray[index].cardNumber,senderCardCvv:cardsArray[index].cvv,senderCardExpiryMonth:cardsArray[index].cardExpiryMonth,senderCardExpiryYear:cardsArray[index].cardExpiryYear})+'\' modifier="quiet" disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em; margin-right: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.myCardsPageViewModel.transferCashButtonClicked(this);">\n                                <ons-icon icon="md-saveup-icon-saveup-transfer-cash" size="29px">\n                                </ons-icon>\n                                </ons-button>\n                            <ons-button data-id="'+cardsArray[index].cardUniqueId+'" modifier="quiet" disable-auto-styling class="right"\n                                    style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                    onclick="utopiasoftware.saveup.controller.myCardsPageViewModel.editCardButtonClicked(this)">\n                            <ons-icon icon="md-edit" size="25px">\n                            </ons-icon>\n                            </ons-button>\n                            <ons-button data-id="'+cardsArray[index].cardUniqueId+'" modifier="quiet" disable-auto-styling class="right"\n                                    style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                    onclick="utopiasoftware.saveup.controller.myCardsPageViewModel.deleteCardButtonClicked(this)">\n                            <ons-icon icon="md-delete" size="25px">\n                            </ons-icon>\n                            </ons-button>\n                            </div>\n                            </div>\n                            </div>\n                            <div class="col s1"></div>\n                            </div>';$("#my-cards-list",$thisPage).append(cardContent)}$(".progress",$thisPage).remove();$("#my-cards-help-1",$thisPage).css("display","inline-block");$("#my-cards-pull-hook",$thisPage).removeAttr("disabled");$("#my-cards-page-message",$thisPage).css("display","none");$("#my-cards-page-error",$thisPage).css("display","none");$("#my-cards-list",$thisPage).css("display","block");$("#my-cards-add-card-button",$thisPage).removeAttr("disabled")}}).catch(function(){$(".progress",$thisPage).remove();$("#my-cards-help-1",$thisPage).css("display","inline-block");$("#my-cards-pull-hook",$thisPage).removeAttr("disabled");$("#my-cards-page-message",$thisPage).css("display","none");$("#my-cards-page-error",$thisPage).css("display","block");$("#my-cards-list",$thisPage).css("display","none");$("#my-cards-add-card-button",$thisPage).attr("disabled",true)})}},addCardButtonClicked:function addCardButtonClicked(){$("#app-main-navigator").get(0).pushPage("add-card-page.html",{animation:"lift-md"})},deleteCardButtonClicked:function deleteCardButtonClicked(buttonElem){ons.notification.confirm("Do you want to delete this card?",{title:"Confirm Delete",buttonLabels:["No","Yes"]}).then(function(index){if(index===1){utopiasoftware.saveup.financialCardOperations.deleteCard($(buttonElem).attr("data-id")).then(function(){$(buttonElem).closest(".row").remove();Materialize.toast("Card deleted",3e3)}).catch(function(){window.plugins.toast.showWithOptions({message:"Sorry, the bank card could not be deleted.\n Try again",duration:4e3,position:"top",styling:{opacity:1,backgroundColor:"#ff0000",textColor:"#FFFFFF",textSize:14}},function(toastEvent){if(toastEvent&&toastEvent.event=="touch"){window.plugins.toast.hide()}})})}})},editCardButtonClicked:function editCardButtonClicked(buttonElem){$("#app-main-navigator").get(0).pushPage("add-card-page.html",{animation:"lift-md",data:{edit:$(buttonElem).attr("data-id")}})},transferCashButtonClicked:function transferCashButtonClicked(buttonElem){ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#verify-account-bottom-sheet").modal("close");$("#transfer-cash-page").remove();$("#app-main-navigator").get(0).pushPage("transfer-cash-page.html",{data:{sender_card_details:JSON.parse($(buttonElem).attr("data-acct-object"))}})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}},addCardPageViewModel:{formValidator:null,previousScrollPosition:0,currentScrollPosition:0,newCardBrand:"Unknown",newCardLocale:"Unknown",newCardImage:"",cardImageRandomNum:null,pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-input input",$thisPage).addClass("utopiasoftware-no-style");$("ons-splitter-side").removeAttr("swipeable",true);utopiasoftware.saveup.controller.addCardPageViewModel.previousScrollPosition=0;utopiasoftware.saveup.controller.addCardPageViewModel.currentScrollPosition=0;utopiasoftware.saveup.controller.addCardPageViewModel.newCardBrand="Unknown";utopiasoftware.saveup.controller.addCardPageViewModel.newCardLocale="Unknown";utopiasoftware.saveup.controller.addCardPageViewModel.newCardImage="";var randomGen=new Random(Random.engines.nativeMath);utopiasoftware.saveup.controller.addCardPageViewModel.cardImageRandomNum=randomGen.integer(1,3);loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){if($("ons-splitter").get(0).left.isOpen){$("ons-splitter").get(0).left.close();return}$("#app-main-navigator").get(0).popPage()};$("#add-card-page .page__content").on("scroll",utopiasoftware.saveup.controller.addCardPageViewModel.pageContentScrolled);utopiasoftware.saveup.controller.addCardPageViewModel.formValidator=$("#add-card-form").parsley();$("#add-card-save-button").get(0).onclick=function(){utopiasoftware.saveup.controller.addCardPageViewModel.formValidator.whenValidate()};utopiasoftware.saveup.controller.addCardPageViewModel.formValidator.on("field:ajaxoptions",function(fieldInstance,ajaxOptions){ajaxOptions.headers={Authorization:"Bearer "+utopiasoftware.saveup.paystackObject.key.secret};$("#add-card-number-validation-loading",$thisPage).css("display","block")});utopiasoftware.saveup.controller.addCardPageViewModel.formValidator.on("field:error",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").addClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").attr("data-hint",fieldInstance.getErrorsMessages()[0]);if($(fieldInstance.$element).is("#add-card-card-number")){$("#add-card-number-validation-loading",$thisPage).css("display","none");$("#add-card-image-container",$thisPage).css("display","none")}});utopiasoftware.saveup.controller.addCardPageViewModel.formValidator.on("field:success",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").removeAttr("data-hint");if($(fieldInstance.$element).is("#add-card-card-number")){$("#add-card-number-validation-loading",$thisPage).css("display","none");if($("#add-card-verify-card").is(":checked")){switch(utopiasoftware.saveup.controller.addCardPageViewModel.newCardBrand){case"Mastercard":if(utopiasoftware.saveup.controller.addCardPageViewModel.newCardLocale=="local"){utopiasoftware.saveup.controller.addCardPageViewModel.newCardImage="css/app-images/mastercard-local-"+utopiasoftware.saveup.controller.addCardPageViewModel.cardImageRandomNum+".png";$("#add-card-image").attr("src","css/app-images/mastercard-local-"+utopiasoftware.saveup.controller.addCardPageViewModel.cardImageRandomNum+".png");$("#add-card-image-type").html("Mastercard")}else{utopiasoftware.saveup.controller.addCardPageViewModel.newCardImage="css/app-images/mastercard-international-"+utopiasoftware.saveup.controller.addCardPageViewModel.cardImageRandomNum+".png";$("#add-card-image").attr("src","css/app-images/mastercard-international-"+utopiasoftware.saveup.controller.addCardPageViewModel.cardImageRandomNum+".png");$("#add-card-image-type").html("Mastercard (International)")}break;case"Visa":if(utopiasoftware.saveup.controller.addCardPageViewModel.newCardLocale=="local"){utopiasoftware.saveup.controller.addCardPageViewModel.newCardImage="css/app-images/visacard-local-"+utopiasoftware.saveup.controller.addCardPageViewModel.cardImageRandomNum+".png";$("#add-card-image").attr("src","css/app-images/visacard-local-"+utopiasoftware.saveup.controller.addCardPageViewModel.cardImageRandomNum+".png");$("#add-card-image-type").html("Visa")}else{utopiasoftware.saveup.controller.addCardPageViewModel.newCardImage="css/app-images/visacard-international-"+utopiasoftware.saveup.controller.addCardPageViewModel.cardImageRandomNum+".png";$("#add-card-image").attr("src","css/app-images/visacard-international-"+utopiasoftware.saveup.controller.addCardPageViewModel.cardImageRandomNum+".png");$("#add-card-image-type").html("Visa (International)")}break;case"Verve":if(utopiasoftware.saveup.controller.addCardPageViewModel.newCardLocale=="local"){utopiasoftware.saveup.controller.addCardPageViewModel.newCardImage="css/app-images/verve-local-"+utopiasoftware.saveup.controller.addCardPageViewModel.cardImageRandomNum+".png";$("#add-card-image").attr("src","css/app-images/verve-local-"+utopiasoftware.saveup.controller.addCardPageViewModel.cardImageRandomNum+".png");$("#add-card-image-type").html("Verve")}break}$("#add-card-image-container",$thisPage).css("display","block")}else{utopiasoftware.saveup.controller.addCardPageViewModel.newCardImage="css/app-images/unknown-local-"+utopiasoftware.saveup.controller.addCardPageViewModel.cardImageRandomNum+".png";utopiasoftware.saveup.controller.addCardPageViewModel.newCardBrand="Unknown";utopiasoftware.saveup.controller.addCardPageViewModel.newCardLocale="Unknown";$("#add-card-image-container",$thisPage).css("display","none")}}});utopiasoftware.saveup.controller.addCardPageViewModel.formValidator.on("form:success",utopiasoftware.saveup.controller.addCardPageViewModel.addCardFormValidated);var optionTags="";var yearOption=(new Date).getFullYear();optionTags+='<option value="'+yearOption+'">'+yearOption+"</option>";for(var index=0;index<3;index++){yearOption+=1;optionTags+='<option value="'+yearOption+'">'+yearOption+"</option>"}$("#add-card-expiry-year",$thisPage).append(optionTags);$("select",$thisPage).material_select();$("#add-card-card-number",$thisPage).characterCounter();if($("#app-main-navigator").get(0).topPage.data&&$("#app-main-navigator").get(0).topPage.data.edit){utopiasoftware.saveup.financialCardOperations.getCard($("#app-main-navigator").get(0).topPage.data.edit).then(function(card){$("#add-card-page #add-card-unique-id").val(card.cardUniqueId);$("#add-card-page #add-card-card-holder").val(card.cardHolderName);$("#add-card-page #add-card-alias").val(card.cardNickName);$("#add-card-page #add-card-card-number").val(card.cardNumber);$("#add-card-page #add-card-cvv").val(card.cvv);$("#add-card-page #add-card-expiry-month").val(card.cardExpiryMonth);$("#add-card-page #hidden-card-expiry-month-input").val(card.cardExpiryMonth);$("#add-card-page #add-card-expiry-year").val(card.cardExpiryYear);$("#add-card-page #hidden-card-expiry-year-input").val(card.cardExpiryYear);utopiasoftware.saveup.controller.addCardPageViewModel.newCardBrand=card.cardBrand;$("#add-card-page #add-card-verify-card").prop("checked",card.cardBrand!=="Unknown");utopiasoftware.saveup.controller.addCardPageViewModel.isCardNumberValidated($("#add-card-page #add-card-verify-card"));utopiasoftware.saveup.controller.addCardPageViewModel.newCardLocale=card.cardLocale;utopiasoftware.saveup.controller.addCardPageViewModel.newCardImage=card.cardImage;$("#add-card-page #add-card-image").attr("src",utopiasoftware.saveup.controller.addCardPageViewModel.newCardImage);$("#add-card-image-container",$thisPage).css("display","block");Materialize.updateTextFields();$("select",$thisPage).material_select();$(".progress",$thisPage).remove();$("#add-card-form",$thisPage).css("display","block");$("#add-card-cancel-button, #add-card-save-button",$thisPage).removeAttr("disabled");$("#loader-modal").get(0).hide()})}else{$(".progress",$thisPage).remove();$("#add-card-form",$thisPage).css("display","block");$("#add-card-cancel-button, #add-card-save-button",$thisPage).removeAttr("disabled");$("#loader-modal").get(0).hide()}}},pageHide:function pageHide(event){try{$("#add-card-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#add-card-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.addCardPageViewModel.formValidator.reset()}catch(err){}},pageDestroy:function pageDestroy(event){try{$("#add-card-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#add-card-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.addCardPageViewModel.formValidator.destroy();$("#add-card-page select").material_select("destroy");$("#add-card-page #add-card-card-number").off();$("#add-card-page #add-card-card-number").removeData()}catch(err){}},addCardFormValidated:function addCardFormValidated(){$("#secure-storage-modal .modal-message").html("Storing Card on Device...");$("#secure-storage-modal").get(0).show();if($("#app-main-navigator").get(0).topPage.data&&$("#app-main-navigator").get(0).topPage.data.edit){utopiasoftware.saveup.financialCardOperations.deleteCard($("#app-main-navigator").get(0).topPage.data.edit).then(function(){var editedCardData={cardUniqueId:$("#app-main-navigator").get(0).topPage.data.edit,cardHolderName:$("#add-card-form #add-card-card-holder").val(),cardNickName:$("#add-card-form #add-card-alias").val(),cardNumber:$("#add-card-form #add-card-card-number").val(),cvv:$("#add-card-form #add-card-cvv").val(),cardExpiryMonth:$("#add-card-form #add-card-expiry-month").val(),cardExpiryYear:$("#add-card-form #add-card-expiry-year").val(),cardBrand:utopiasoftware.saveup.controller.addCardPageViewModel.newCardBrand,cardLocale:utopiasoftware.saveup.controller.addCardPageViewModel.newCardLocale,cardImage:utopiasoftware.saveup.controller.addCardPageViewModel.newCardImage};return utopiasoftware.saveup.financialCardOperations.addCard(editedCardData)}).then(function(){window.setTimeout(function(){utopiasoftware.saveup.controller.addCardPageViewModel.formValidator.reset();$("#add-card-page #add-card-form").get(0).reset();utopiasoftware.saveup.controller.addCardPageViewModel.isCardNumberValidated($("#add-card-page #add-card-verify-card"));utopiasoftware.saveup.controller.addCardPageViewModel.newCardBrand="Unknown";utopiasoftware.saveup.controller.addCardPageViewModel.newCardLocale="Unknown";utopiasoftware.saveup.controller.addCardPageViewModel.newCardImage="";$("#add-card-page #add-card-image-container").css("display","none");$("#add-card-page .page__content").scrollTop(0);$("#secure-storage-modal").get(0).hide();Materialize.toast("Card updated",4e3)},4e3)}).catch(function(){$("#secure-storage-modal").get(0).hide();ons.notification.alert({title:"Update Error",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+(err.message||"")+" Sorry, this card could not be updated. "+"<br>You can try again"+"</span>",cancelable:true})})}else{var newCardData={cardUniqueId:""+utopiasoftware.saveup.model.deviceUUID+Date.now(),cardHolderName:$("#add-card-form #add-card-card-holder").val(),cardNickName:$("#add-card-form #add-card-alias").val(),cardNumber:$("#add-card-form #add-card-card-number").val(),cvv:$("#add-card-form #add-card-cvv").val(),cardExpiryMonth:$("#add-card-form #add-card-expiry-month").val(),cardExpiryYear:$("#add-card-form #add-card-expiry-year").val(),cardBrand:utopiasoftware.saveup.controller.addCardPageViewModel.newCardBrand,cardLocale:utopiasoftware.saveup.controller.addCardPageViewModel.newCardLocale,cardImage:utopiasoftware.saveup.controller.addCardPageViewModel.newCardImage};Promise.resolve(intel.security.secureStorage.read({id:"postcash-user-cards"})).then(function(instanceId){return Promise.resolve(intel.security.secureData.getData(instanceId))},function(errObject){if(errObject.code==1){return"[]"}else{throw errObject}}).then(function(secureCardDataArray){secureCardDataArray=JSON.parse(secureCardDataArray);secureCardDataArray.unshift(newCardData);return intel.security.secureData.createFromData({data:JSON.stringify(secureCardDataArray)})}).then(function(instanceId){return intel.security.secureStorage.write({id:"postcash-user-cards",instanceID:instanceId})}).then(function(){window.setTimeout(function(){utopiasoftware.saveup.controller.addCardPageViewModel.formValidator.reset();$("#add-card-page #add-card-form").get(0).reset();utopiasoftware.saveup.controller.addCardPageViewModel.isCardNumberValidated($("#add-card-page #add-card-verify-card"));utopiasoftware.saveup.controller.addCardPageViewModel.newCardBrand="Unknown";utopiasoftware.saveup.controller.addCardPageViewModel.newCardLocale="Unknown";utopiasoftware.saveup.controller.addCardPageViewModel.newCardImage="";$("#add-card-page #add-card-image-container").css("display","none");$("#add-card-page .page__content").scrollTop(0);$("#secure-storage-modal").get(0).hide();Materialize.toast("New card added",4e3)},4e3)}).catch(function(err){$("#secure-storage-modal").get(0).hide();ons.notification.alert({title:"Save Error",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+(err.message||"")+" Sorry, this card could not be added. "+"<br>You can try again"+"</span>",cancelable:true})})}},isCardNumberValidated:function isCardNumberValidated(checkElem){if($(checkElem).is(":checked")){$("#add-card-card-number").attr("data-parsley-remote-validator","financialcardcheck");$("#add-card-verify-card-notice").css("display","block")}else{$("#add-card-card-number").removeAttr("data-parsley-remote-validator");$("#add-card-verify-card-notice").css("display","none")}},pageContentScrolled:function pageContentScrolled(event){utopiasoftware.saveup.controller.addCardPageViewModel.currentScrollPosition=$(this).scrollTop();if(utopiasoftware.saveup.controller.addCardPageViewModel.currentScrollPosition>utopiasoftware.saveup.controller.addCardPageViewModel.previousScrollPosition){utopiasoftware.saveup.controller.addCardPageViewModel.previousScrollPosition=utopiasoftware.saveup.controller.addCardPageViewModel.currentScrollPosition;if(140-utopiasoftware.saveup.controller.addCardPageViewModel.currentScrollPosition<=56){if(this.isToolBarOpaque!=true){$("#add-card-page ons-toolbar").removeClass("toolbar--transparent");$("#add-card-page ons-list-header").css({display:"block",position:"fixed",top:"56px",width:"100%"});this.isToolBarOpaque=true}}return}if(utopiasoftware.saveup.controller.addCardPageViewModel.currentScrollPosition<utopiasoftware.saveup.controller.addCardPageViewModel.previousScrollPosition){utopiasoftware.saveup.controller.addCardPageViewModel.previousScrollPosition=utopiasoftware.saveup.controller.addCardPageViewModel.currentScrollPosition;if(140-utopiasoftware.saveup.controller.addCardPageViewModel.currentScrollPosition>56){if(this.isToolBarOpaque==true){$("#add-card-page ons-toolbar").addClass("toolbar--transparent");$("#add-card-page ons-list-header").css({display:"block",position:"static",top:"56px"});this.isToolBarOpaque=false}}return}},financialCardValidator:function financialCardValidator(jqxhr){var serverResponse="";if(jqxhr.status!=200){utopiasoftware.saveup.controller.addCardPageViewModel.newCardBrand="Unknown";utopiasoftware.saveup.controller.addCardPageViewModel.newCardLocale="Unknown";return false}serverResponse=JSON.parse(jqxhr.responseText.trim());if(serverResponse.status!=true){utopiasoftware.saveup.controller.addCardPageViewModel.newCardBrand="Unknown";utopiasoftware.saveup.controller.addCardPageViewModel.newCardLocale="Unknown";return false}if(serverResponse.data.brand==""||serverResponse.data.brand=="Unknown"){utopiasoftware.saveup.controller.addCardPageViewModel.newCardBrand="Unknown";utopiasoftware.saveup.controller.addCardPageViewModel.newCardLocale="Unknown";return false}if(serverResponse.data.brand.toLocaleUpperCase().indexOf("MASTER")>=0){utopiasoftware.saveup.controller.addCardPageViewModel.newCardBrand="Mastercard"}if(serverResponse.data.brand.toLocaleUpperCase().indexOf("VISA")>=0){utopiasoftware.saveup.controller.addCardPageViewModel.newCardBrand="Visa"}if(serverResponse.data.brand.toLocaleUpperCase().indexOf("VERVE")>=0){utopiasoftware.saveup.controller.addCardPageViewModel.newCardBrand="Verve"}if(serverResponse.data.country_name.indexOf("Nigeria")>=0){utopiasoftware.saveup.controller.addCardPageViewModel.newCardLocale="local"}if(serverResponse.data.country_name.indexOf("Nigeria")<0){utopiasoftware.saveup.controller.addCardPageViewModel.newCardLocale="international"}return true}},myAccountsPageViewModel:{pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-splitter-side").attr("swipeable",true);loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){if($("ons-splitter").get(0).left.isOpen){$("ons-splitter").get(0).left.close();return}$("#app-main-navigator").get(0).resetToPage("main-menu-page.html")};$("#my-accounts-pull-hook",$thisPage).on("changestate",function(event){switch(event.originalEvent.state){case"initial":$("#my-accounts-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="fa-long-arrow-down" size="24px"></ons-icon>');break;case"preaction":$("#my-accounts-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="fa-long-arrow-up" size="24px"></ons-icon>');break;case"action":$("#my-accounts-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="fa-repeat" size="24px" spin></ons-icon>');break}});$("#my-accounts-pull-hook",$thisPage).get(0).onAction=function(loadingDone){$("#my-accounts-pull-hook",$thisPage).attr("disabled",true);utopiasoftware.saveup.bankAccountOperations.loadMyAccountsData().then(function(banksAcctsArray){if(banksAcctsArray.length==0){$(".progress",$thisPage).remove();$("#my-accounts-help-1",$thisPage).css("display","inline-block");$("#my-accounts-pull-hook",$thisPage).removeAttr("disabled");$("#my-accounts-page-message",$thisPage).css("display","block");$("#my-accounts-page-error",$thisPage).css("display","none");$("#my-accounts-list",$thisPage).css("display","none");$("#my-accounts-add-account-button",$thisPage).removeAttr("disabled");loadingDone()}else{$("#my-accounts-list",$thisPage).html("");for(var index=0;index<banksAcctsArray.length;index++){var bankAcctContent='<div class="row"><div class="col s12"><div class="card horizontal">\n                                <div class="card-image" style="padding: 3%;">\n                                <img src="'+banksAcctsArray[index].bankAccountAvatar+'">\n                                </div>\n                                <div class="card-stacked">\n                                <div class="card-content" style="padding-bottom: 0;">\n                                <div style="font-weight: bold; font-size: 0.75em; font-style: italic; color: #464646;\n                                padding-bottom: 0.5em;">'+banksAcctsArray[index].bankAccountName+'</div>\n                                </div><div class="card-action" style="font-weight: bold; font-size: 0.75em;\n                                color: #464646; padding-bottom: 0.5em;">'+banksAcctsArray[index].bankAccountNumber+'</div>\n                                <div  class="card-action" style="font-weight: bold; font-size: 0.75em;\n                                color: #464646; padding-bottom: 0.5em;">'+banksAcctsArray[index].bankName+'</div>\n                                <div class="card-action" style="padding: 0;">\n                                <div style="display: inline-block; margin-left: auto; margin-right: auto">\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+"\"\n                                data-acct-object='"+JSON.stringify({senderAccountName:banksAcctsArray[index].bankAccountName,senderAccount:banksAcctsArray[index].bankAccountNumber,senderBankCode:banksAcctsArray[index].flutterwave_bankCode})+'\' modifier="quiet" disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em; margin-right: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.myAccountsPageViewModel.transferCashButtonClicked(this);">\n                                <ons-icon icon="md-saveup-icon-saveup-transfer-cash" size="29px">\n                                </ons-icon>\n                                </ons-button>\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+'" modifier="quiet"\n                                disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.myAccountsPageViewModel.editAccountButtonClicked(this);">\n                                   <ons-icon icon="md-edit" size="25px">\n                                </ons-icon>\n                                </ons-button>\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+'" modifier="quiet" disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.myAccountsPageViewModel.deleteAccountButtonClicked(this);">\n                                <ons-icon icon="md-delete" size="25px"></ons-icon>\n                                </ons-button>\n                                </div></div></div></div></div></div>';$("#my-accounts-list",$thisPage).append(bankAcctContent)}$(".progress",$thisPage).remove();$("#my-accounts-help-1",$thisPage).css("display","inline-block");$("#my-accounts-pull-hook",$thisPage).removeAttr("disabled");$("#my-accounts-page-message",$thisPage).css("display","none");$("#my-accounts-page-error",$thisPage).css("display","none");$("#my-accounts-list",$thisPage).css("display","block");$("#my-accounts-add-account-button",$thisPage).removeAttr("disabled");loadingDone()}}).catch(function(){$(".progress",$thisPage).remove();$("#my-accounts-help-1",$thisPage).css("display","inline-block");$("#my-accounts-pull-hook",$thisPage).removeAttr("disabled");$("#my-accounts-page-message",$thisPage).css("display","none");$("#my-accounts-page-error",$thisPage).css("display","block");$("#my-accounts-list",$thisPage).css("display","none");$("#my-accounts-add-account-button",$thisPage).attr("disabled",true);loadingDone()})};utopiasoftware.saveup.bankAccountOperations.loadMyAccountsData().then(function(banksAcctsArray){if(banksAcctsArray.length==0){$(".progress",$thisPage).remove();$("#my-accounts-help-1",$thisPage).css("display","inline-block");$("#my-accounts-pull-hook",$thisPage).removeAttr("disabled");$("#my-accounts-page-message",$thisPage).css("display","block");$("#my-accounts-page-error",$thisPage).css("display","none");$("#my-accounts-list",$thisPage).css("display","none");$("#my-accounts-add-account-button",$thisPage).removeAttr("disabled")}else{$("#my-accounts-list",$thisPage).html("");for(var index=0;index<banksAcctsArray.length;index++){var bankAcctContent='<div class="row"><div class="col s12"><div class="card horizontal">\n                                <div class="card-image" style="padding: 3%;">\n                                <img src="'+banksAcctsArray[index].bankAccountAvatar+'">\n                                </div>\n                                <div class="card-stacked">\n                                <div class="card-content" style="padding-bottom: 0;">\n                                <div style="font-weight: bold; font-size: 0.75em; font-style: italic; color: #464646;\n                                padding-bottom: 0.5em;">'+banksAcctsArray[index].bankAccountName+'</div>\n                                </div><div class="card-action" style="font-weight: bold; font-size: 0.75em;\n                                color: #464646; padding-bottom: 0.5em;">'+banksAcctsArray[index].bankAccountNumber+'</div>\n                                <div  class="card-action" style="font-weight: bold; font-size: 0.75em;\n                                color: #464646; padding-bottom: 0.5em;">'+banksAcctsArray[index].bankName+'</div>\n                                <div class="card-action" style="padding: 0;">\n                                <div style="display: inline-block; margin-left: auto; margin-right: auto">\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+"\"\n                                data-acct-object='"+JSON.stringify({senderAccountName:banksAcctsArray[index].bankAccountName,senderAccount:banksAcctsArray[index].bankAccountNumber,senderBankCode:banksAcctsArray[index].flutterwave_bankCode})+'\' modifier="quiet" disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em; margin-right: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.myAccountsPageViewModel.transferCashButtonClicked(this);">\n                                <ons-icon icon="md-saveup-icon-saveup-transfer-cash" size="29px">\n                                </ons-icon>\n                                </ons-button>\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+'" modifier="quiet"\n                                disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.myAccountsPageViewModel.editAccountButtonClicked(this);">\n                                   <ons-icon icon="md-edit" size="25px">\n                                </ons-icon>\n                                </ons-button>\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+'" modifier="quiet" disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.myAccountsPageViewModel.deleteAccountButtonClicked(this);">\n                                <ons-icon icon="md-delete" size="25px"></ons-icon>\n                                </ons-button>\n                                </div></div></div></div></div></div>';$("#my-accounts-list",$thisPage).append(bankAcctContent)}$(".progress",$thisPage).remove();$("#my-accounts-help-1",$thisPage).css("display","inline-block");$("#my-accounts-pull-hook",$thisPage).removeAttr("disabled");$("#my-accounts-page-message",$thisPage).css("display","none");$("#my-accounts-page-error",$thisPage).css("display","none");$("#my-accounts-list",$thisPage).css("display","block");$("#my-accounts-add-account-button",$thisPage).removeAttr("disabled")}}).catch(function(){$(".progress",$thisPage).remove();$("#my-accounts-help-1",$thisPage).css("display","inline-block");$("#my-accounts-pull-hook",$thisPage).removeAttr("disabled");$("#my-accounts-page-message",$thisPage).css("display","none");$("#my-accounts-page-error",$thisPage).css("display","block");$("#my-accounts-list",$thisPage).css("display","none");$("#my-accounts-add-account-button",$thisPage).attr("disabled",true)});$("#loader-modal").get(0).hide()}},pageShow:function pageShow(event){var $thisPage=$(event.target);$("ons-splitter-side").attr("swipeable",true);if($("#app-main-navigator").get(0).topPage.data&&$("#app-main-navigator").get(0).topPage.data.refresh&&$("#app-main-navigator").get(0).topPage.data.refresh===true){$("#my-accounts-pull-hook",$thisPage).after('<div class="progress"><div class="indeterminate"></div> </div>');utopiasoftware.saveup.bankAccountOperations.loadMyAccountsData().then(function(banksAcctsArray){if(banksAcctsArray.length==0){$(".progress",$thisPage).remove();$("#my-accounts-help-1",$thisPage).css("display","inline-block");$("#my-accounts-pull-hook",$thisPage).removeAttr("disabled");$("#my-accounts-page-message",$thisPage).css("display","block");$("#my-accounts-page-error",$thisPage).css("display","none");$("#my-accounts-list",$thisPage).css("display","none");$("#my-accounts-add-account-button",$thisPage).removeAttr("disabled")}else{$("#my-accounts-list",$thisPage).html("");for(var index=0;index<banksAcctsArray.length;index++){var bankAcctContent='<div class="row"><div class="col s12"><div class="card horizontal">\n                                <div class="card-image" style="padding: 3%;">\n                                <img src="'+banksAcctsArray[index].bankAccountAvatar+'">\n                                </div>\n                                <div class="card-stacked">\n                                <div class="card-content" style="padding-bottom: 0;">\n                                <div style="font-weight: bold; font-size: 0.75em; font-style: italic; color: #464646;\n                                padding-bottom: 0.5em;">'+banksAcctsArray[index].bankAccountName+'</div>\n                                </div><div class="card-action" style="font-weight: bold; font-size: 0.75em;\n                                color: #464646; padding-bottom: 0.5em;">'+banksAcctsArray[index].bankAccountNumber+'</div>\n                                <div  class="card-action" style="font-weight: bold; font-size: 0.75em;\n                                color: #464646; padding-bottom: 0.5em;">'+banksAcctsArray[index].bankName+'</div>\n                                <div class="card-action" style="padding: 0;">\n                                <div style="display: inline-block; margin-left: auto; margin-right: auto">\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+"\"\n                                data-acct-object='"+JSON.stringify({senderAccountName:banksAcctsArray[index].bankAccountName,senderAccount:banksAcctsArray[index].bankAccountNumber,senderBankCode:banksAcctsArray[index].flutterwave_bankCode})+'\' modifier="quiet" disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em; margin-right: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.myAccountsPageViewModel.transferCashButtonClicked(this);">\n                                <ons-icon icon="md-saveup-icon-saveup-transfer-cash" size="29px">\n                                </ons-icon>\n                                </ons-button>\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+'" modifier="quiet"\n                                disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.myAccountsPageViewModel.editAccountButtonClicked(this);">\n                                   <ons-icon icon="md-edit" size="25px">\n                                </ons-icon>\n                                </ons-button>\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+'" modifier="quiet" disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.myAccountsPageViewModel.deleteAccountButtonClicked(this);">\n                                <ons-icon icon="md-delete" size="25px"></ons-icon>\n                                </ons-button>\n                                </div></div></div></div></div></div>';$("#my-accounts-list",$thisPage).append(bankAcctContent)}$(".progress",$thisPage).remove();$("#my-accounts-help-1",$thisPage).css("display","inline-block");$("#my-accounts-pull-hook",$thisPage).removeAttr("disabled");$("#my-accounts-page-message",$thisPage).css("display","none");$("#my-accounts-page-error",$thisPage).css("display","none");$("#my-accounts-list",$thisPage).css("display","block");$("#my-accounts-add-account-button",$thisPage).removeAttr("disabled")}}).catch(function(){$(".progress",$thisPage).remove();$("#my-accounts-help-1",$thisPage).css("display","inline-block");$("#my-accounts-pull-hook",$thisPage).removeAttr("disabled");$("#my-accounts-page-message",$thisPage).css("display","none");$("#my-accounts-page-error",$thisPage).css("display","block");$("#my-accounts-list",$thisPage).css("display","none");$("#my-accounts-add-account-button",$thisPage).attr("disabled",true)})}},addAccountButtonClicked:function addAccountButtonClicked(){$("#app-main-navigator").get(0).pushPage("add-account-page.html",{animation:"lift-md"})},deleteAccountButtonClicked:function deleteAccountButtonClicked(buttonElem){ons.notification.confirm("Do you want to delete this bank account?",{title:"Confirm Delete",buttonLabels:["No","Yes"]}).then(function(index){if(index===1){utopiasoftware.saveup.bankAccountOperations.deleteMyAccount($(buttonElem).attr("data-id")).then(function(){$(buttonElem).closest(".row").remove();Materialize.toast("Bank Account deleted",3e3)}).catch(function(){window.plugins.toast.showWithOptions({message:"Sorry, the bank account could not be deleted.\n Try again",duration:4e3,position:"top",styling:{opacity:1,backgroundColor:"#ff0000",textColor:"#FFFFFF",textSize:14}},function(toastEvent){if(toastEvent&&toastEvent.event=="touch"){window.plugins.toast.hide()}})})}})},editAccountButtonClicked:function editAccountButtonClicked(buttonElem){$("#app-main-navigator").get(0).pushPage("add-account-page.html",{animation:"lift-md",data:{edit:$(buttonElem).attr("data-id")}})},transferCashButtonClicked:function transferCashButtonClicked(buttonElem){ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#verify-account-bottom-sheet").modal("close");$("#transfer-cash-page").remove();$("#app-main-navigator").get(0).pushPage("transfer-cash-page.html",{data:{sender_details:JSON.parse($(buttonElem).attr("data-acct-object"))}})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}},addAccountPageViewModel:{formValidator:null,previousScrollPosition:0,currentScrollPosition:0,bankAccountName:"",bankAccountImage:"",bankAccountImageRandomNum:null,tokenData:"",pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-input input",$thisPage).addClass("utopiasoftware-no-style");$("ons-splitter-side").removeAttr("swipeable",true);utopiasoftware.saveup.controller.addAccountPageViewModel.previousScrollPosition=0;utopiasoftware.saveup.controller.addAccountPageViewModel.currentScrollPosition=0;utopiasoftware.saveup.controller.addAccountPageViewModel.bankAccountName="";utopiasoftware.saveup.controller.addAccountPageViewModel.tokenData="";utopiasoftware.saveup.controller.addAccountPageViewModel.bankAccountImage="";var randomGen=new Random(Random.engines.nativeMath);utopiasoftware.saveup.controller.addAccountPageViewModel.bankAccountImageRandomNum=randomGen.integer(1,6);loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){if($("ons-splitter").get(0).left.isOpen){$("ons-splitter").get(0).left.close();return}$("#app-main-navigator").get(0).popPage()};$("#add-account-page .page__content").on("scroll",utopiasoftware.saveup.controller.addAccountPageViewModel.pageContentScrolled);utopiasoftware.saveup.controller.addAccountPageViewModel.formValidator=$("#add-account-form").parsley();$("#add-account-save-button").get(0).onclick=function(){if($("#add-account-verify-account").is(":checked")){$("#loader-modal #loader-modal-message").html("Preparing Device Storage...");$("#loader-modal").get(0).show();utopiasoftware.saveup.moneyWaveObject.useToken.then(function(tokenData){utopiasoftware.saveup.controller.addAccountPageViewModel.tokenData=tokenData;$("#loader-modal").get(0).hide();utopiasoftware.saveup.controller.addAccountPageViewModel.formValidator.whenValidate()}).catch(function(){utopiasoftware.saveup.controller.addAccountPageViewModel.tokenData="";$("#loader-modal").get(0).hide();utopiasoftware.saveup.controller.addAccountPageViewModel.formValidator.whenValidate()})}else{utopiasoftware.saveup.controller.addAccountPageViewModel.formValidator.whenValidate()}};utopiasoftware.saveup.controller.addAccountPageViewModel.formValidator.on("field:ajaxoptions",function(fieldInstance,ajaxOptions){ajaxOptions.headers={Authorization:utopiasoftware.saveup.controller.addAccountPageViewModel.tokenData};ajaxOptions.data=JSON.stringify({account_number:$("#add-account-form #add-account-number").val(),bank_code:$("#add-account-form #add-account-choose-bank").val()});$("#add-account-number-validation-loading",$thisPage).css("display","block")});utopiasoftware.saveup.controller.addAccountPageViewModel.formValidator.on("field:error",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").addClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").attr("data-hint",fieldInstance.getErrorsMessages()[0]);if($(fieldInstance.$element).is("#add-account-number")){$("#add-account-number-validation-loading",$thisPage).css("display","none");if($("#add-account-verify-account").is(":checked")){$("#add-account-page #add-account-account-name").val("")}else{}}});utopiasoftware.saveup.controller.addAccountPageViewModel.formValidator.on("field:success",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").removeAttr("data-hint");if($(fieldInstance.$element).is("#add-account-number")){$("#add-account-number-validation-loading",$thisPage).css("display","none");if($("#add-account-verify-account").is(":checked")){$("#add-account-page #add-account-account-name").val(utopiasoftware.saveup.controller.addAccountPageViewModel.bankAccountName);Materialize.updateTextFields()}else{}}});utopiasoftware.saveup.controller.addAccountPageViewModel.formValidator.on("form:success",utopiasoftware.saveup.controller.addAccountPageViewModel.addAccountFormValidated);Promise.resolve(utopiasoftware.saveup.sortBanksData()).then(function(bankArrayData){var optionTags="";for(var index=0;index<bankArrayData.length;index++){var bankObject=bankArrayData[index];for(var prop in bankObject){optionTags+='<option value="'+prop+'">'+bankObject[prop]+"</option>"}}$("#add-account-choose-bank",$thisPage).append(optionTags);$("#add-account-choose-bank",$thisPage).material_select();return}).then(function(){$("#add-account-number",$thisPage).characterCounter();return}).then(function(){if($("#app-main-navigator").get(0).topPage.data&&$("#app-main-navigator").get(0).topPage.data.edit){utopiasoftware.saveup.bankAccountOperations.getMyAccount($("#app-main-navigator").get(0).topPage.data.edit).then(function(bankAcct){$("#add-account-page #add-account-unique-id").val(bankAcct.uniqueAccountId);$("#add-account-page #add-account-number").val(bankAcct.bankAccountNumber);$("#add-account-page #add-account-account-name").val(bankAcct.bankAccountName);$("#add-account-page #add-account-choose-bank").val(bankAcct.flutterwave_bankCode);$("#add-account-page #hidden-choose-bank-input").val(bankAcct.flutterwave_bankCode);Materialize.updateTextFields();$("select",$thisPage).material_select();$(".progress",$thisPage).remove();$("#add-account-form",$thisPage).css("display","block");$("#add-account-cancel-button, #add-account-save-button",$thisPage).removeAttr("disabled");$("#loader-modal").get(0).hide()})}else{$(".progress",$thisPage).remove();$("#add-account-form",$thisPage).css("display","block");$("#add-account-cancel-button, #add-account-save-button",$thisPage).removeAttr("disabled");$("#loader-modal").get(0).hide()}}).catch()}},pageHide:function pageHide(event){try{$("#add-account-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#add-account-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.addAccountPageViewModel.formValidator.reset()}catch(err){}},pageDestroy:function pageDestroy(event){try{$("#add-account-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#add-account-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.addAccountPageViewModel.formValidator.destroy();$("#add-account-page select").material_select("destroy");$("#add-account-page #add-account-number").off();$("#add-account-page #add-account-number").removeData()}catch(err){}},addAccountFormValidated:function addAccountFormValidated(){$("#secure-storage-modal .modal-message").html("Storing Bank Account on Device...");$("#secure-storage-modal").get(0).show();utopiasoftware.saveup.controller.addAccountPageViewModel.bankAccountImage="css/app-images/avatar-"+utopiasoftware.saveup.controller.addAccountPageViewModel.bankAccountImageRandomNum+".png";if($("#app-main-navigator").get(0).topPage.data&&$("#app-main-navigator").get(0).topPage.data.edit){utopiasoftware.saveup.bankAccountOperations.deleteMyAccount($("#app-main-navigator").get(0).topPage.data.edit).then(function(){var editedBankAcctData={uniqueAccountId:$("#app-main-navigator").get(0).topPage.data.edit,bankAccountNumber:$("#add-account-form #add-account-number").val(),bankAccountName:$("#add-account-form #add-account-account-name").val(),bankName:$("#add-account-form #add-account-choose-bank option:selected").text().trim(),flutterwave_bankCode:$("#add-account-form #add-account-choose-bank").val(),bankAccountAvatar:utopiasoftware.saveup.controller.addAccountPageViewModel.bankAccountImage};return utopiasoftware.saveup.bankAccountOperations.addMyAccount(editedBankAcctData)}).then(function(){window.setTimeout(function(){utopiasoftware.saveup.controller.addAccountPageViewModel.formValidator.reset();$("#add-account-page #add-account-form").get(0).reset();$("#add-account-page select").material_select();utopiasoftware.saveup.controller.addAccountPageViewModel.isbankAccountNumberValidated($("#add-account-page #add-account-verify-account"));utopiasoftware.saveup.controller.addAccountPageViewModel.bankAccountName="";utopiasoftware.saveup.controller.addAccountPageViewModel.tokenData="";utopiasoftware.saveup.controller.addAccountPageViewModel.bankAccountImage="";$("#add-account-page .page__content").scrollTop(0);$("#secure-storage-modal").get(0).hide();Materialize.toast("Bank Account updated",4e3)},4e3)}).catch(function(){$("#secure-storage-modal").get(0).hide();ons.notification.alert({title:"Update Error",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+(err.message||"")+" Sorry, this bank account could not be updated. "+"<br>You can try again"+"</span>",cancelable:true})})}else{var newBankAcctData={uniqueAccountId:""+utopiasoftware.saveup.model.deviceUUID+Date.now(),bankAccountNumber:$("#add-account-form #add-account-number").val(),bankAccountName:$("#add-account-form #add-account-account-name").val(),bankName:$("#add-account-form #add-account-choose-bank option:selected").text().trim(),flutterwave_bankCode:$("#add-account-form #add-account-choose-bank").val(),bankAccountAvatar:utopiasoftware.saveup.controller.addAccountPageViewModel.bankAccountImage};utopiasoftware.saveup.bankAccountOperations.addMyAccount(newBankAcctData).then(function(){window.setTimeout(function(){utopiasoftware.saveup.controller.addAccountPageViewModel.formValidator.reset();$("#add-account-page #add-account-form").get(0).reset();$("#add-account-page select").material_select();utopiasoftware.saveup.controller.addAccountPageViewModel.isbankAccountNumberValidated($("#add-account-page #add-account-verify-account"));utopiasoftware.saveup.controller.addAccountPageViewModel.bankAccountName="";utopiasoftware.saveup.controller.addAccountPageViewModel.tokenData="";utopiasoftware.saveup.controller.addAccountPageViewModel.bankAccountImage="";$("#add-account-page .page__content").scrollTop(0);$("#secure-storage-modal").get(0).hide();Materialize.toast("New bank account added",4e3)},4e3)}).catch(function(err){$("#secure-storage-modal").get(0).hide();ons.notification.alert({title:"Save Error",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+(err.message||"")+" Sorry, this bank account could not be added. "+"<br>You can try again"+"</span>",cancelable:true})})}},isbankAccountNumberValidated:function isbankAccountNumberValidated(checkElem){if($(checkElem).is(":checked")){$("#add-account-number").attr("data-parsley-remote-validator","accountnumbercheck");$("#add-account-account-name").attr("disabled",true);$("#add-account-account-name").val("");$("#add-account-account-name").parent().find("label:eq(0)").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#add-account-account-name").parent().find("label:eq(0)").removeAttr("data-hint");$("#add-account-verify-account-notice").css("display","block")}else{$("#add-account-number").removeAttr("data-parsley-remote-validator");$("#add-account-account-name").removeAttr("disabled");$("#add-account-account-name").val("");$("#add-account-verify-account-notice").css("display","none")}},pageContentScrolled:function pageContentScrolled(event){utopiasoftware.saveup.controller.addAccountPageViewModel.currentScrollPosition=$(this).scrollTop();if(utopiasoftware.saveup.controller.addAccountPageViewModel.currentScrollPosition>utopiasoftware.saveup.controller.addAccountPageViewModel.previousScrollPosition){utopiasoftware.saveup.controller.addAccountPageViewModel.previousScrollPosition=utopiasoftware.saveup.controller.addAccountPageViewModel.currentScrollPosition;if(140-utopiasoftware.saveup.controller.addAccountPageViewModel.currentScrollPosition<=56){if(this.isToolBarOpaque!=true){$("#add-account-page ons-toolbar").removeClass("toolbar--transparent");$("#add-account-page ons-list-header").css({display:"block",position:"fixed",top:"56px",width:"100%"});this.isToolBarOpaque=true}}return}if(utopiasoftware.saveup.controller.addAccountPageViewModel.currentScrollPosition<utopiasoftware.saveup.controller.addAccountPageViewModel.previousScrollPosition){utopiasoftware.saveup.controller.addAccountPageViewModel.previousScrollPosition=utopiasoftware.saveup.controller.addAccountPageViewModel.currentScrollPosition;if(140-utopiasoftware.saveup.controller.addAccountPageViewModel.currentScrollPosition>56){if(this.isToolBarOpaque==true){$("#add-account-page ons-toolbar").addClass("toolbar--transparent");$("#add-account-page ons-list-header").css({display:"block",position:"static",top:"56px"});this.isToolBarOpaque=false}}return}},resetAccountNameDisplay:function resetAccountNameDisplay(){if($("#add-account-page #add-account-verify-account").is(":checked")){$("#add-account-page #add-account-account-name").val("")}},accountNumberValidator:function accountNumberValidator(jqxhr){var serverResponse="";if(jqxhr.status!=200){return false}serverResponse=JSON.parse(jqxhr.responseText.trim());if(serverResponse.status!="success"){return false}else{utopiasoftware.saveup.controller.addAccountPageViewModel.bankAccountName=serverResponse.data.account_name;return true}}},savedRecipientsPageViewModel:{pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-splitter-side").attr("swipeable",true);loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){if($("ons-splitter").get(0).left.isOpen){$("ons-splitter").get(0).left.close();return}$("#app-main-navigator").get(0).resetToPage("main-menu-page.html")};$("#saved-recipients-pull-hook",$thisPage).on("changestate",function(event){switch(event.originalEvent.state){case"initial":$("#saved-recipients-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="fa-long-arrow-down" size="24px"></ons-icon>');break;case"preaction":$("#saved-recipients-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="fa-long-arrow-up" size="24px"></ons-icon>');break;case"action":$("#saved-recipients-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="fa-repeat" size="24px" spin></ons-icon>');break}});$("#saved-recipients-pull-hook",$thisPage).get(0).onAction=function(loadingDone){$("#saved-recipients-pull-hook",$thisPage).attr("disabled",true);utopiasoftware.saveup.savedRecipientsBankAccountOperations.loadSavedRecipientsAccountsData().then(function(banksAcctsArray){if(banksAcctsArray.length==0){$(".progress",$thisPage).remove();$("#saved-recipients-help-1",$thisPage).css("display","inline-block");$("#saved-recipients-pull-hook",$thisPage).removeAttr("disabled");$("#saved-recipients-page-message",$thisPage).css("display","block");$("#saved-recipients-page-error",$thisPage).css("display","none");$("#saved-recipients-list",$thisPage).css("display","none");$("#saved-recipients-add-recipient-button",$thisPage).removeAttr("disabled");loadingDone()}else{$("#saved-recipients-list",$thisPage).html("");for(var index=0;index<banksAcctsArray.length;index++){var bankAcctContent='<div class="row"><div class="col s12"><div class="card horizontal">\n                                <div class="card-image" style="padding: 3%;">\n                                <img src="'+banksAcctsArray[index].bankAccountAvatar+'">\n                                </div>\n                                <div class="card-stacked">\n                                <div class="card-content" style="padding-bottom: 0;">\n                                <div style="font-weight: bold; font-size: 0.75em; font-style: italic; color: #464646;\n                                padding-bottom: 0.5em;">'+banksAcctsArray[index].bankAccountName+'</div>\n                                </div><div class="card-action" style="font-weight: bold; font-size: 0.75em;\n                                color: #464646; padding-bottom: 0.5em;">'+banksAcctsArray[index].bankAccountNumber+'</div>\n                                <div  class="card-action" style="font-weight: bold; font-size: 0.75em;\n                                color: #464646; padding-bottom: 0.5em;">'+banksAcctsArray[index].bankName+'</div>\n                                <div class="card-action" style="padding: 0;">\n                                <div style="display: inline-block; margin-left: auto; margin-right: auto">\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+"\"\n                                data-acct-object='"+JSON.stringify({recipientAccountName:banksAcctsArray[index].bankAccountName,recipientAccount:banksAcctsArray[index].bankAccountNumber,recipientBankCode:banksAcctsArray[index].flutterwave_bankCode})+'\' modifier="quiet" disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em; margin-right: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.savedRecipientsPageViewModel.transferCashButtonClicked(this);">\n                                <ons-icon icon="md-saveup-icon-saveup-transfer-cash" size="29px">\n                                </ons-icon>\n                                </ons-button>\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+'" modifier="quiet"\n                                disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.savedRecipientsPageViewModel.editRecipientButtonClicked(this);">\n                                   <ons-icon icon="md-edit" size="25px">\n                                </ons-icon>\n                                </ons-button>\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+'" modifier="quiet" disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.savedRecipientsPageViewModel.deleteRecipientButtonClicked(this);">\n                                <ons-icon icon="md-delete" size="25px"></ons-icon>\n                                </ons-button>\n                                </div></div></div></div></div></div>';$("#saved-recipients-list",$thisPage).append(bankAcctContent)}$(".progress",$thisPage).remove();$("#saved-recipients-help-1",$thisPage).css("display","inline-block");$("#saved-recipients-pull-hook",$thisPage).removeAttr("disabled");$("#saved-recipients-page-message",$thisPage).css("display","none");$("#saved-recipients-page-error",$thisPage).css("display","none");$("#saved-recipients-list",$thisPage).css("display","block");$("#saved-recipients-add-recipient-button",$thisPage).removeAttr("disabled");loadingDone()}}).catch(function(){$(".progress",$thisPage).remove();$("#saved-recipients-help-1",$thisPage).css("display","inline-block");$("#saved-recipients-pull-hook",$thisPage).removeAttr("disabled");$("#saved-recipients-page-message",$thisPage).css("display","none");$("#saved-recipients-page-error",$thisPage).css("display","block");$("#saved-recipients-list",$thisPage).css("display","none");$("#saved-recipients-add-recipient-button",$thisPage).attr("disabled",true);loadingDone()})};utopiasoftware.saveup.savedRecipientsBankAccountOperations.loadSavedRecipientsAccountsData().then(function(banksAcctsArray){if(banksAcctsArray.length==0){$(".progress",$thisPage).remove();$("#saved-recipients-help-1",$thisPage).css("display","inline-block");$("#saved-recipients-pull-hook",$thisPage).removeAttr("disabled");$("#saved-recipients-page-message",$thisPage).css("display","block");$("#saved-recipients-page-error",$thisPage).css("display","none");$("#saved-recipients-list",$thisPage).css("display","none");$("#saved-recipients-add-recipient-button",$thisPage).removeAttr("disabled")}else{$("#saved-recipients-list",$thisPage).html("");for(var index=0;index<banksAcctsArray.length;index++){var bankAcctContent='<div class="row"><div class="col s12"><div class="card horizontal">\n                                <div class="card-image" style="padding: 3%;">\n                                <img src="'+banksAcctsArray[index].bankAccountAvatar+'">\n                                </div>\n                                <div class="card-stacked">\n                                <div class="card-content" style="padding-bottom: 0;">\n                                <div style="font-weight: bold; font-size: 0.75em; font-style: italic; color: #464646;\n                                padding-bottom: 0.5em;">'+banksAcctsArray[index].bankAccountName+'</div>\n                                </div><div class="card-action" style="font-weight: bold; font-size: 0.75em;\n                                color: #464646; padding-bottom: 0.5em;">'+banksAcctsArray[index].bankAccountNumber+'</div>\n                                <div  class="card-action" style="font-weight: bold; font-size: 0.75em;\n                                color: #464646; padding-bottom: 0.5em;">'+banksAcctsArray[index].bankName+'</div>\n                                <div class="card-action" style="padding: 0;">\n                                <div style="display: inline-block; margin-left: auto; margin-right: auto">\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+"\"\n                                data-acct-object='"+JSON.stringify({recipientAccountName:banksAcctsArray[index].bankAccountName,recipientAccount:banksAcctsArray[index].bankAccountNumber,recipientBankCode:banksAcctsArray[index].flutterwave_bankCode})+'\' modifier="quiet" disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em; margin-right: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.savedRecipientsPageViewModel.transferCashButtonClicked(this);">\n                                <ons-icon icon="md-saveup-icon-saveup-transfer-cash" size="29px">\n                                </ons-icon>\n                                </ons-button>\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+'" modifier="quiet"\n                                disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.savedRecipientsPageViewModel.editRecipientButtonClicked(this);">\n                                   <ons-icon icon="md-edit" size="25px">\n                                </ons-icon>\n                                </ons-button>\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+'" modifier="quiet" disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.savedRecipientsPageViewModel.deleteRecipientButtonClicked(this);">\n                                <ons-icon icon="md-delete" size="25px"></ons-icon>\n                                </ons-button>\n                                </div></div></div></div></div></div>';$("#saved-recipients-list",$thisPage).append(bankAcctContent)}$(".progress",$thisPage).remove();$("#saved-recipients-help-1",$thisPage).css("display","inline-block");$("#saved-recipients-pull-hook",$thisPage).removeAttr("disabled");$("#saved-recipients-page-message",$thisPage).css("display","none");$("#saved-recipients-page-error",$thisPage).css("display","none");$("#saved-recipients-list",$thisPage).css("display","block");$("#saved-recipients-add-recipient-button",$thisPage).removeAttr("disabled")}}).catch(function(){$(".progress",$thisPage).remove();$("#saved-recipients-help-1",$thisPage).css("display","inline-block");$("#saved-recipients-pull-hook",$thisPage).removeAttr("disabled");$("#saved-recipients-page-message",$thisPage).css("display","none");$("#saved-recipients-page-error",$thisPage).css("display","block");$("#saved-recipients-list",$thisPage).css("display","none");$("#saved-recipients-add-recipient-button",$thisPage).attr("disabled",true)});$("#loader-modal").get(0).hide()}},pageShow:function pageShow(event){var $thisPage=$(event.target);$("ons-splitter-side").attr("swipeable",true);if($("#app-main-navigator").get(0).topPage.data&&$("#app-main-navigator").get(0).topPage.data.refresh&&$("#app-main-navigator").get(0).topPage.data.refresh===true){$("#saved-recipients-pull-hook",$thisPage).after('<div class="progress"><div class="indeterminate"></div> </div>');utopiasoftware.saveup.savedRecipientsBankAccountOperations.loadSavedRecipientsAccountsData().then(function(banksAcctsArray){if(banksAcctsArray.length==0){$(".progress",$thisPage).remove();$("#saved-recipients-help-1",$thisPage).css("display","inline-block");$("#saved-recipients-pull-hook",$thisPage).removeAttr("disabled");$("#saved-recipients-page-message",$thisPage).css("display","block");$("#saved-recipients-page-error",$thisPage).css("display","none");$("#saved-recipients-list",$thisPage).css("display","none");$("#saved-recipients-add-recipient-button",$thisPage).removeAttr("disabled")}else{$("#saved-recipients-list",$thisPage).html("");for(var index=0;index<banksAcctsArray.length;index++){var bankAcctContent='<div class="row"><div class="col s12"><div class="card horizontal">\n                                <div class="card-image" style="padding: 3%;">\n                                <img src="'+banksAcctsArray[index].bankAccountAvatar+'">\n                                </div>\n                                <div class="card-stacked">\n                                <div class="card-content" style="padding-bottom: 0;">\n                                <div style="font-weight: bold; font-size: 0.75em; font-style: italic; color: #464646;\n                                padding-bottom: 0.5em;">'+banksAcctsArray[index].bankAccountName+'</div>\n                                </div><div class="card-action" style="font-weight: bold; font-size: 0.75em;\n                                color: #464646; padding-bottom: 0.5em;">'+banksAcctsArray[index].bankAccountNumber+'</div>\n                                <div  class="card-action" style="font-weight: bold; font-size: 0.75em;\n                                color: #464646; padding-bottom: 0.5em;">'+banksAcctsArray[index].bankName+'</div>\n                                <div class="card-action" style="padding: 0;">\n                                <div style="display: inline-block; margin-left: auto; margin-right: auto">\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+"\"\n                                data-acct-object='"+JSON.stringify({recipientAccountName:banksAcctsArray[index].bankAccountName,recipientAccount:banksAcctsArray[index].bankAccountNumber,recipientBankCode:banksAcctsArray[index].flutterwave_bankCode})+'\' modifier="quiet" disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em; margin-right: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.savedRecipientsPageViewModel.transferCashButtonClicked(this);">\n                                <ons-icon icon="md-saveup-icon-saveup-transfer-cash" size="29px">\n                                </ons-icon>\n                                </ons-button>\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+'" modifier="quiet"\n                                disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.savedRecipientsPageViewModel.editRecipientButtonClicked(this);">\n                                   <ons-icon icon="md-edit" size="25px">\n                                </ons-icon>\n                                </ons-button>\n                                <ons-button data-id="'+banksAcctsArray[index].uniqueAccountId+'" modifier="quiet" disable-auto-styling class="right"\n                                        style="color: #464646; padding:0; margin-top: 0.5em; margin-left: 1em;"\n                                        onclick="utopiasoftware.saveup.controller.savedRecipientsPageViewModel.deleteRecipientButtonClicked(this);">\n                                <ons-icon icon="md-delete" size="25px"></ons-icon>\n                                </ons-button>\n                                </div></div></div></div></div></div>';$("#saved-recipients-list",$thisPage).append(bankAcctContent)}$(".progress",$thisPage).remove();$("#saved-recipients-help-1",$thisPage).css("display","inline-block");$("#saved-recipients-pull-hook",$thisPage).removeAttr("disabled");$("#saved-recipients-page-message",$thisPage).css("display","none");$("#saved-recipients-page-error",$thisPage).css("display","none");$("#saved-recipients-list",$thisPage).css("display","block");$("#saved-recipients-add-recipient-button",$thisPage).removeAttr("disabled")}}).catch(function(){$(".progress",$thisPage).remove();$("#saved-recipients-help-1",$thisPage).css("display","inline-block");$("#saved-recipients-pull-hook",$thisPage).removeAttr("disabled");$("#saved-recipients-page-message",$thisPage).css("display","none");$("#saved-recipients-page-error",$thisPage).css("display","block");$("#saved-recipients-list",$thisPage).css("display","none");$("#saved-recipients-add-recipient-button",$thisPage).attr("disabled",true)})}},addRecipientButtonClicked:function addRecipientButtonClicked(){$("#app-main-navigator").get(0).pushPage("add-recipient-page.html",{animation:"lift-md"})},deleteRecipientButtonClicked:function deleteRecipientButtonClicked(buttonElem){ons.notification.confirm("Do you want to delete this recipient's bank account?",{title:"Confirm Delete",buttonLabels:["No","Yes"]}).then(function(index){if(index===1){utopiasoftware.saveup.savedRecipientsBankAccountOperations.deleteSavedRecipientAccount($(buttonElem).attr("data-id")).then(function(){$(buttonElem).closest(".row").remove();Materialize.toast("Recipient's Bank Account deleted",3e3)}).catch(function(){window.plugins.toast.showWithOptions({message:"Sorry, the recipient's bank account could not be deleted.\n Try again",duration:4e3,position:"top",styling:{opacity:1,backgroundColor:"#ff0000",textColor:"#FFFFFF",textSize:14}},function(toastEvent){if(toastEvent&&toastEvent.event=="touch"){window.plugins.toast.hide()}})})}})},editRecipientButtonClicked:function editRecipientButtonClicked(buttonElem){$("#app-main-navigator").get(0).pushPage("add-recipient-page.html",{animation:"lift-md",data:{edit:$(buttonElem).attr("data-id")}})},transferCashButtonClicked:function transferCashButtonClicked(buttonElem){ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#verify-account-bottom-sheet").modal("close");$("#transfer-cash-page").remove();$("#app-main-navigator").get(0).pushPage("transfer-cash-page.html",{data:{recipient_details:JSON.parse($(buttonElem).attr("data-acct-object"))}})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}},addRecipientPageViewModel:{formValidator:null,previousScrollPosition:0,currentScrollPosition:0,bankAccountName:"",bankAccountImage:"",bankAccountImageRandomNum:null,tokenData:"",pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-input input",$thisPage).addClass("utopiasoftware-no-style");$("ons-splitter-side").removeAttr("swipeable",true);utopiasoftware.saveup.controller.addRecipientPageViewModel.previousScrollPosition=0;utopiasoftware.saveup.controller.addRecipientPageViewModel.currentScrollPosition=0;utopiasoftware.saveup.controller.addRecipientPageViewModel.bankAccountName="";utopiasoftware.saveup.controller.addRecipientPageViewModel.tokenData="";utopiasoftware.saveup.controller.addRecipientPageViewModel.bankAccountImage="";var randomGen=new Random(Random.engines.nativeMath);utopiasoftware.saveup.controller.addRecipientPageViewModel.bankAccountImageRandomNum=randomGen.integer(1,6);loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){if($("ons-splitter").get(0).left.isOpen){$("ons-splitter").get(0).left.close();return}$("#app-main-navigator").get(0).popPage()};$("#add-recipient-page .page__content").on("scroll",utopiasoftware.saveup.controller.addRecipientPageViewModel.pageContentScrolled);utopiasoftware.saveup.controller.addRecipientPageViewModel.formValidator=$("#add-recipient-form").parsley();$("#add-recipient-save-button").get(0).onclick=function(){if($("#add-recipient-account-verify-account").is(":checked")){$("#loader-modal #loader-modal-message").html("Preparing Device Storage...");$("#loader-modal").get(0).show();utopiasoftware.saveup.moneyWaveObject.useToken.then(function(tokenData){utopiasoftware.saveup.controller.addRecipientPageViewModel.tokenData=tokenData;$("#loader-modal").get(0).hide();utopiasoftware.saveup.controller.addRecipientPageViewModel.formValidator.whenValidate()}).catch(function(){utopiasoftware.saveup.controller.addRecipientPageViewModel.tokenData="";$("#loader-modal").get(0).hide();utopiasoftware.saveup.controller.addRecipientPageViewModel.formValidator.whenValidate()})}else{utopiasoftware.saveup.controller.addRecipientPageViewModel.formValidator.whenValidate()}};utopiasoftware.saveup.controller.addRecipientPageViewModel.formValidator.on("field:ajaxoptions",function(fieldInstance,ajaxOptions){ajaxOptions.headers={Authorization:utopiasoftware.saveup.controller.addRecipientPageViewModel.tokenData};ajaxOptions.data=JSON.stringify({account_number:$("#add-recipient-form #add-recipient-account-number").val(),bank_code:$("#add-recipient-form #add-recipient-choose-bank").val()});$("#add-recipient-account-number-validation-loading",$thisPage).css("display","block")});utopiasoftware.saveup.controller.addRecipientPageViewModel.formValidator.on("field:error",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").addClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").attr("data-hint",fieldInstance.getErrorsMessages()[0]);if($(fieldInstance.$element).is("#add-recipient-account-number")){$("#add-recipient-account-number-validation-loading",$thisPage).css("display","none");if($("#add-recipient-account-verify-account").is(":checked")){$("#add-recipient-page #add-recipient-account-name").val("")}else{}}});utopiasoftware.saveup.controller.addRecipientPageViewModel.formValidator.on("field:success",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").removeAttr("data-hint");if($(fieldInstance.$element).is("#add-recipient-account-number")){$("#add-recipient-account-number-validation-loading",$thisPage).css("display","none");if($("#add-recipient-account-verify-account").is(":checked")){$("#add-recipient-page #add-recipient-account-name").val(utopiasoftware.saveup.controller.addRecipientPageViewModel.bankAccountName);Materialize.updateTextFields()}else{}}});utopiasoftware.saveup.controller.addRecipientPageViewModel.formValidator.on("form:success",utopiasoftware.saveup.controller.addRecipientPageViewModel.addRecipientFormValidated);Promise.resolve(utopiasoftware.saveup.sortBanksData()).then(function(bankArrayData){var optionTags="";for(var index=0;index<bankArrayData.length;index++){var bankObject=bankArrayData[index];for(var prop in bankObject){optionTags+='<option value="'+prop+'">'+bankObject[prop]+"</option>"}}$("#add-recipient-choose-bank",$thisPage).append(optionTags);$("#add-recipient-choose-bank",$thisPage).material_select();return}).then(function(){$("#add-recipient-account-number",$thisPage).characterCounter();return}).then(function(){if($("#app-main-navigator").get(0).topPage.data&&$("#app-main-navigator").get(0).topPage.data.edit){utopiasoftware.saveup.savedRecipientsBankAccountOperations.getSavedRecipientAccount($("#app-main-navigator").get(0).topPage.data.edit).then(function(bankAcct){$("#add-recipient-page #add-recipient-unique-id").val(bankAcct.uniqueAccountId);$("#add-recipient-page #add-recipient-account-number").val(bankAcct.bankAccountNumber);$("#add-recipient-page #add-recipient-account-name").val(bankAcct.bankAccountName);$("#add-recipient-page #add-recipient-choose-bank").val(bankAcct.flutterwave_bankCode);$("#add-recipient-page #hidden-choose-bank-input").val(bankAcct.flutterwave_bankCode);Materialize.updateTextFields();$("select",$thisPage).material_select();$(".progress",$thisPage).remove();$("#add-recipient-form",$thisPage).css("display","block");$("#add-recipient-cancel-button, #add-recipient-save-button",$thisPage).removeAttr("disabled");$("#loader-modal").get(0).hide()})}else{$(".progress",$thisPage).remove();$("#add-recipient-form",$thisPage).css("display","block");$("#add-recipient-cancel-button, #add-recipient-save-button",$thisPage).removeAttr("disabled");$("#loader-modal").get(0).hide()}}).catch()}},pageHide:function pageHide(event){try{$("#add-recipient-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#add-recipient-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.addRecipientPageViewModel.formValidator.reset()}catch(err){}},pageDestroy:function pageDestroy(event){try{$("#add-recipient-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#add-recipient-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.addRecipientPageViewModel.formValidator.destroy();$("#add-recipient-page select").material_select("destroy");$("#add-recipient-page #add-recipient-account-number").off();$("#add-recipient-page #add-recipient-account-number").removeData()}catch(err){}},addRecipientFormValidated:function addRecipientFormValidated(){$("#secure-storage-modal .modal-message").html("Storing Recipient's Bank Account on Device...");$("#secure-storage-modal").get(0).show();utopiasoftware.saveup.controller.addRecipientPageViewModel.bankAccountImage="css/app-images/avatar-"+utopiasoftware.saveup.controller.addRecipientPageViewModel.bankAccountImageRandomNum+".png";if($("#app-main-navigator").get(0).topPage.data&&$("#app-main-navigator").get(0).topPage.data.edit){utopiasoftware.saveup.savedRecipientsBankAccountOperations.deleteSavedRecipientAccount($("#app-main-navigator").get(0).topPage.data.edit).then(function(){var editedBankAcctData={uniqueAccountId:$("#app-main-navigator").get(0).topPage.data.edit,bankAccountNumber:$("#add-recipient-form #add-recipient-account-number").val(),bankAccountName:$("#add-recipient-form #add-recipient-account-name").val(),bankName:$("#add-recipient-form #add-recipient-choose-bank option:selected").text().trim(),flutterwave_bankCode:$("#add-recipient-form #add-recipient-choose-bank").val(),bankAccountAvatar:utopiasoftware.saveup.controller.addRecipientPageViewModel.bankAccountImage};return utopiasoftware.saveup.savedRecipientsBankAccountOperations.addSavedRecipientAccount(editedBankAcctData)}).then(function(){window.setTimeout(function(){utopiasoftware.saveup.controller.addRecipientPageViewModel.formValidator.reset();$("#add-recipient-page #add-recipient-form").get(0).reset();$("#add-recipient-page select").material_select();utopiasoftware.saveup.controller.addRecipientPageViewModel.isbankAccountNumberValidated($("#add-recipient-page #add-recipient-account-verify-account"));utopiasoftware.saveup.controller.addRecipientPageViewModel.bankAccountName="";utopiasoftware.saveup.controller.addRecipientPageViewModel.tokenData="";utopiasoftware.saveup.controller.addRecipientPageViewModel.bankAccountImage="";$("#add-recipient-page .page__content").scrollTop(0);$("#secure-storage-modal").get(0).hide();Materialize.toast("Recipient Account updated",4e3)},4e3)}).catch(function(){$("#secure-storage-modal").get(0).hide();ons.notification.alert({title:"Update Error",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+(err.message||"")+" Sorry, this recipient's bank account could not be updated. "+"<br>You can try again"+"</span>",cancelable:true})})}else{var newBankAcctData={uniqueAccountId:""+utopiasoftware.saveup.model.deviceUUID+Date.now(),bankAccountNumber:$("#add-recipient-form #add-recipient-account-number").val(),bankAccountName:$("#add-recipient-form #add-recipient-account-name").val(),bankName:$("#add-recipient-form #add-recipient-choose-bank option:selected").text().trim(),flutterwave_bankCode:$("#add-recipient-form #add-recipient-choose-bank").val(),bankAccountAvatar:utopiasoftware.saveup.controller.addRecipientPageViewModel.bankAccountImage};utopiasoftware.saveup.savedRecipientsBankAccountOperations.addSavedRecipientAccount(newBankAcctData).then(function(){window.setTimeout(function(){utopiasoftware.saveup.controller.addRecipientPageViewModel.formValidator.reset();$("#add-recipient-page #add-recipient-form").get(0).reset();$("#add-recipient-page select").material_select();utopiasoftware.saveup.controller.addRecipientPageViewModel.isbankAccountNumberValidated($("#add-recipient-page #add-recipient-account-verify-account"));utopiasoftware.saveup.controller.addRecipientPageViewModel.bankAccountName="";utopiasoftware.saveup.controller.addRecipientPageViewModel.tokenData="";utopiasoftware.saveup.controller.addRecipientPageViewModel.bankAccountImage="";$("#add-recipient-page .page__content").scrollTop(0);$("#secure-storage-modal").get(0).hide();Materialize.toast("Recipient's bank account added",4e3)},4e3)}).catch(function(err){$("#secure-storage-modal").get(0).hide();ons.notification.alert({title:"Save Error",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+(err.message||"")+" Sorry, this recipient's bank account could not be added. "+"<br>You can try again"+"</span>",cancelable:true})})}},isbankAccountNumberValidated:function isbankAccountNumberValidated(checkElem){if($(checkElem).is(":checked")){$("#add-recipient-account-number").attr("data-parsley-remote-validator","recipientaccountnumbercheck");$("#add-recipient-account-name").attr("disabled",true);$("#add-recipient-account-name").val("");$("#add-recipient-account-name").parent().find("label:eq(0)").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#add-recipient-account-name").parent().find("label:eq(0)").removeAttr("data-hint");$("#add-recipient-account-verify-account-notice").css("display","block")}else{$("#add-recipient-account-number").removeAttr("data-parsley-remote-validator");$("#add-recipient-account-name").removeAttr("disabled");$("#add-recipient-account-name").val("");$("#add-recipient-account-verify-account-notice").css("display","none")}},pageContentScrolled:function pageContentScrolled(event){utopiasoftware.saveup.controller.addRecipientPageViewModel.currentScrollPosition=$(this).scrollTop();if(utopiasoftware.saveup.controller.addRecipientPageViewModel.currentScrollPosition>utopiasoftware.saveup.controller.addRecipientPageViewModel.previousScrollPosition){utopiasoftware.saveup.controller.addRecipientPageViewModel.previousScrollPosition=utopiasoftware.saveup.controller.addRecipientPageViewModel.currentScrollPosition;if(140-utopiasoftware.saveup.controller.addRecipientPageViewModel.currentScrollPosition<=56){if(this.isToolBarOpaque!=true){$("#add-recipient-page ons-toolbar").removeClass("toolbar--transparent translucent-toolbar");$("#add-recipient-page ons-list-header").css({display:"block",position:"fixed",top:"56px",width:"100%"});this.isToolBarOpaque=true}}return}if(utopiasoftware.saveup.controller.addRecipientPageViewModel.currentScrollPosition<utopiasoftware.saveup.controller.addRecipientPageViewModel.previousScrollPosition){utopiasoftware.saveup.controller.addRecipientPageViewModel.previousScrollPosition=utopiasoftware.saveup.controller.addRecipientPageViewModel.currentScrollPosition;if(140-utopiasoftware.saveup.controller.addRecipientPageViewModel.currentScrollPosition>56){if(this.isToolBarOpaque==true){$("#add-recipient-page ons-toolbar").addClass("toolbar--transparent translucent-toolbar");$("#add-recipient-page ons-list-header").css({display:"block",position:"static",top:"56px"});this.isToolBarOpaque=false}}return}},resetAccountNameDisplay:function resetAccountNameDisplay(){if($("#add-recipient-page #add-recipient-account-verify-account").is(":checked")){$("#add-recipient-page #add-recipient-account-name").val("")}},recipientAccountNumberValidator:function recipientAccountNumberValidator(jqxhr){var serverResponse="";if(jqxhr.status!=200){return false}serverResponse=JSON.parse(jqxhr.responseText.trim());if(serverResponse.status!="success"){return false}else{utopiasoftware.saveup.controller.addRecipientPageViewModel.bankAccountName=serverResponse.data.account_name;return true}}},transferCashCardPageViewModel:{formValidator:null,transferAmountFieldValidator:null,previousScrollPosition:0,currentScrollPosition:0,pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-input input",$thisPage).addClass("utopiasoftware-no-style");$("ons-splitter-side").attr("swipeable",true);utopiasoftware.saveup.controller.transferCashCardPageViewModel.previousScrollPosition=0;utopiasoftware.saveup.controller.transferCashCardPageViewModel.currentScrollPosition=0;loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){if($("ons-splitter").get(0).left.isOpen){$("ons-splitter").get(0).left.close();return}if($(".transfer-cash-tabbar").get(0).getActiveTabIndex()==0){$("#app-main-navigator").get(0).resetToPage("main-menu-page.html")}else{$(".transfer-cash-tabbar").get(0).setActiveTab(0,{animation:"slide"})}};$("ons-carousel",$thisPage).on("scroll",utopiasoftware.saveup.controller.transferCashCardPageViewModel.pageContentScrolled);utopiasoftware.saveup.controller.transferCashCardPageViewModel.transferAmountFieldValidator=$("#transfer-cash-card-amount",$thisPage).parsley({value:function value(parsley){var parsedNumber=kendo.parseFloat($("#transfer-cash-card-amount",$thisPage).val());return parsedNumber?parsedNumber:$("#transfer-cash-card-amount",$thisPage).val()}});utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator=$("#transfer-cash-card-form",$thisPage).parsley();$("#transfer-cash-card-button",$thisPage).get(0).onclick=function(){utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.whenValidate()};utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.on("field:error",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").addClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").attr("data-hint",fieldInstance.getErrorsMessages()[0])});utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.on("field:success",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").removeAttr("data-hint")});utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.on("form:success",utopiasoftware.saveup.controller.transferCashCardPageViewModel.transferCashCardFormValidated);utopiasoftware.saveup.financialCardOperations.loadCardData().then(function(cardsArrayData){var autoCompleteData={};cardsArrayData.forEach(function(arrayElem){autoCompleteData[arrayElem.cardNickName+" - "+arrayElem.cardNumber]=arrayElem.cardImage});$("#transfer-cash-card-number.autocomplete",$thisPage).autocomplete({data:autoCompleteData,onAutocomplete:function onAutocomplete(val){},minLength:1});return utopiasoftware.saveup.savedRecipientsBankAccountOperations.loadSavedRecipientsAccountsData()},function(){return[]}).then(function(savedRecipientsArray){var autoCompleteData={};savedRecipientsArray.forEach(function(arrayElem){autoCompleteData[arrayElem.bankAccountName+" - "+arrayElem.bankAccountNumber]=arrayElem.bankAccountAvatar});$("#transfer-cash-card-recipient-account-name.autocomplete",$thisPage).autocomplete({data:autoCompleteData,onAutocomplete:function onAutocomplete(val){},minLength:1});return utopiasoftware.saveup.sortBanksData()},function(){return[]}).then(function(bankArrayData){var optionTags="";for(var index=0;index<bankArrayData.length;index++){var bankObject=bankArrayData[index];for(var prop in bankObject){optionTags+='<option value="'+prop+'">'+bankObject[prop]+"</option>"}}$("#transfer-cash-card-choose-bank",$thisPage).append(optionTags);$("#transfer-cash-card-choose-bank",$thisPage).material_select();return},function(){return null}).then(function(){var optionTags="";var yearOption=(new Date).getFullYear();optionTags+='<option value="'+yearOption+'">'+yearOption+"</option>";for(var index=0;index<3;index++){yearOption+=1;optionTags+='<option value="'+yearOption+'">'+yearOption+"</option>"}$("#transfer-cash-card-expiry-year",$thisPage).append(optionTags);$("select",$thisPage).material_select();return null},function(){return null}).then(function(){var pageDataObject=$("#app-main-navigator").get(0).topPage.data;if(pageDataObject&&pageDataObject.recipient_details){$("#transfer-cash-card-recipient-account-name",$thisPage).val(pageDataObject.recipient_details.recipientAccountName+" - "+pageDataObject.recipient_details.recipientAccount);$("#transfer-cash-card-choose-bank",$thisPage).val(pageDataObject.recipient_details.recipientBankCode);$("#hidden-choose-bank-input",$thisPage).val(pageDataObject.recipient_details.recipientBankCode)}if(pageDataObject&&pageDataObject.sender_details){$(".transfer-cash-tabbar").get(0).setActiveTab(1,{animation:"slide"})}if(pageDataObject&&pageDataObject.sender_card_details){$("#transfer-cash-card-number",$thisPage).val(pageDataObject.sender_card_details.senderCardNickName+" - "+pageDataObject.sender_card_details.senderCardNumber);$("#transfer-cash-card-cvv",$thisPage).val(pageDataObject.sender_card_details.senderCardCvv);$("#transfer-cash-card-expiry-month",$thisPage).val(pageDataObject.sender_card_details.senderCardExpiryMonth);$("#hidden-card-expiry-month-input",$thisPage).val(pageDataObject.sender_card_details.senderCardExpiryMonth);$("#transfer-cash-card-expiry-year",$thisPage).val(pageDataObject.sender_card_details.senderCardExpiryYear);$("#hidden-card-expiry-year-input",$thisPage).val(pageDataObject.sender_card_details.senderCardExpiryYear);$(".postcash-transfer-cash-card-hidden-info:eq(0)",$thisPage).css("display","block")}$("select",$thisPage).material_select();Materialize.updateTextFields();return null},function(){return null}).then(function(){$(".progress",$thisPage).remove();$("#transfer-cash-card-form",$thisPage).css("display","block");$("#transfer-cash-card-cancel-button-1, #transfer-cash-card-button",$thisPage).removeAttr("disabled");$("#loader-modal").get(0).hide()},function(){})}},pageShow:function pageShow(event){$("ons-splitter-side").attr("swipeable",true)},pageHide:function pageHide(event){var $thisPage=$(event.target);try{$("[data-hint]",$thisPage).removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("[data-hint]",$thisPage).removeAttr("data-hint");utopiasoftware.saveup.controller.transferCashCardPageViewModel.transferAmountFieldValidator.reset();utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.reset()}catch(err){}},pageDestroy:function pageDestroy(event){var $thisPage=$(event.target);try{$("[data-hint]",$thisPage).removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("[data-hint]",$thisPage).removeAttr("data-hint");utopiasoftware.saveup.controller.transferCashCardPageViewModel.transferAmountFieldValidator.reset();utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.destroy();$("select",$thisPage).material_select("destroy");$("input.autocomplete",$thisPage).off();$("input.autocomplete",$thisPage).removeData()}catch(err){}},transferCashCardFormValidated:function transferCashCardFormValidated(){if(navigator.connection.type===Connection.NONE){window.plugins.toast.showWithOptions({message:"You cannot transfer cash without an active Internet Connection",duration:4500,position:"top",styling:{opacity:1,backgroundColor:"#ff0000",textColor:"#FFFFFF",textSize:14}},function(toastEvent){if(toastEvent&&toastEvent.event=="touch"){window.plugins.toast.hide()}});return}ons.notification.confirm({title:'<ons-icon icon="md-alert-triangle" size="36px" '+'style="color: orange;"></ons-icon> Confirm Transfer',messageHTML:"<span>Cash transfers cannot be undone or reversed when completed. <br>"+"Do you want to continue?</span>",cancelable:false,buttonLabels:["No","Yes"]}).then(function(buttonIndex){if(buttonIndex===1){$("#loader-modal-message").html("Initiating Transfer...");$("#loader-modal").get(0).show();return utopiasoftware.saveup.moneyWaveObject.useToken}else{throw null}}).then(function(token){if(token===null){throw null}else{var cashTransferData={firstname:utopiasoftware.saveup.model.appUserDetails.firstName.split(" ")[0],lastname:utopiasoftware.saveup.model.appUserDetails.lastName.split(" ")[0],phonenumber:utopiasoftware.saveup.model.appUserDetails.phoneNumber_intlFormat,email:utopiasoftware.saveup.model.appUserDetails.firstName.split(" ")[0]+utopiasoftware.saveup.model.appUserDetails.lastName.split(" ")[0]+Date.now()+"@mymail.com",apiKey:utopiasoftware.saveup.moneyWaveObject.key.apiKey,medium:"mobile",fee:utopiasoftware.saveup.model.fee,redirecturl:"https://postcash.000webhostapp.com/transfer-cash-card.html",card_no:$("#transfer-cash-card-number","#transfer-cash-card-page").val().split(" - ").pop(),cvv:$("#transfer-cash-card-cvv","#transfer-cash-card-page").val(),expiry_year:$("#transfer-cash-card-expiry-year","#transfer-cash-card-page").val(),expiry_month:$("#transfer-cash-card-expiry-month","#transfer-cash-card-page").val(),amount:kendo.parseFloat($("#transfer-cash-card-amount","#transfer-cash-card-page").val()),narration:$("#transfer-cash-card-narration","#transfer-cash-card-page").val(),recipient_bank:$("#transfer-cash-card-choose-bank","#transfer-cash-card-page").val(),recipient_account_number:$("#transfer-cash-card-recipient-account-name","#transfer-cash-card-page").val().split(" - ").pop()};if(!$("#transfer-cash-card-pin","#transfer-cash-card-form").is(":disabled")){cashTransferData.charge_auth="PIN";cashTransferData.pin=$("#transfer-cash-card-pin","#transfer-cash-card-page").val()}return new Promise(function(resolve,reject){var cashTransferRequest=$.ajax({url:utopiasoftware.saveup.moneyWaveObject.gateway+"v1/transfer",type:"post",contentType:"application/json",beforeSend:function beforeSend(jqxhr){jqxhr.setRequestHeader("Authorization",token)},dataType:"json",timeout:24e4,processData:false,data:JSON.stringify(cashTransferData)});cashTransferRequest.done(function(responseData){if(responseData.status==="success"){resolve(responseData)}else{reject(responseData)}});cashTransferRequest.fail(function(jqxhr){if(jqxhr.status==500){reject(JSON.parse(jqxhr.responseText.trim()))}else{reject(jqxhr.responseText.trim())}})})}}).then(function(responseData){responseData.data.transfer.postcash_transaction_type="Cash Transfer (Card)";return Promise.all([utopiasoftware.saveup.transactionHistoryOperations.addTransactionHistory(responseData.data.transfer),Promise.resolve(responseData)])}).then(function(responseDataArray){if(responseDataArray==null||responseDataArray[1]==null){throw null}var responseData=responseDataArray[1];$("#transfer-cash-card-authorize-amount","#transfer-cash-card-page").html(kendo.toString(kendo.parseFloat(responseData.data.transfer.amountToSend),"n2"));$("#transfer-cash-card-authorize-fee","#transfer-cash-card-page").html(kendo.toString(kendo.parseFloat(responseData.data.transfer.chargedFee),"n2"));$("#transfer-cash-card-authorize-total","#transfer-cash-card-page").html(kendo.toString(kendo.parseFloat(responseData.data.transfer.amountToCharge),"n2"));$("#transfer-cash-card-authorize-message","#transfer-cash-card-page").html(responseData.data.transfer.flutterChargeResponseMessage);window.sessionStorage.setItem("transaction_id",responseData.data.transfer.id);window.sessionStorage.setItem("transaction_ref",responseData.data.transfer.flutterChargeReference);$(".transfer-cash-card-page-bottom-toolbar-transfer-block").css("display","none");if($("#transfer-cash-card-pin","#transfer-cash-card-form").is(":disabled")){window.sessionStorage.setItem("transaction_authurl",responseData.data.authurl);$("#transfer-cash-card-authorise-form","#transfer-cash-card-page").css("display","none");$("#transfer-cash-card-authorise-button").attr("disabled",true);$(".transfer-cash-card-page-bottom-toolbar-authorize-otp-block").css("display","block");$(".transfer-cash-card-page-bottom-toolbar-authorize-pin-block").css("display","none")}else{$("#transfer-cash-card-authorise-form","#transfer-cash-card-page").css("display","block");$("#transfer-cash-card-authorise-button").removeAttr("disabled");$(".transfer-cash-card-page-bottom-toolbar-authorize-otp-block").css("display","none");$(".transfer-cash-card-page-bottom-toolbar-authorize-pin-block").css("display","block")}$(".postcash-pay-progress .col:eq(0) span:eq(0)").removeClass("postcash-pay-progress-milestone-active").addClass("postcash-pay-progress-milestone");$(".postcash-pay-progress .col:eq(0) span:eq(1)").removeClass("postcash-pay-progress-milestone-text-active").addClass("postcash-pay-progress-milestone-text");$(".postcash-pay-progress .col:eq(1) span:eq(0)").removeClass("postcash-pay-progress-milestone").addClass("postcash-pay-progress-milestone-active");$(".postcash-pay-progress .col:eq(1) span:eq(1)").removeClass("postcash-pay-progress-milestone-text").addClass("postcash-pay-progress-milestone-text-active");return $(".transfer-cash-card-carousel").get(0).next({animation:"none"})}).then(function(serverResponse){if(serverResponse==null){throw null}$("#loader-modal").get(0).hide()}).catch(function(error){$("#loader-modal").get(0).hide();if(error==null){return}ons.notification.alert({title:"Cash Transfer Failed",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+(error.data||"")+" Sorry, your cash transfer failed. "+"<br>You can try again"+"</span>",cancelable:true})})},transferCashCardOtpAuthorize:function transferCashCardOtpAuthorize(){var tokenData="";if(true){$("#loader-modal-message").html("Checking Authorization... Please Wait");$("#loader-modal").get(0).show();utopiasoftware.saveup.moneyWaveObject.useToken.then(function(token){tokenData=token;return new Promise(function(resolve,reject){var cashTransferAuthorisation=$.ajax({url:utopiasoftware.saveup.moneyWaveObject.gateway+"v1/transfer/"+window.sessionStorage.getItem("transaction_id"),type:"post",contentType:"application/json",beforeSend:function beforeSend(jqxhr){jqxhr.setRequestHeader("Authorization",token)},dataType:"json",timeout:24e4,processData:false,data:JSON.stringify({})});cashTransferAuthorisation.done(function(responseData){if(responseData.status==="success"){resolve(responseData)}else{reject(responseData)}});cashTransferAuthorisation.fail(function(jqxhr){reject(JSON.parse(jqxhr.responseText.trim()))})})}).then(function(responseData){if(responseData.data.flutterChargeResponseMessage.toLocaleUpperCase()=="APPROVED"){$(".postcash-pay-progress .col:eq(0) span:eq(0)").removeClass("postcash-pay-progress-milestone-active").addClass("postcash-pay-progress-milestone");$(".postcash-pay-progress .col:eq(0) span:eq(1)").removeClass("postcash-pay-progress-milestone-text-active").addClass("postcash-pay-progress-milestone-text");$(".postcash-pay-progress .col:eq(1) span:eq(0)").removeClass("postcash-pay-progress-milestone-active").addClass("postcash-pay-progress-milestone");$(".postcash-pay-progress .col:eq(1) span:eq(1)").removeClass("postcash-pay-progress-milestone-text-active").addClass("postcash-pay-progress-milestone-text");$(".postcash-pay-progress .col:eq(2) span:eq(0)").removeClass("postcash-pay-progress-milestone").addClass("postcash-pay-progress-milestone-active");$(".postcash-pay-progress .col:eq(2) span:eq(1)").removeClass("postcash-pay-progress-milestone-text").addClass("postcash-pay-progress-milestone-text-active");$(".transfer-cash-card-page-bottom-toolbar-transfer-block").css("display","none");$(".transfer-cash-card-page-bottom-toolbar-authorize-otp-block").css("display","none");$(".transfer-cash-card-page-bottom-toolbar-authorize-pin-block").css("display","none");$("#transfer-cash-card-authorise-iframe").attr("src","");return $("#transfer-cash-card-authorise-modal").get(0).hide()}else{throw responseData}}).then(function(){return utopiasoftware.saveup.transactionHistoryOperations.updateTransactionHistory(window.sessionStorage.getItem("transaction_ref"),"APPROVED")}).then(function(){return new Promise(function(resolve,reject){utopiasoftware.saveup.kinveyBaasOperations.checkKinveyInitialised().then(function(){resolve({})},function(){resolve(Promise.resolve(utopiasoftware.saveup.kinveyBaasOperations.initialiseKinvey()))})})}).then(function(){var transferData={authorizationToken:tokenData,postcash_fee:utopiasoftware.saveup.model.fee};return utopiasoftware.saveup.kinveyBaasOperations.transferWalletCash(transferData)}).then(function(){return Promise.all([$("#loader-modal").get(0).hide(),$(".transfer-cash-card-carousel").get(0).next({animation:"none"})])}).then(function(){return $("#financial-operations-success-modal").get(0).show()}).then(function(){window.setTimeout(function(){$("#financial-operations-success-modal .circle").addClass("show")},1e3)}).catch(function(error){$("#loader-modal").get(0).hide();$("#transfer-cash-card-authorise-modal").get(0).hide();ons.notification.alert({title:"Cash Transfer Failed",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+(error.message||"")+" Sorry, your cash transfer was not authorised. "+"<br>You can check this transaction status OR resend the cash transfer"+"</span>",cancelable:true}).then(function(){$("#app-main-navigator").get(0).resetToPage("main-menu-page.html")})})}},transferCashCardPinAuthorize:function transferCashCardPinAuthorize(){if(navigator.connection.type===Connection.NONE){window.plugins.toast.showWithOptions({message:"You cannot transfer cash without an active Internet Connection",duration:4500,position:"top",styling:{opacity:1,backgroundColor:"#ff0000",textColor:"#FFFFFF",textSize:14}},function(toastEvent){if(toastEvent&&toastEvent.event=="touch"){window.plugins.toast.hide()}});return}var tokenData="";$("#loader-modal-message").html("Checking Authorization... Please Wait");$("#loader-modal").get(0).show();utopiasoftware.saveup.moneyWaveObject.useToken.then(function(token){tokenData=token;return new Promise(function(resolve,reject){var cashTransferAuthoriseRequest=$.ajax({url:utopiasoftware.saveup.moneyWaveObject.gateway+"v1/transfer/charge/auth/card",type:"post",contentType:"application/json",beforeSend:function beforeSend(jqxhr){jqxhr.setRequestHeader("Authorization",token)},dataType:"json",timeout:24e4,processData:false,data:JSON.stringify({transactionRef:window.sessionStorage.getItem("transaction_ref"),otp:$("#transfer-cash-card-otp","#transfer-cash-card-page").val()})});cashTransferAuthoriseRequest.done(function(responseData){if(responseData.status==="success"){resolve(responseData)}else{reject(responseData)}});cashTransferAuthoriseRequest.fail(function(jqxhr){if(jqxhr.status==500){reject(JSON.parse(jqxhr.responseText.trim()))}else{reject(jqxhr.responseText.trim())}})})}).then(function(responseData){if(responseData.data.flutterChargeResponseMessage.toLocaleUpperCase().indexOf("APPROVED")>-1){$(".postcash-pay-progress .col:eq(0) span:eq(0)").removeClass("postcash-pay-progress-milestone-active").addClass("postcash-pay-progress-milestone");$(".postcash-pay-progress .col:eq(0) span:eq(1)").removeClass("postcash-pay-progress-milestone-text-active").addClass("postcash-pay-progress-milestone-text");$(".postcash-pay-progress .col:eq(1) span:eq(0)").removeClass("postcash-pay-progress-milestone-active").addClass("postcash-pay-progress-milestone");$(".postcash-pay-progress .col:eq(1) span:eq(1)").removeClass("postcash-pay-progress-milestone-text-active").addClass("postcash-pay-progress-milestone-text");$(".postcash-pay-progress .col:eq(2) span:eq(0)").removeClass("postcash-pay-progress-milestone").addClass("postcash-pay-progress-milestone-active");$(".postcash-pay-progress .col:eq(2) span:eq(1)").removeClass("postcash-pay-progress-milestone-text").addClass("postcash-pay-progress-milestone-text-active");$(".transfer-cash-card-page-bottom-toolbar-transfer-block").css("display","none");$(".transfer-cash-card-page-bottom-toolbar-authorize-otp-block").css("display","none");$(".transfer-cash-card-page-bottom-toolbar-authorize-pin-block").css("display","none");return null}else{throw responseData}}).then(function(){return utopiasoftware.saveup.transactionHistoryOperations.updateTransactionHistory(window.sessionStorage.getItem("transaction_ref"),"APPROVED")}).then(function(){return new Promise(function(resolve,reject){utopiasoftware.saveup.kinveyBaasOperations.checkKinveyInitialised().then(function(){resolve({})},function(){resolve(Promise.resolve(utopiasoftware.saveup.kinveyBaasOperations.initialiseKinvey()))})})}).then(function(){var transferData={authorizationToken:tokenData,postcash_fee:utopiasoftware.saveup.model.fee};return utopiasoftware.saveup.kinveyBaasOperations.transferWalletCash(transferData)}).then(function(){return Promise.all([$("#loader-modal").get(0).hide(),$(".transfer-cash-card-carousel").get(0).next({animation:"none"})])}).then(function(){return $("#financial-operations-success-modal").get(0).show()}).then(function(){window.setTimeout(function(){$("#financial-operations-success-modal .circle").addClass("show")},1e3)}).catch(function(error){$("#loader-modal").get(0).hide();ons.notification.alert({title:"Cash Transfer Failed",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+(error.message||"")+" Sorry, your cash transfer was not authorised. "+"<br>You can check this transaction status OR resend the cash transfer"+"</span>",cancelable:true}).then(function(){$("#app-main-navigator").get(0).resetToPage("main-menu-page.html")})})},cardNumberChanged:function cardNumberChanged(inputElem){$(".postcash-preloader-transfer-cash-card-form-container",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).css("display","block");var valueSplitArray=$(inputElem).val().split(" - ");var cardNumber=valueSplitArray.pop();utopiasoftware.saveup.financialCardOperations.getCardByNumber(cardNumber).then(function(cardObject){if(!cardObject){throw"error"}$("#transfer-cash-card-cvv",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).val(cardObject.cvv);$("#transfer-cash-card-expiry-month",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).val(cardObject.cardExpiryMonth);$("#transfer-cash-card-expiry-year",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).val(cardObject.cardExpiryYear);$("#hidden-card-expiry-month-input",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).val(cardObject.cardExpiryMonth);$("#hidden-card-expiry-year-input",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).val(cardObject.cardExpiryYear);$("[data-hint]",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("[data-hint]",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).removeAttr("data-hint");if(cardObject.cardBrand=="Unknown"||cardObject.cardLocale=="Unknown"){$(".postcash-transfer-cash-card-hidden-info:eq(0)",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).css("display","block")}else{$(".postcash-transfer-cash-card-hidden-info:eq(0)",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).css("display","none")}if((cardObject.cardBrand=="Mastercard"||cardObject.cardBrand=="Verve")&&cardObject.cardLocale=="local"){$(".postcash-transfer-cash-card-hidden-info:eq(1)",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).css("display","block");$("#transfer-cash-card-pin",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).removeAttr("disabled")}else{$(".postcash-transfer-cash-card-hidden-info:eq(1)",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).css("display","none");$("#transfer-cash-card-pin",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).attr("disabled",true)}Materialize.updateTextFields();$("select",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).material_select();$(".postcash-preloader-transfer-cash-card-form-container",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).css("display","none")}).catch(function(){$(".postcash-transfer-cash-card-hidden-info:eq(0)",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).css("display","block");$(".postcash-transfer-cash-card-hidden-info:eq(1)",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).css("display","none");$("#transfer-cash-card-pin",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).attr("disabled",true);Materialize.updateTextFields();$("select",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).material_select();$(".postcash-preloader-transfer-cash-card-form-container",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).css("display","none")})},verifyCardTypeCheckboxClicked:function verifyCardTypeCheckboxClicked(inputElem){if($("#transfer-cash-card-verify-card-type",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).is(":checked")){$(".postcash-transfer-cash-card-hidden-info:eq(1)",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).css("display","block");$("#transfer-cash-card-pin",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).removeAttr("disabled")}else{$(".postcash-transfer-cash-card-hidden-info:eq(1)",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).css("display","none");$("#transfer-cash-card-pin",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).attr("disabled",true)}Materialize.updateTextFields()},pageContentScrolled:function pageContentScrolled(event){utopiasoftware.saveup.controller.transferCashCardPageViewModel.currentScrollPosition=$(this).scrollTop();if(utopiasoftware.saveup.controller.transferCashCardPageViewModel.currentScrollPosition>utopiasoftware.saveup.controller.transferCashCardPageViewModel.previousScrollPosition){utopiasoftware.saveup.controller.transferCashCardPageViewModel.previousScrollPosition=utopiasoftware.saveup.controller.transferCashCardPageViewModel.currentScrollPosition;if(utopiasoftware.saveup.controller.transferCashCardPageViewModel.currentScrollPosition>=10){if($(".transfer-cash-tabbar").last().get(0).visible==true){$(".transfer-cash-tabbar").last().get(0).setTabbarVisibility(false)}}return}if(utopiasoftware.saveup.controller.transferCashCardPageViewModel.currentScrollPosition<utopiasoftware.saveup.controller.transferCashCardPageViewModel.previousScrollPosition){utopiasoftware.saveup.controller.transferCashCardPageViewModel.previousScrollPosition=utopiasoftware.saveup.controller.transferCashCardPageViewModel.currentScrollPosition;if($(".transfer-cash-tabbar").last().get(0).visible==false){$(".transfer-cash-tabbar").last().get(0).setTabbarVisibility(true)}return}},recipientAccountNumberChanged:function recipientAccountNumberChanged(inputElem){$(".postcash-preloader-transfer-cash-card-form-container",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).css("display","block");var valueSplitArray=$(inputElem).val().split(" - ");var accountNumber=valueSplitArray.pop();utopiasoftware.saveup.savedRecipientsBankAccountOperations.getSavedRecipientAccountByNumber(accountNumber).then(function(acctObject){if(!acctObject){throw"error"}$("#transfer-cash-card-choose-bank",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).val(acctObject.flutterwave_bankCode);$("#hidden-choose-bank-input",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).val(acctObject.flutterwave_bankCode);$("[data-hint]",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("[data-hint]",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).removeAttr("data-hint");$("select",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).material_select();$(".postcash-preloader-transfer-cash-card-form-container",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).css("display","none")}).catch(function(){$("select",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).material_select();$(".postcash-preloader-transfer-cash-card-form-container",utopiasoftware.saveup.controller.transferCashCardPageViewModel.formValidator.$element).css("display","none")})},transferCashCardAuthorizeProceed:function transferCashCardAuthorizeProceed(){$("#transfer-cash-card-authorise-iframe").attr("src","");$("#transfer-cash-card-authorise-iframe").attr("src",window.sessionStorage.getItem("transaction_authurl"));$("#transfer-cash-card-authorise-modal").get(0).show()}},transferCashBankPageViewModel:{formValidator:null,transferAmountFieldValidator:null,previousScrollPosition:0,currentScrollPosition:0,pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-input input",$thisPage).addClass("utopiasoftware-no-style");$("ons-splitter-side").attr("swipeable",true);utopiasoftware.saveup.controller.transferCashBankPageViewModel.previousScrollPosition=0;utopiasoftware.saveup.controller.transferCashBankPageViewModel.currentScrollPosition=0;loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){if($("ons-splitter").get(0).left.isOpen){$("ons-splitter").get(0).left.close();return}if($(".transfer-cash-tabbar").get(0).getActiveTabIndex()==0){$("#app-main-navigator").get(0).resetToPage("main-menu-page.html")}else{$(".transfer-cash-tabbar").get(0).setActiveTab(0,{animation:"slide"})}};$("ons-carousel",$thisPage).on("scroll",utopiasoftware.saveup.controller.transferCashBankPageViewModel.pageContentScrolled);utopiasoftware.saveup.controller.transferCashBankPageViewModel.transferAmountFieldValidator=$("#transfer-cash-bank-amount",$thisPage).parsley({value:function value(parsley){var parsedNumber=kendo.parseFloat($("#transfer-cash-bank-amount",$thisPage).val());return parsedNumber?parsedNumber:$("#transfer-cash-bank-amount",$thisPage).val()}});utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator=$("#transfer-cash-bank-form",$thisPage).parsley();$("#transfer-cash-bank-button",$thisPage).get(0).onclick=function(){utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.whenValidate()};utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.on("field:error",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").addClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").attr("data-hint",fieldInstance.getErrorsMessages()[0])});utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.on("field:success",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").removeAttr("data-hint")});utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.on("form:success",utopiasoftware.saveup.controller.transferCashBankPageViewModel.transferCashBankFormValidated);utopiasoftware.saveup.bankAccountOperations.loadMyAccountsData().then(function(bankAcctArrayData){var autoCompleteData={};bankAcctArrayData.forEach(function(arrayElem){autoCompleteData[arrayElem.bankAccountName+" - "+arrayElem.bankAccountNumber]=arrayElem.bankAccountAvatar});$("#transfer-cash-bank-sender-account-name.autocomplete",$thisPage).autocomplete({data:autoCompleteData,onAutocomplete:function onAutocomplete(val){},minLength:1});return utopiasoftware.saveup.savedRecipientsBankAccountOperations.loadSavedRecipientsAccountsData()},function(){return[]}).then(function(savedRecipientsArray){var autoCompleteData={};savedRecipientsArray.forEach(function(arrayElem){autoCompleteData[arrayElem.bankAccountName+" - "+arrayElem.bankAccountNumber]=arrayElem.bankAccountAvatar});$("#transfer-cash-bank-recipient-account-name.autocomplete",$thisPage).autocomplete({data:autoCompleteData,onAutocomplete:function onAutocomplete(val){},minLength:1});return Promise.all([utopiasoftware.saveup.filteredSenderBanksData(),utopiasoftware.saveup.sortBanksData()])},function(){return[[],[]]}).then(function(bankArrayData){var optionTags="";for(var index=0;index<bankArrayData[0].length;index++){var bankObject=bankArrayData[0][index];for(var prop in bankObject){optionTags+='<option value="'+prop+'">'+bankObject[prop]+"</option>"}}$("#transfer-cash-bank-sender-choose-bank",$thisPage).append(optionTags);$("#transfer-cash-bank-sender-choose-bank",$thisPage).material_select();return bankArrayData},function(){return[[],[]]}).then(function(bankArrayData){var optionTags="";for(var index=0;index<bankArrayData[1].length;index++){var bankObject=bankArrayData[1][index];for(var prop in bankObject){optionTags+='<option value="'+prop+'">'+bankObject[prop]+"</option>"}}$("#transfer-cash-bank-recipient-choose-bank",$thisPage).append(optionTags);$("#transfer-cash-bank-recipient-choose-bank",$thisPage).material_select();return bankArrayData},function(){return null}).then(function(){var pageDataObject=$("#app-main-navigator").get(0).topPage.data;if(pageDataObject&&pageDataObject.recipient_details){$("#transfer-cash-bank-recipient-account-name",$thisPage).val(pageDataObject.recipient_details.recipientAccountName+" - "+pageDataObject.recipient_details.recipientAccount);$("#transfer-cash-bank-recipient-choose-bank",$thisPage).val(pageDataObject.recipient_details.recipientBankCode);$("#hidden-choose-recipient-bank-input",$thisPage).val(pageDataObject.recipient_details.recipientBankCode)}if(pageDataObject&&pageDataObject.sender_details){$("#transfer-cash-bank-sender-account-name",$thisPage).val(pageDataObject.sender_details.senderAccountName+" - "+pageDataObject.sender_details.senderAccount);$("#transfer-cash-bank-sender-choose-bank",$thisPage).val(pageDataObject.sender_details.senderBankCode);$("#hidden-choose-sender-bank-input",$thisPage).val(pageDataObject.sender_details.senderBankCode)}$("select",$thisPage).material_select();Materialize.updateTextFields();return null},function(){return null}).then(function(){$(".progress",$thisPage).remove();$("#transfer-cash-bank-form",$thisPage).css("display","block");$("#transfer-cash-bank-cancel-button-1, #transfer-cash-bank-button",$thisPage).removeAttr("disabled");$("#loader-modal").get(0).hide()},function(){})}},pageShow:function pageShow(event){$("ons-splitter-side").attr("swipeable",true)},pageHide:function pageHide(event){var $thisPage=$(event.target);try{$("[data-hint]",$thisPage).removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("[data-hint]",$thisPage).removeAttr("data-hint");utopiasoftware.saveup.controller.transferCashBankPageViewModel.transferAmountFieldValidator.reset();utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.reset()}catch(err){}},pageDestroy:function pageDestroy(event){var $thisPage=$(event.target);try{$("[data-hint]",$thisPage).removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("[data-hint]",$thisPage).removeAttr("data-hint");utopiasoftware.saveup.controller.transferCashBankPageViewModel.transferAmountFieldValidator.reset();utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.destroy();$("select",$thisPage).material_select("destroy");$("input.autocomplete",$thisPage).off();$("input.autocomplete",$thisPage).removeData()}catch(err){}},transferCashBankFormValidated:function transferCashBankFormValidated(){if(navigator.connection.type===Connection.NONE){window.plugins.toast.showWithOptions({message:"You cannot transfer cash without an active Internet Connection",duration:4500,position:"top",styling:{opacity:1,backgroundColor:"#ff0000",textColor:"#FFFFFF",textSize:14}},function(toastEvent){if(toastEvent&&toastEvent.event=="touch"){window.plugins.toast.hide()}});return}ons.notification.confirm({title:'<ons-icon icon="md-alert-triangle" size="36px" '+'style="color: orange;"></ons-icon> Confirm Transfer',messageHTML:"<span>Cash transfers cannot be undone or reversed when completed. <br>"+"To securely complete cash transfers your banking authorization is required.<br>"+"Do you want to continue?</span>",cancelable:false,buttonLabels:["No","Yes"]}).then(function(buttonIndex){if(buttonIndex===1){$("#loader-modal-message").html("Initiating Transfer...");$("#loader-modal").get(0).show();return utopiasoftware.saveup.moneyWaveObject.useToken}else{throw null}}).then(function(token){if(token===null){throw null}else{var cashTransferData={firstname:utopiasoftware.saveup.model.appUserDetails.firstName.split(" ")[0],lastname:utopiasoftware.saveup.model.appUserDetails.lastName.split(" ")[0],phonenumber:utopiasoftware.saveup.model.appUserDetails.phoneNumber_intlFormat,email:utopiasoftware.saveup.model.appUserDetails.firstName.split(" ")[0]+utopiasoftware.saveup.model.appUserDetails.lastName.split(" ")[0]+Date.now()+"@mymail.com",apiKey:utopiasoftware.saveup.moneyWaveObject.key.apiKey,medium:"mobile",recipient:"wallet",fee:utopiasoftware.saveup.model.fee+45,amount:kendo.parseFloat($("#transfer-cash-bank-amount","#transfer-cash-bank-page").val())};if($("#transfer-cash-bank-sender-choose-bank","#transfer-cash-bank-form").val()!="044"){cashTransferData.charge_with="ext_account";cashTransferData.charge_auth="INTERNETBANKING";cashTransferData.sender_bank=$("#transfer-cash-bank-sender-choose-bank","#transfer-cash-bank-form").val();cashTransferData.redirecturl="https://postcash.000webhostapp.com/transfer-cash-bank.html"}return new Promise(function(resolve,reject){var cashTransferRequest=$.ajax({url:utopiasoftware.saveup.moneyWaveObject.gateway+"v1/transfer",type:"post",contentType:"application/json",beforeSend:function beforeSend(jqxhr){jqxhr.setRequestHeader("Authorization",token)},dataType:"json",timeout:24e4,processData:false,data:JSON.stringify(cashTransferData)});cashTransferRequest.done(function(responseData){if(responseData.status==="success"){resolve(responseData)}else{reject(responseData)}});cashTransferRequest.fail(function(jqxhr){if(jqxhr.status==500){reject(JSON.parse(jqxhr.responseText.trim()))}else{reject(jqxhr.responseText.trim())}})})}}).then(function(responseData){var transferRecipientDetailsArray=$("#transfer-cash-bank-recipient-account-name","#transfer-cash-bank-page").val().split(" - ");responseData.data.transfer.postcash_transaction_type="Cash Transfer (Bank)";responseData.data.transfer.postcash_transferDetails={narration:$("#transfer-cash-bank-narration","#transfer-cash-bank-page").val(),sender_bank:$("#transfer-cash-bank-sender-choose-bank","#transfer-cash-bank-page").val(),sender_account_number:$("#transfer-cash-bank-sender-account-name","#transfer-cash-bank-page").val().split(" - ").pop(),recipient_bank:$("#transfer-cash-bank-recipient-choose-bank","#transfer-cash-bank-page").val(),recipient_account_name:transferRecipientDetailsArray.length>1?transferRecipientDetailsArray[transferRecipientDetailsArray.length-2]:"",recipient_account_number:transferRecipientDetailsArray.pop()};return Promise.all([utopiasoftware.saveup.transactionHistoryOperations.addTransactionHistory(responseData.data.transfer),Promise.resolve(responseData)])}).then(function(responseDataArray){if(responseDataArray==null||responseDataArray[1]==null){throw null}var responseData=responseDataArray[1];$("#transfer-cash-bank-authorize-amount","#transfer-cash-bank-page").html(kendo.toString(kendo.parseFloat(responseData.data.transfer.amountToSend),"n2"));$("#transfer-cash-bank-authorize-fee","#transfer-cash-bank-page").html(kendo.toString(kendo.parseFloat(responseData.data.transfer.chargedFee),"n2"));$("#transfer-cash-bank-authorize-total","#transfer-cash-bank-page").html(kendo.toString(kendo.parseFloat(responseData.data.transfer.amountToCharge),"n2"));$("#transfer-cash-bank-authorize-message","#transfer-cash-bank-page").html(responseData.data.transfer.flutterChargeResponseMessage);window.sessionStorage.setItem("transaction_id",responseData.data.transfer.id);window.sessionStorage.setItem("transaction_ref",responseData.data.transfer.flutterChargeReference);window.sessionStorage.setItem("transaction_authurl",responseData.data.authurl||"");$(".transfer-cash-bank-page-bottom-toolbar-transfer-block").css("display","none");if($("#transfer-cash-bank-sender-choose-bank","#transfer-cash-bank-form").val()!="044"){$("#transfer-cash-bank-authorise-form","#transfer-cash-bank-page").css("display","none");$("#transfer-cash-bank-authorise-button").attr("disabled",true);$(".transfer-cash-bank-page-bottom-toolbar-authorize-bank-block").css("display","block");$(".transfer-cash-bank-page-bottom-toolbar-authorize-pin-block").css("display","none")}else{}$(".postcash-pay-progress .col:eq(0) span:eq(0)").removeClass("postcash-pay-progress-milestone-active").addClass("postcash-pay-progress-milestone");$(".postcash-pay-progress .col:eq(0) span:eq(1)").removeClass("postcash-pay-progress-milestone-text-active").addClass("postcash-pay-progress-milestone-text");$(".postcash-pay-progress .col:eq(1) span:eq(0)").removeClass("postcash-pay-progress-milestone").addClass("postcash-pay-progress-milestone-active");$(".postcash-pay-progress .col:eq(1) span:eq(1)").removeClass("postcash-pay-progress-milestone-text").addClass("postcash-pay-progress-milestone-text-active");return $(".transfer-cash-bank-carousel").get(0).next({animation:"none"})}).then(function(object){if(object==null){throw null}$("#loader-modal").get(0).hide()}).catch(function(error){$("#loader-modal").get(0).hide();if(error==null){return}ons.notification.alert({title:"Cash Transfer Failed",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+(error.data||"")+" Sorry, your cash transfer failed. "+"<br>You can try again"+"</span>",cancelable:true})})},transferCashBankRemoteAuthorize:function transferCashBankRemoteAuthorize(authorizationStage,authorizationResponseData){var secureToken=null;if(authorizationStage=="stage 1"){$("#loader-modal-message").html("Checking Authorization... Please Wait");$("#loader-modal").get(0).show();$("#transfer-cash-bank-authorise-modal").get(0).hide();utopiasoftware.saveup.moneyWaveObject.useToken.then(function(token){secureToken=token;return new Promise(function(resolve,reject){var cashTransferAuthorisation=$.ajax({url:utopiasoftware.saveup.moneyWaveObject.gateway+"v1/transfer/"+window.sessionStorage.getItem("transaction_id"),type:"post",contentType:"application/json",beforeSend:function beforeSend(jqxhr){jqxhr.setRequestHeader("Authorization",token)},dataType:"json",timeout:24e4,processData:false,data:JSON.stringify({})});cashTransferAuthorisation.done(function(responseData){if(responseData.status==="success"&&(responseData.data.flutterChargeResponseMessage.toLocaleUpperCase().indexOf("APPROVED")>-1||responseData.data.flutterChargeResponseMessage.toLocaleUpperCase().indexOf("SUCCESSFUL")>-1)){resolve(responseData)}else{reject(responseData)}});cashTransferAuthorisation.fail(function(jqxhr){reject(JSON.parse(jqxhr.responseText.trim()))})})}).then(function(responseData){var transferRecipientDetailsArray=$("#transfer-cash-bank-recipient-account-name","#transfer-cash-bank-page").val().split(" - ");var transferData={transferData:responseData.data,authorizationToken:secureToken,postcash_fee:utopiasoftware.saveup.model.fee,postcash_transferDetails:{narration:$("#transfer-cash-bank-narration","#transfer-cash-bank-page").val(),sender_bank:$("#transfer-cash-bank-sender-choose-bank","#transfer-cash-bank-page").val(),sender_account_number:$("#transfer-cash-bank-sender-account-name","#transfer-cash-bank-page").val().split(" - ").pop(),recipient_bank:$("#transfer-cash-bank-recipient-choose-bank","#transfer-cash-bank-page").val(),recipient_account_name:transferRecipientDetailsArray.length>1?transferRecipientDetailsArray[transferRecipientDetailsArray.length-2]:"",recipient_account_number:transferRecipientDetailsArray.pop()}};return Promise.all([utopiasoftware.saveup.transactionHistoryOperations.updateTransactionHistoryData(window.sessionStorage.getItem("transaction_ref"),{postcash_transferDetails:transferData.postcash_transferDetails}),Promise.resolve(transferData)])}).then(function(transferDataArray){$("#transfer-cash-bank-authorise-modal #transfer-cash-bank-authorise-iframe").get(0).contentWindow.postMessage(JSON.stringify(transferDataArray[1]),"https://postcash.000webhostapp.com")}).catch(function(error){utopiasoftware.saveup.transactionHistoryOperations.updateTransactionHistoryData(window.sessionStorage.getItem("transaction_ref"),error).then(function(){return $("#loader-modal").get(0).hide()}).then(function(){return ons.notification.alert({title:"Cash Transfer Failed",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+(error.message||"")+" Sorry, your cash transfer was not authorised. "+"<br>You can check this transaction status OR resend the cash transfer"+"</span>",cancelable:true})}).then(function(){$("#app-main-navigator").get(0).resetToPage("main-menu-page.html")}).catch(function(){$("#loader-modal").get(0).hide()})})}if(authorizationStage=="stage 2"){$("#loader-modal-message").html("Checking Authorization... Please Wait");$("#loader-modal").get(0).show();Promise.resolve(authorizationResponseData).then(function(authorizationResponseData){if(authorizationResponseData.walletToWallet.status=="success"&&authorizationResponseData.walletToWallet.data.toLocaleUpperCase().indexOf("SUCCESSFUL")>-1&&authorizationResponseData.walletToAccount.status=="success"&&authorizationResponseData.walletToAccount.data.data.responsemessage.toLocaleUpperCase().indexOf("SUCCESSFUL")>-1){$(".postcash-pay-progress .col:eq(0) span:eq(0)").removeClass("postcash-pay-progress-milestone-active").addClass("postcash-pay-progress-milestone");$(".postcash-pay-progress .col:eq(0) span:eq(1)").removeClass("postcash-pay-progress-milestone-text-active").addClass("postcash-pay-progress-milestone-text");$(".postcash-pay-progress .col:eq(1) span:eq(0)").removeClass("postcash-pay-progress-milestone-active").addClass("postcash-pay-progress-milestone");$(".postcash-pay-progress .col:eq(1) span:eq(1)").removeClass("postcash-pay-progress-milestone-text-active").addClass("postcash-pay-progress-milestone-text");$(".postcash-pay-progress .col:eq(2) span:eq(0)").removeClass("postcash-pay-progress-milestone").addClass("postcash-pay-progress-milestone-active");$(".postcash-pay-progress .col:eq(2) span:eq(1)").removeClass("postcash-pay-progress-milestone-text").addClass("postcash-pay-progress-milestone-text-active");$(".transfer-cash-bank-page-bottom-toolbar-transfer-block").css("display","none");$(".transfer-cash-bank-page-bottom-toolbar-authorize-bank-block").css("display","none");$(".transfer-cash-bank-page-bottom-toolbar-authorize-pin-block").css("display","none");return Promise.all([authorizationResponseData,$("#loader-modal").get(0).hide(),$(".transfer-cash-bank-carousel").get(0).next({animation:"none"})])}else{throw authorizationResponseData}}).then(function(dataArray){return utopiasoftware.saveup.transactionHistoryOperations.updateTransactionHistoryData(window.sessionStorage.getItem("transaction_ref"),dataArray[0])}).then(function(){return $("#financial-operations-success-modal").get(0).show()}).then(function(){window.setTimeout(function(){$("#financial-operations-success-modal .circle").addClass("show")},1e3)}).catch(function(error){utopiasoftware.saveup.transactionHistoryOperations.updateTransactionHistoryData(window.sessionStorage.getItem("transaction_ref"),error).then(function(){return $("#loader-modal").get(0).hide()}).then(function(){return ons.notification.alert({title:"Cash Transfer Failed",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+(error.message||"")+" Sorry, your cash transfer was not authorised. "+"<br>You can check this transaction status OR resend the cash transfer"+"</span>",cancelable:true})}).then(function(){$("#app-main-navigator").get(0).resetToPage("main-menu-page.html")}).catch(function(){$("#loader-modal").get(0).hide()})})}},transferCashBankAuthorizeProceed:function transferCashBankAuthorizeProceed(){$("#transfer-cash-bank-authorise-iframe").attr("src","");$("#transfer-cash-bank-authorise-iframe").attr("src",window.sessionStorage.getItem("transaction_authurl"));$("#transfer-cash-bank-authorise-modal").get(0).show()},pageContentScrolled:function pageContentScrolled(event){utopiasoftware.saveup.controller.transferCashBankPageViewModel.currentScrollPosition=$(this).scrollTop();if(utopiasoftware.saveup.controller.transferCashBankPageViewModel.currentScrollPosition>utopiasoftware.saveup.controller.transferCashBankPageViewModel.previousScrollPosition){utopiasoftware.saveup.controller.transferCashBankPageViewModel.previousScrollPosition=utopiasoftware.saveup.controller.transferCashBankPageViewModel.currentScrollPosition;if(utopiasoftware.saveup.controller.transferCashBankPageViewModel.currentScrollPosition>=10){if($(".transfer-cash-tabbar").last().get(0).visible==true){$(".transfer-cash-tabbar").last().get(0).setTabbarVisibility(false)}}return}if(utopiasoftware.saveup.controller.transferCashBankPageViewModel.currentScrollPosition<utopiasoftware.saveup.controller.transferCashBankPageViewModel.previousScrollPosition){utopiasoftware.saveup.controller.transferCashBankPageViewModel.previousScrollPosition=utopiasoftware.saveup.controller.transferCashBankPageViewModel.currentScrollPosition;if($(".transfer-cash-tabbar").last().get(0).visible==false){$(".transfer-cash-tabbar").last().get(0).setTabbarVisibility(true)}return}},senderAccountNumberChanged:function senderAccountNumberChanged(inputElem){$(".postcash-preloader-transfer-cash-bank-form-container",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).css("display","block");var valueSplitArray=$(inputElem).val().split(" - ");var accountNumber=valueSplitArray.pop();utopiasoftware.saveup.bankAccountOperations.getMyAccountByNumber(accountNumber).then(function(acctObject){if(!acctObject){throw"error"}$("#transfer-cash-bank-sender-choose-bank",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).val(acctObject.flutterwave_bankCode);$("#hidden-choose-sender-bank-input",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).val(acctObject.flutterwave_bankCode);$("[data-hint]",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("[data-hint]",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).removeAttr("data-hint");$("select",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).material_select();$(".postcash-preloader-transfer-cash-bank-form-container",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).css("display","none")}).catch(function(){$("select",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).material_select();$(".postcash-preloader-transfer-cash-bank-form-container",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).css("display","none")})},recipientAccountNumberChanged:function recipientAccountNumberChanged(inputElem){$(".postcash-preloader-transfer-cash-bank-form-container",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).css("display","block");var valueSplitArray=$(inputElem).val().split(" - ");var accountNumber=valueSplitArray.pop();utopiasoftware.saveup.savedRecipientsBankAccountOperations.getSavedRecipientAccountByNumber(accountNumber).then(function(acctObject){if(!acctObject){throw"error"}$("#transfer-cash-bank-recipient-choose-bank",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).val(acctObject.flutterwave_bankCode);$("#hidden-choose-recipient-bank-input",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).val(acctObject.flutterwave_bankCode);$("[data-hint]",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("[data-hint]",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).removeAttr("data-hint");$("select",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).material_select();$(".postcash-preloader-transfer-cash-bank-form-container",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).css("display","none")}).catch(function(){$("select",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).material_select();$(".postcash-preloader-transfer-cash-bank-form-container",utopiasoftware.saveup.controller.transferCashBankPageViewModel.formValidator.$element).css("display","none")})}}},_defineProperty(_utopiasoftware$saveu,"onboardingPageViewModel",{pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-splitter-side").removeAttr("swipeable");loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}if($("#onboarding-navigator").get(0)&&$("#onboarding-navigator").get(0).topPage){$("#onboarding-navigator").get(0).topPage.alwaysShowSecurityLockModal=false;$("#onboarding-navigator").get(0).topPage.onDeviceBackButton=function(){ons.notification.confirm("Do you want to close the app?",{title:"Exit",buttonLabels:["No","Yes"]}).then(function(index){if(index===1){navigator.app.exitApp()}})}}if($("#app-main-navigator").get(0)&&$("#app-main-navigator").get(0).topPage){$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal=false;$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){if($("ons-splitter").get(0).left.isOpen){$("ons-splitter").get(0).left.close();return}$("#app-main-navigator").get(0).resetToPage("main-menu-page.html")}}$("#onboarding-carousel",$thisPage).carousel({dist:0,fullWidth:true,indicators:true,noWrap:true});$("#loader-modal").get(0).hide()}},pageShow:function pageShow(){$("ons-splitter-side").removeAttr("swipeable")},pageDestroy:function pageDestroy(event){var $thisPage=$(event.target);$("#onboarding-carousel",$thisPage).off();$("#onboarding-carousel",$thisPage).removeData()},nextSlideButtonClicked:function nextSlideButtonClicked(buttonElem){$("#onboarding-carousel").carousel("next");setTimeout(function(){if($(".carousel-item.active").is('[href="#three!"]')){$(buttonElem).css("display","none")}},205)},endButtonClicked:function endButtonClicked(){if(window.localStorage.getItem("app-status")&&window.localStorage.getItem("app-status")!=""){$("ons-splitter").get(0).content.load("app-main-template")}else{$("ons-splitter").get(0).content.load("login-template")}}}),_defineProperty(_utopiasoftware$saveu,"transactionHistoryPageViewModel",{pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-splitter-side").attr("swipeable",true);loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){if($("ons-splitter").get(0).left.isOpen){$("ons-splitter").get(0).left.close();return}$("#app-main-navigator").get(0).resetToPage("main-menu-page.html")};$("#transaction-history-pull-hook",$thisPage).on("changestate",function(event){switch(event.originalEvent.state){case"initial":$("#transaction-history-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="fa-long-arrow-down" size="24px"></ons-icon>');break;case"preaction":$("#transaction-history-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="fa-long-arrow-up" size="24px"></ons-icon>');break;case"action":$("#transaction-history-pull-hook-fab",event.originalEvent.pullHook).html('<ons-icon icon="fa-repeat" size="24px" spin></ons-icon>');break}});$("#transaction-history-pull-hook",$thisPage).get(0).onAction=function(loadingDone){$("#transaction-history-pull-hook",$thisPage).attr("disabled",true);utopiasoftware.saveup.transactionHistoryOperations.loadTransactionHistoryData().then(function(transactionHistoryArray){if(transactionHistoryArray.length==0){$(".progress",$thisPage).remove();$("#transaction-history-help-1",$thisPage).css("display","inline-block");$("#transaction-history-pull-hook",$thisPage).removeAttr("disabled");$("#transaction-history-page-message",$thisPage).css("display","block");$("#transaction-history-page-error",$thisPage).css("display","none");$("#transaction-history-list",$thisPage).css("display","none");loadingDone()}else{$("#transaction-history-list .transaction-history-items-container",$thisPage).html("");var transactionHistoryContent="";for(var index=0;index<transactionHistoryArray.length;index++){switch(transactionHistoryArray[index].postcash_transaction_type){case"Cash Transfer (Card)":transactionHistoryContent+='<ons-col width="25%" class="transaction-history-indicator-container">';if(transactionHistoryArray[index].flutterChargeResponseMessage.toLocaleUpperCase()!="APPROVED"){transactionHistoryContent+='<span class="transaction-history-item-incomplete-indicator">\n                                            </span><span class="transaction-history-item-time-indicator">\n                                            '+kendo.toString(new Date(transactionHistoryArray[index].createdAt),"HH:mm yyyy-MM-dd")+'</span></ons-col>\n                                                <ons-col width="75%" class="transaction-history-content-container">\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Type\n                                            </span>\n                                            <span>\n                                            '+transactionHistoryArray[index].postcash_transaction_type+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Amount (NGN)\n                                            </span><span>\n                                            '+kendo.toString(kendo.parseFloat(transactionHistoryArray[index].amountToCharge),"n2")+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Status\n                                            </span><span>Incomplete</span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span  class="transaction-history-content-label">\n                                            Beneficiary\n                                            </span><span>\n                                            '+(transactionHistoryArray[index].beneficiary.accountNumber+" - "+transactionHistoryArray[index].beneficiary.accountName)+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <ons-button class="transaction-history-content-button"\n                                                data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.saveDetailsButtonClicked(this)">\n                                            Save Details\n                                            </ons-button>\n                                            <ons-button class="transaction-history-content-button"\n                                            data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.sendFeedbackButtonClicked(this)">\n                                            Send Feedback\n                                            </ons-button>\n                                            </div></ons-col>'}else{transactionHistoryContent+='<span class="transaction-history-item-success-indicator">\n                                            </span><span class="transaction-history-item-time-indicator">\n                                            '+kendo.toString(new Date(transactionHistoryArray[index].createdAt),"HH:mm yyyy-MM-dd")+'</span></ons-col>\n                                                <ons-col width="75%" class="transaction-history-content-container">\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Type\n                                            </span>\n                                            <span>\n                                            '+transactionHistoryArray[index].postcash_transaction_type+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Amount (NGN)\n                                            </span><span>\n                                            '+kendo.toString(kendo.parseFloat(transactionHistoryArray[index].amountToCharge),"n2")+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Status\n                                            </span><span>Successful</span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span  class="transaction-history-content-label">\n                                            Beneficiary\n                                            </span><span>\n                                            '+(transactionHistoryArray[index].beneficiary.accountNumber+" - "+transactionHistoryArray[index].beneficiary.accountName)+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <ons-button class="transaction-history-content-button"\n                                                data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.saveDetailsButtonClicked(this)">\n                                            Save Details\n                                            </ons-button>\n                                            <ons-button class="transaction-history-content-button"\n                                            data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.sendFeedbackButtonClicked(this)">\n                                            Send Feedback\n                                            </ons-button>\n                                            </div></ons-col>'}break;case"Cash Transfer (Bank)":transactionHistoryContent+='<ons-col width="25%" class="transaction-history-indicator-container">';if(!transactionHistoryArray[index].walletToWallet||transactionHistoryArray[index].walletToWallet.status!="success"||transactionHistoryArray[index].walletToWallet.data.toLocaleUpperCase().indexOf("SUCCESSFUL")<0||!transactionHistoryArray[index].walletToAccount||transactionHistoryArray[index].walletToAccount.status!="success"||transactionHistoryArray[index].walletToAccount.data.data.responsemessage.toLocaleUpperCase().indexOf("SUCCESSFUL")<0){transactionHistoryContent+='<span class="transaction-history-item-incomplete-indicator">\n                                            </span><span class="transaction-history-item-time-indicator">\n                                            '+kendo.toString(new Date(transactionHistoryArray[index].createdAt),"HH:mm yyyy-MM-dd")+'</span></ons-col>\n                                                <ons-col width="75%" class="transaction-history-content-container">\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Type\n                                            </span>\n                                            <span>\n                                            '+transactionHistoryArray[index].postcash_transaction_type+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Amount (NGN)\n                                            </span><span>\n                                            '+kendo.toString(kendo.parseFloat(transactionHistoryArray[index].amountToCharge),"n2")+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Status\n                                            </span><span>Incomplete</span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span  class="transaction-history-content-label">\n                                            Beneficiary\n                                            </span><span>\n                                            '+(transactionHistoryArray[index].postcash_transferDetails.recipient_account_number+" "+transactionHistoryArray[index].postcash_transferDetails.recipient_account_name)+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <ons-button class="transaction-history-content-button"\n                                                data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.saveDetailsButtonClicked(this)">\n                                            Save Details\n                                            </ons-button>\n                                            <ons-button class="transaction-history-content-button"\n                                            data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.sendFeedbackButtonClicked(this)">\n                                            Send Feedback\n                                            </ons-button>\n                                            </div></ons-col>'}else{transactionHistoryContent+='<span class="transaction-history-item-success-indicator">\n                                            </span><span class="transaction-history-item-time-indicator">\n                                            '+kendo.toString(new Date(transactionHistoryArray[index].createdAt),"HH:mm yyyy-MM-dd")+'</span></ons-col>\n                                                <ons-col width="75%" class="transaction-history-content-container">\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Type\n                                            </span>\n                                            <span>\n                                            '+transactionHistoryArray[index].postcash_transaction_type+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Amount (NGN)\n                                            </span><span>\n                                            '+kendo.toString(kendo.parseFloat(transactionHistoryArray[index].amountToCharge),"n2")+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Status\n                                            </span><span>Successful</span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span  class="transaction-history-content-label">\n                                            Beneficiary\n                                            </span><span>\n                                            '+(transactionHistoryArray[index].postcash_transferDetails.recipient_account_number+" "+transactionHistoryArray[index].postcash_transferDetails.recipient_account_name)+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <ons-button class="transaction-history-content-button"\n                                                data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.saveDetailsButtonClicked(this)">\n                                            Save Details\n                                            </ons-button>\n                                            <ons-button class="transaction-history-content-button"\n                                            data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.sendFeedbackButtonClicked(this)">\n                                            Send Feedback\n                                            </ons-button>\n                                            </div></ons-col>'}break}$("#transaction-history-list .transaction-history-items-container",$thisPage).append(transactionHistoryContent);transactionHistoryContent=""}$(".progress",$thisPage).remove();$("#transaction-history-help-1",$thisPage).css("display","inline-block");$("#transaction-history-pull-hook",$thisPage).removeAttr("disabled");$("#transaction-history-page-message",$thisPage).css("display","none");$("#transaction-history-page-error",$thisPage).css("display","none");$("#transaction-history-list",$thisPage).css("display","block");loadingDone()}}).catch(function(){$(".progress",$thisPage).remove();$("#transaction-history-help-1",$thisPage).css("display","inline-block");$("#transaction-history-pull-hook",$thisPage).removeAttr("disabled");$("#transaction-history-page-message",$thisPage).css("display","none");$("#transaction-history-page-error",$thisPage).css("display","block");$("#transaction-history-list",$thisPage).css("display","none");loadingDone()})};utopiasoftware.saveup.transactionHistoryOperations.loadTransactionHistoryData().then(function(transactionHistoryArray){if(transactionHistoryArray.length==0){$(".progress",$thisPage).remove();$("#transaction-history-help-1",$thisPage).css("display","inline-block");$("#transaction-history-pull-hook",$thisPage).removeAttr("disabled");$("#transaction-history-page-message",$thisPage).css("display","block");$("#transaction-history-page-error",$thisPage).css("display","none");$("#transaction-history-list",$thisPage).css("display","none")}else{$("#transaction-history-list .transaction-history-items-container",$thisPage).html("");var transactionHistoryContent="";for(var index=0;index<transactionHistoryArray.length;index++){switch(transactionHistoryArray[index].postcash_transaction_type){case"Cash Transfer (Card)":transactionHistoryContent+='<ons-col width="25%" class="transaction-history-indicator-container">';if(transactionHistoryArray[index].flutterChargeResponseMessage.toLocaleUpperCase()!="APPROVED"){transactionHistoryContent+='<span class="transaction-history-item-incomplete-indicator">\n                                            </span><span class="transaction-history-item-time-indicator">\n                                            '+kendo.toString(new Date(transactionHistoryArray[index].createdAt),"HH:mm yyyy-MM-dd")+'</span></ons-col>\n                                                <ons-col width="75%" class="transaction-history-content-container">\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Type\n                                            </span>\n                                            <span>\n                                            '+transactionHistoryArray[index].postcash_transaction_type+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Amount (NGN)\n                                            </span><span>\n                                            '+kendo.toString(kendo.parseFloat(transactionHistoryArray[index].amountToCharge),"n2")+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Status\n                                            </span><span>Incomplete</span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span  class="transaction-history-content-label">\n                                            Beneficiary\n                                            </span><span>\n                                            '+(transactionHistoryArray[index].beneficiary.accountNumber+" - "+transactionHistoryArray[index].beneficiary.accountName)+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <ons-button class="transaction-history-content-button"\n                                                data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.saveDetailsButtonClicked(this)">\n                                            Save Details\n                                            </ons-button>\n                                            <ons-button class="transaction-history-content-button"\n                                            data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.sendFeedbackButtonClicked(this)">\n                                            Send Feedback\n                                            </ons-button>\n                                            </div></ons-col>'}else{transactionHistoryContent+='<span class="transaction-history-item-success-indicator">\n                                            </span><span class="transaction-history-item-time-indicator">\n                                            '+kendo.toString(new Date(transactionHistoryArray[index].createdAt),"HH:mm yyyy-MM-dd")+'</span></ons-col>\n                                                <ons-col width="75%" class="transaction-history-content-container">\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Type\n                                            </span>\n                                            <span>\n                                            '+transactionHistoryArray[index].postcash_transaction_type+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Amount (NGN)\n                                            </span><span>\n                                            '+kendo.toString(kendo.parseFloat(transactionHistoryArray[index].amountToCharge),"n2")+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Status\n                                            </span><span>Successful</span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span  class="transaction-history-content-label">\n                                            Beneficiary\n                                            </span><span>\n                                            '+(transactionHistoryArray[index].beneficiary.accountNumber+" - "+transactionHistoryArray[index].beneficiary.accountName)+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <ons-button class="transaction-history-content-button"\n                                                data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.saveDetailsButtonClicked(this)">\n                                            Save Details\n                                            </ons-button>\n                                            <ons-button class="transaction-history-content-button"\n                                            data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.sendFeedbackButtonClicked(this)">\n                                            Send Feedback\n                                            </ons-button>\n                                            </div></ons-col>'}break;case"Cash Transfer (Bank)":transactionHistoryContent+='<ons-col width="25%" class="transaction-history-indicator-container">';if(!transactionHistoryArray[index].walletToWallet||transactionHistoryArray[index].walletToWallet.status!="success"||transactionHistoryArray[index].walletToWallet.data.toLocaleUpperCase().indexOf("SUCCESSFUL")<0||!transactionHistoryArray[index].walletToAccount||transactionHistoryArray[index].walletToAccount.status!="success"||transactionHistoryArray[index].walletToAccount.data.data.responsemessage.toLocaleUpperCase().indexOf("SUCCESSFUL")<0){transactionHistoryContent+='<span class="transaction-history-item-incomplete-indicator">\n                                            </span><span class="transaction-history-item-time-indicator">\n                                            '+kendo.toString(new Date(transactionHistoryArray[index].createdAt),"HH:mm yyyy-MM-dd")+'</span></ons-col>\n                                                <ons-col width="75%" class="transaction-history-content-container">\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Type\n                                            </span>\n                                            <span>\n                                            '+transactionHistoryArray[index].postcash_transaction_type+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Amount (NGN)\n                                            </span><span>\n                                            '+kendo.toString(kendo.parseFloat(transactionHistoryArray[index].amountToCharge),"n2")+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Status\n                                            </span><span>Incomplete</span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span  class="transaction-history-content-label">\n                                            Beneficiary\n                                            </span><span>\n                                            '+(transactionHistoryArray[index].postcash_transferDetails.recipient_account_number+" "+transactionHistoryArray[index].postcash_transferDetails.recipient_account_name)+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <ons-button class="transaction-history-content-button"\n                                                data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.saveDetailsButtonClicked(this)">\n                                            Save Details\n                                            </ons-button>\n                                            <ons-button class="transaction-history-content-button"\n                                            data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.sendFeedbackButtonClicked(this)">\n                                            Send Feedback\n                                            </ons-button>\n                                            </div></ons-col>'}else{transactionHistoryContent+='<span class="transaction-history-item-success-indicator">\n                                            </span><span class="transaction-history-item-time-indicator">\n                                            '+kendo.toString(new Date(transactionHistoryArray[index].createdAt),"HH:mm yyyy-MM-dd")+'</span></ons-col>\n                                                <ons-col width="75%" class="transaction-history-content-container">\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Type\n                                            </span>\n                                            <span>\n                                            '+transactionHistoryArray[index].postcash_transaction_type+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Amount (NGN)\n                                            </span><span>\n                                            '+kendo.toString(kendo.parseFloat(transactionHistoryArray[index].amountToCharge),"n2")+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span class="transaction-history-content-label">\n                                            Transaction Status\n                                            </span><span>Successful</span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <span  class="transaction-history-content-label">\n                                            Beneficiary\n                                            </span><span>\n                                            '+(transactionHistoryArray[index].postcash_transferDetails.recipient_account_number+" "+transactionHistoryArray[index].postcash_transferDetails.recipient_account_name)+'\n                                            </span></div>\n                                            <div style="font-size: 0.8em; width: 100%">\n                                            <ons-button class="transaction-history-content-button"\n                                                data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.saveDetailsButtonClicked(this)">\n                                            Save Details\n                                            </ons-button>\n                                            <ons-button class="transaction-history-content-button"\n                                            data-transaction-id="'+transactionHistoryArray[index].flutterChargeReference+'"\n                                                onclick="utopiasoftware.saveup.controller.transactionHistoryPageViewModel.sendFeedbackButtonClicked(this)">\n                                            Send Feedback\n                                            </ons-button>\n                                            </div></ons-col>'}break}$("#transaction-history-list .transaction-history-items-container",$thisPage).append(transactionHistoryContent);transactionHistoryContent=""}$(".progress",$thisPage).remove();$("#transaction-history-help-1",$thisPage).css("display","inline-block");$("#transaction-history-pull-hook",$thisPage).removeAttr("disabled");$("#transaction-history-page-message",$thisPage).css("display","none");$("#transaction-history-page-error",$thisPage).css("display","none");$("#transaction-history-list",$thisPage).css("display","block")}}).catch(function(){$(".progress",$thisPage).remove();$("#transaction-history-help-1",$thisPage).css("display","inline-block");$("#transaction-history-pull-hook",$thisPage).removeAttr("disabled");$("#transaction-history-page-message",$thisPage).css("display","none");$("#transaction-history-page-error",$thisPage).css("display","block");$("#transaction-history-list",$thisPage).css("display","none")});$("#loader-modal").get(0).hide()}},pageShow:function pageShow(event){var $thisPage=$(event.target);$("ons-splitter-side").attr("swipeable",true);$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal=true},saveDetailsButtonClicked:function saveDetailsButtonClicked(buttonElem){var fileContentBlob=null;var fileObj=null;$("#loader-modal-message").html("Saving Transaction Details...");$("#loader-modal").get(0).show().then(function(){var transactionRef=$(buttonElem).attr("data-transaction-id");return utopiasoftware.saveup.transactionHistoryOperations.getTransactionHistoryById(transactionRef)}).then(function(transactionData){if(!transactionData){throw{message:"Transaction not found."}}return transactionData}).then(function(transactionData){$("#transaction-history-saver-container").html("");var transactionHistoryDocContent='<h3 style="text-align: center; min-width: 100%; width: 100%; margin-top: 1.5em;">\n                PostCash Transaction Details</h3>\n                <div style="text-align: right; min-width: 90%; max-width: 90%; width: 90%;">\n                <span style="font-weight: bold; font-size: 1.5em">Transaction Date: </span>\n                <span style="font-size: 1.5em">'+kendo.toString(new Date(transactionData.createdAt),"HH:mm yyyy-MM-dd")+'</span>\n                </div>\n                <table style="margin-top: 1.5em; border: 2px #000000 solid; min-width: 100%; width: 100%;">\n\n                <tr>\n                <td style="min-width:30%; width:30%; font-size: 1.5em; font-weight: bold; border: 1px #000000 solid;">\n                Transaction Reference\n                </td>\n                <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                '+transactionData.flutterChargeReference+"\n                </td>\n                </tr>";switch(transactionData.postcash_transaction_type){case"Cash Transfer (Card)":transactionHistoryDocContent+='<tr>\n                        <td style="min-width:30%; width:30%; font-size: 1.5em; font-weight: bold; border: 1px #000000 solid;">';if(transactionData.flutterChargeResponseMessage.toLocaleUpperCase()!="APPROVED"){transactionHistoryDocContent+='Transaction Type </td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            '+transactionData.postcash_transaction_type+'\n                                            </td></tr>\n                                            <tr>\n                        <td style="min-width:30%; width:30%; font-size: 1.5em; font-weight: bold; border: 1px #000000 solid;">\n                                            Transaction Amount (NGN) </td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            '+kendo.toString(kendo.parseFloat(transactionData.amountToCharge),"n2")+'\n                                            </td></tr>\n                                            <tr>\n                        <td style="min-width:30%; width:30%; font-size: 1.5em; font-weight: bold; border: 1px #000000 solid;">\n                                            Transaction Status</td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            Incomplete\n                                            </td></tr>\n                                            <tr>\n                        <td style="min-width:30%; width:30%; font-size: 1.5em; font-weight: bold; border: 1px #000000 solid;">\n                                            Beneficiary </td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            '+(transactionData.beneficiary.accountNumber+" - "+transactionData.beneficiary.accountName)+"\n                                            </td></tr></table>"}else{transactionHistoryDocContent+='Transaction Type </td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            '+transactionData.postcash_transaction_type+'\n                                            </td></tr>\n                                            <tr>\n                        <td style="min-width:30%; width:30%; font-size: 1.5em; font-weight: bold; border: 1px #000000 solid;">\n                                            Transaction Amount (NGN) </td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            '+kendo.toString(kendo.parseFloat(transactionData.amountToCharge),"n2")+'\n                                            </td></tr>\n                                            <tr>\n                        <td style="min-width:30%; width:30%; font-size: 1.5em; font-weight: bold; border: 1px #000000 solid;">\n                                            Transaction Status</td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            Successful\n                                            </td></tr>\n                                            <tr>\n                        <td style="min-width:30%; width:30%; font-size: 1.5em; font-weight: bold; border: 1px #000000 solid;">\n                                            Beneficiary </td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            '+(transactionData.beneficiary.accountNumber+" - "+transactionData.beneficiary.accountName)+"\n                                            </td></tr></table>"}break;case"Cash Transfer (Bank)":transactionHistoryDocContent+='<tr>\n                        <td style="min-width:30%; width:30%; font-size: 1.5em; font-weight: bold; border: 1px #000000 solid;">';if(!transactionData.walletToWallet||transactionData.walletToWallet.status!="success"||transactionData.walletToWallet.data.toLocaleUpperCase().indexOf("SUCCESSFUL")<0||!transactionData.walletToAccount||transactionData.walletToAccount.status!="success"||transactionData.walletToAccount.data.data.responsemessage.toLocaleUpperCase().indexOf("SUCCESSFUL")<0){transactionHistoryDocContent+='Transaction Type </td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            '+transactionData.postcash_transaction_type+'\n                                            </td></tr>\n                                             <tr>\n                        <td style="min-width:30%; width:30%; font-size: 1.5em; font-weight: bold; border: 1px #000000 solid;">\n                                            Transaction Amount (NGN)</td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            '+kendo.toString(kendo.parseFloat(transactionData.amountToCharge),"n2")+'\n                                            </td></tr>\n                                            <tr>\n                        <td style="min-width:30%; width:30%; font-size: 1.5em; font-weight: bold; border: 1px #000000 solid;">\n                                            Transaction Status</td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            Incomplete\n                                            </td></tr>\n                                            <tr>\n                        <td style="min-width:30%; width:30%; font-size: 1.5em; font-weight: bold; border: 1px #000000 solid;">\n                                            Beneficiary </td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            '+(transactionData.postcash_transferDetails.recipient_account_number+" "+transactionData.postcash_transferDetails.recipient_account_name)+"\n                                            </td></tr></table>"}else{transactionHistoryDocContent+='Transaction Type </td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            '+transactionData.postcash_transaction_type+'\n                                            </td></tr>\n                                            <tr>\n                        <td style="min-width:30%; width:30%; font-size: 1.5em; font-weight: bold; border: 1px #000000 solid;">\n                                            Transaction Amount (NGN) </td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            '+kendo.toString(kendo.parseFloat(transactionData.amountToCharge),"n2")+'\n                                            </td></tr>\n                                            <tr>\n                        <td style="min-width:30%; width:30%; font-size: 1.5em; font-weight: bold; border: 1px #000000 solid;">\n                                            Transaction Status</td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            Successful\n                                            </td></tr>\n                                            <tr>\n                        <td style="min-width:30%; width:30%; font-size: 1.5em; font-weight: bold; border: 1px #000000 solid;">\n                                            Beneficiary </td>\n                                            <td style="min-width:70%; width:70%; font-size: 1.5em; border: 1px #000000 solid;">\n                                            '+(transactionData.postcash_transferDetails.recipient_account_number+" "+transactionData.postcash_transferDetails.recipient_account_name)+"\n                                            </td></tr></table>"}break}$("#transaction-history-saver-container").append(transactionHistoryDocContent);return domtoimage.toBlob($("#transaction-history-saver-container").get(0),{cacheBust:true,bgcolor:"#ffffff",width:1880,height:2908})}).then(function(blob){fileContentBlob=blob;return new Promise(function(resolve,reject){window.resolveLocalFileSystemURL(cordova.file.externalRootDirectory,resolve,reject)})}).then(function(directory){return new Promise(function(resolve,reject){directory.getFile("PostCash-T-"+Date.now()+".png",{create:true,exclusive:false},resolve,reject)})}).then(function(file){fileObj=file;return new Promise(function(resolve,reject){file.createWriter(resolve,reject)})}).then(function(fileWriter){return new Promise(function(resolve,reject){fileWriter.onwriteend=resolve;fileWriter.onerror=reject;fileWriter.write(fileContentBlob)})}).then(function(){$("#transaction-history-saver-container").html("");return $("#loader-modal").get(0).hide()}).then(function(){$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal=false;return new Promise(function(resolve,reject){cordova.plugins.fileOpener2.open(fileObj.toURL(),"image/png",{error:reject,success:resolve})})}).then(function(){window.plugins.toast.showWithOptions({message:"Transaction details saved to file",duration:6e3,position:"top",styling:{opacity:1,backgroundColor:"#808080",textColor:"#FFFFFF",textSize:14}})}).catch(function(err){$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal=true;$("#transaction-history-saver-container").html("");$("#loader-modal").get(0).hide();ons.notification.alert({title:"File Save Failed",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>Sorry, the details of this transaction could not be saved to file. '+"<br>You can try again </span>",cancelable:true})})},sendFeedbackButtonClicked:function sendFeedbackButtonClicked(buttonElem){ons.notification.confirm({title:'<ons-icon icon="md-info" size="32px" '+'style="color: blue;"></ons-icon> Privacy Notice',messageHTML:"<span>You are about to send details of your PostCash transaction to the PostCash support team. <br>"+"Do you want to continue?</span>",cancelable:false,buttonLabels:["No","Yes"]}).then(function(buttonIndex){if(buttonIndex===1){$("#loader-modal-message").html("Preparing Feedback Form...");return $("#loader-modal").get(0).show()}else{throw null}}).then(function(){var transactionRef=$(buttonElem).attr("data-transaction-id");return utopiasoftware.saveup.transactionHistoryOperations.getTransactionHistoryById(transactionRef)}).then(function(transactionData){if(!transactionData){throw{message:"Transaction not found."}}return transactionData}).then(function(transactionData){$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal=false;return new Promise(function(resolve,reject){hockeyapp.composeFeedback(resolve,reject,false,transactionData)})}).then(function(){$("#loader-modal").get(0).hide()}).catch(function(err){$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal=true;$("#loader-modal").get(0).hide();if(!err){return}ons.notification.alert({title:"Feedback Failed",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>Sorry, feedback containing the PostCash transaction details could not be sent. '+"<br>You can try again </span>",cancelable:true})})}}),_defineProperty(_utopiasoftware$saveu,"settingsPageViewModel",{previousScrollPosition:0,currentScrollPosition:0,pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-input input",$thisPage).addClass("utopiasoftware-no-style");$("ons-splitter-side").removeAttr("swipeable",true);utopiasoftware.saveup.controller.settingsPageViewModel.previousScrollPosition=0;utopiasoftware.saveup.controller.settingsPageViewModel.currentScrollPosition=0;loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){if($("ons-splitter").get(0).left.isOpen){$("ons-splitter").get(0).left.close();return}$("#app-main-navigator").get(0).resetToPage("main-menu-page.html")};$("#settings-page #settings-always-lock-screen-switch").on("change",function(switchEvent){ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){if(!utopiasoftware.saveup.model.appUserDetails.settings){utopiasoftware.saveup.model.appUserDetails.settings={}}utopiasoftware.saveup.model.appUserDetails.settings.alwaysShowSecurityLockModal=$("#settings-page #settings-always-lock-screen-switch").get(0).checked;Promise.resolve(intel.security.secureData.createFromData({data:JSON.stringify(utopiasoftware.saveup.model.appUserDetails)})).then(function(instanceId){Promise.resolve(intel.security.secureStorage.write({id:"postcash-user-details",instanceID:instanceId}))})}else{if($("#settings-page #settings-always-lock-screen-switch").get(0).checked){$("#settings-page #settings-always-lock-screen-switch").removeAttr("checked")}else{$("#settings-page #settings-always-lock-screen-switch").attr("checked",true)}ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){if($("#settings-page #settings-always-lock-screen-switch").get(0).checked){$("#settings-page #settings-always-lock-screen-switch").removeAttr("checked")}else{$("#settings-page #settings-always-lock-screen-switch").attr("checked",true)}})});$("#settings-page .page__content").on("scroll",utopiasoftware.saveup.controller.settingsPageViewModel.pageContentScrolled);if(!utopiasoftware.saveup.model.appUserDetails.settings||utopiasoftware.saveup.model.appUserDetails.settings.alwaysShowSecurityLockModal!=false){$("#settings-page #settings-always-lock-screen-switch").attr("checked",true)}else{$("#settings-page #settings-always-lock-screen-switch").removeAttr("checked")}$("#settings-page .progress").css("visibility","hidden");$("#loader-modal").get(0).hide()}},pageShow:function pageShow(event){var $thisPage=$(event.target);$("ons-splitter-side").attr("swipeable",true)},pageContentScrolled:function pageContentScrolled(event){utopiasoftware.saveup.controller.settingsPageViewModel.currentScrollPosition=$(this).scrollTop();if(utopiasoftware.saveup.controller.settingsPageViewModel.currentScrollPosition>utopiasoftware.saveup.controller.settingsPageViewModel.previousScrollPosition){utopiasoftware.saveup.controller.settingsPageViewModel.previousScrollPosition=utopiasoftware.saveup.controller.settingsPageViewModel.currentScrollPosition;if(140-utopiasoftware.saveup.controller.settingsPageViewModel.currentScrollPosition<=56){if(this.isToolBarOpaque!=true){$("#settings-page ons-toolbar").removeClass("toolbar--transparent");$("#settings-page ons-list-header").css({display:"block",position:"fixed",top:"56px",width:"100%"});this.isToolBarOpaque=true}}return}if(utopiasoftware.saveup.controller.settingsPageViewModel.currentScrollPosition<utopiasoftware.saveup.controller.settingsPageViewModel.previousScrollPosition){utopiasoftware.saveup.controller.settingsPageViewModel.previousScrollPosition=utopiasoftware.saveup.controller.settingsPageViewModel.currentScrollPosition;if(140-utopiasoftware.saveup.controller.settingsPageViewModel.currentScrollPosition>56){if(this.isToolBarOpaque==true){$("#settings-page ons-toolbar").addClass("toolbar--transparent");$("#settings-page ons-list-header").css({display:"block",position:"static",top:"56px"});this.isToolBarOpaque=false}}return}},settingsMenuListClicked:function settingsMenuListClicked(label,event){if(label=="update profile"){ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#app-main-navigator").get(0).pushPage("update-profile-page.html",{animation:"slide-md"})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}if(label=="change secure pin"){ons.notification.prompt({title:"Security Check",id:"pin-security-check",class:"utopiasoftware-no-style",messageHTML:'<div><ons-icon icon="ion-lock-combination" size="24px" '+'style="color: #b388ff; float: left; width: 26px;"></ons-icon> <span style="float: right; width: calc(100% - 26px);">'+"Please enter your PostCash Secure PIN to proceed</span></div>",cancelable:true,placeholder:"Secure PIN",inputType:"number",defaultValue:"",autofocus:true,submitOnEnter:true}).then(function(userInput){if(userInput===utopiasoftware.saveup.model.appUserDetails.securePin){$("#app-main-navigator").get(0).pushPage("change-pin-page.html",{animation:"slide-md"})}else{ons.notification.alert({title:"Security Check",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>'+"Security check failed. Invalid credentials"+"</span>",cancelable:true})}}).catch(function(){});return}if(label=="always lock screen"){if($(event.target).closest("ons-switch").is("#settings-always-lock-screen-switch")){return}if($("#settings-page #settings-always-lock-screen-switch").get(0).checked){$("#settings-page #settings-always-lock-screen-switch").removeAttr("checked")}else{$("#settings-page #settings-always-lock-screen-switch").attr("checked",true)}$("#settings-page #settings-always-lock-screen-switch").trigger("change");return}}}),_defineProperty(_utopiasoftware$saveu,"updateProfilePageViewModel",{formValidator:null,pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-input input",$thisPage).addClass("utopiasoftware-no-style");loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){$("#app-main-navigator").get(0).popPage({})};utopiasoftware.saveup.controller.updateProfilePageViewModel.formValidator=$("#update-profile-form").parsley();$("#update-profile-button").get(0).onclick=function(){utopiasoftware.saveup.controller.updateProfilePageViewModel.formValidator.whenValidate()};utopiasoftware.saveup.controller.updateProfilePageViewModel.formValidator.on("field:error",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").addClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").attr("data-hint",fieldInstance.getErrorsMessages()[0])});utopiasoftware.saveup.controller.updateProfilePageViewModel.formValidator.on("field:success",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").removeAttr("data-hint")});utopiasoftware.saveup.controller.updateProfilePageViewModel.formValidator.on("form:success",utopiasoftware.saveup.controller.updateProfilePageViewModel.updateProfileFormValidated);$("#update-profile-first-name",$thisPage).val(utopiasoftware.saveup.model.appUserDetails.firstName);$("#update-profile-last-name",$thisPage).val(utopiasoftware.saveup.model.appUserDetails.lastName);if(utopiasoftware.saveup.model.appUserDetails.email&&utopiasoftware.saveup.model.appUserDetails.email!=""){$("#update-profile-email",$thisPage).val(utopiasoftware.saveup.model.appUserDetails.email)}Materialize.updateTextFields();$(".progress",$thisPage).remove();$("#update-profile-button",$thisPage).removeAttr("disabled");$("#loader-modal").get(0).hide()}},pageHide:function pageHide(event){try{$("#update-profile-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#update-profile-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.updateProfilePageViewModel.formValidator.reset()}catch(err){}},pageDestroy:function pageDestroy(event){try{$("#update-profile-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#update-profile-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.updateProfilePageViewModel.formValidator.destroy()}catch(err){}},updateProfileFormValidated:function updateProfileFormValidated(){$("#loader-modal-message").html("Updating User Profile...");Promise.resolve($("#loader-modal").get(0).show()).then(function(){utopiasoftware.saveup.model.appUserDetails.firstName=$("#update-profile-form #update-profile-first-name").val();utopiasoftware.saveup.model.appUserDetails.lastName=$("#update-profile-form #update-profile-last-name").val();if($("#update-profile-form #update-profile-email").val()!=""){utopiasoftware.saveup.model.appUserDetails.email=$("#update-profile-form #update-profile-email").val()}return utopiasoftware.saveup.model.appUserDetails}).then(function(appUserDetails){return Promise.resolve(intel.security.secureData.createFromData({data:JSON.stringify(appUserDetails)}))}).then(function(instanceId){return Promise.resolve(intel.security.secureStorage.write({id:"postcash-user-details",instanceID:instanceId}))}).then(function(){$("#loader-modal").get(0).hide();window.localStorage.setItem("app-status",utopiasoftware.saveup.model.appUserDetails.phoneNumber);$("#side-menu-username").html(utopiasoftware.saveup.model.appUserDetails.firstName);Materialize.toast("Profile updated",4e3)}).catch(function(err){$("#loader-modal").get(0).hide();ons.notification.alert({title:"Profile Update Failed",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>sorry, your profile could not be updated.<br> You can try again</span>',cancelable:false})})}}),_defineProperty(_utopiasoftware$saveu,"changePinPageViewModel",{formValidator:null,pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-input input",$thisPage).addClass("utopiasoftware-no-style");loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){$("#app-main-navigator").get(0).popPage({})};utopiasoftware.saveup.controller.changePinPageViewModel.formValidator=$("#change-pin-form").parsley();$("#change-pin-button").get(0).onclick=function(){utopiasoftware.saveup.controller.changePinPageViewModel.formValidator.whenValidate()};utopiasoftware.saveup.controller.changePinPageViewModel.formValidator.on("field:error",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").addClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").attr("data-hint",fieldInstance.getErrorsMessages()[0])});utopiasoftware.saveup.controller.changePinPageViewModel.formValidator.on("field:success",function(fieldInstance){$(fieldInstance.$element).parent().find("label:eq(0)").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$(fieldInstance.$element).parent().find("label:eq(0)").removeAttr("data-hint")});utopiasoftware.saveup.controller.changePinPageViewModel.formValidator.on("form:success",utopiasoftware.saveup.controller.changePinPageViewModel.changePinFormValidated);$(".progress",$thisPage).remove();$("#change-pin-button",$thisPage).removeAttr("disabled");$("#loader-modal").get(0).hide()}},pageHide:function pageHide(event){try{$("#change-pin-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#change-pin-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.changePinPageViewModel.formValidator.reset()}catch(err){}},pageDestroy:function pageDestroy(event){try{$("#change-pin-page [data-hint]").removeClass("hint--always hint--info hint--medium hint--rounded hint--no-animate");$("#change-pin-page [data-hint]").removeAttr("data-hint");utopiasoftware.saveup.controller.changePinPageViewModel.formValidator.destroy()}catch(err){}},changePinFormValidated:function changePinFormValidated(){$("#loader-modal-message").html("Changing Secure PIN...");Promise.resolve($("#loader-modal").get(0).show()).then(function(){utopiasoftware.saveup.model.appUserDetails.securePin=$("#change-pin-form #change-pin-new-pin").val();return utopiasoftware.saveup.model.appUserDetails}).then(function(appUserDetails){return Promise.resolve(intel.security.secureData.createFromData({data:JSON.stringify(appUserDetails)}))}).then(function(instanceId){return Promise.resolve(intel.security.secureStorage.write({id:"postcash-user-details",instanceID:instanceId}))}).then(function(){return $("#loader-modal").get(0).hide()}).then(function(){$("#app-main-navigator").get(0).popPage({});Materialize.toast("Secure PIN changed",4e3)}).catch(function(err){$("#loader-modal").get(0).hide();ons.notification.alert({title:"PIN Change Failed",messageHTML:'<ons-icon icon="md-close-circle-o" size="30px" '+'style="color: red;"></ons-icon> <span>sorry, your secure PIN could not be changed.<br> You can try again</span>',cancelable:false})})},newPinVisibilityButtonClicked:function newPinVisibilityButtonClicked(buttonElement){if($(buttonElement).attr("data-saveup-visible")==="no"){$("#change-pin-new-pin").css("-webkit-text-security","none");$(buttonElement).find("ons-icon").attr("icon","md-eye-off");$(buttonElement).attr("data-saveup-visible","yes")}else{$("#change-pin-new-pin").css("-webkit-text-security","disc");$(buttonElement).find("ons-icon").attr("icon","md-eye");$(buttonElement).attr("data-saveup-visible","no")}},confirmPinVisibilityButtonClicked:function confirmPinVisibilityButtonClicked(buttonElement){if($(buttonElement).attr("data-saveup-visible")==="no"){$("#change-pin-confirm-pin").css("-webkit-text-security","none");$(buttonElement).find("ons-icon").attr("icon","md-eye-off");$(buttonElement).attr("data-saveup-visible","yes")}else{$("#change-pin-confirm-pin").css("-webkit-text-security","disc");$(buttonElement).find("ons-icon").attr("icon","md-eye");$(buttonElement).attr("data-saveup-visible","no")}}}),_defineProperty(_utopiasoftware$saveu,"contactUsPageViewModel",{pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-input input",$thisPage).addClass("utopiasoftware-no-style");$("ons-splitter-side").removeAttr("swipeable",true);loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){if($("ons-splitter").get(0).left.isOpen){$("ons-splitter").get(0).left.close();return}$("#app-main-navigator").get(0).resetToPage("main-menu-page.html")};$("#loader-modal").get(0).hide()}},pageShow:function pageShow(event){var $thisPage=$(event.target);$("ons-splitter-side").attr("swipeable",true)},contactUsMenuListClicked:function contactUsMenuListClicked(label){if(label=="email"){var security_lock_modal_flag=$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal;$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal=false;new Promise(function(resolve,reject){cordova.plugins.email.open({to:["support+7ee364178e62478c8e60933dd5d594d0@feedback.hockeyapp.net"]},resolve)}).then(function(){$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal=security_lock_modal_flag;utopiasoftware.saveup.controller.onShowSecurityLockModal()}).catch();return}if(label=="direct feedback"){var security_lock_modal_flag=$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal;$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal=false;new(new Promise(function(resolve,reject){hockeyapp.composeFeedback(resolve,reject,false)}).then)(function(){$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal=security_lock_modal_flag;utopiasoftware.saveup.controller.onShowSecurityLockModal()}).catch(function(){$("#app-main-navigator").get(0).topPage.alwaysShowSecurityLockModal=security_lock_modal_flag;utopiasoftware.saveup.controller.onShowSecurityLockModal()});return}if(label=="twitter"){new Promise(function(resolve,reject){appAvailability.check("com.twitter.android",resolve,reject)}).then(function(){startApp.set({action:"ACTION_VIEW",uri:"twitter://user?screen_name=postcash_ng"}).start()}).catch(function(){cordova.InAppBrowser.open("https://twitter.com/postcash_ng?apptimestamp="+Date.now(),"_system")});return}}}),_defineProperty(_utopiasoftware$saveu,"appInfoPageViewModel",{pageInit:function pageInit(event){var $thisPage=$(event.target);$("ons-input input",$thisPage).addClass("utopiasoftware-no-style");$("ons-splitter-side").removeAttr("swipeable",true);loadPageOnAppReady();function loadPageOnAppReady(){if(!ons.isReady()||utopiasoftware.saveup.model.isAppReady===false){setTimeout(loadPageOnAppReady,500);return}$("#app-main-navigator").get(0).topPage.onDeviceBackButton=function(){if($("ons-splitter").get(0).left.isOpen){$("ons-splitter").get(0).left.close();return}if($("#privacy-policy-fixed-modal").data("fixedModalState")==="open"){$("#privacy-policy-fixed-modal .modal-content").scrollTop(0);$("#privacy-policy-fixed-modal").modal("close");return}if($("#terms-of-use-fixed-modal").data("fixedModalState")==="open"){$("#terms-of-use-fixed-modal .modal-content").scrollTop(0);$("#terms-of-use-fixed-modal").modal("close");return}$("#app-main-navigator").get(0).resetToPage("main-menu-page.html")};cordova.getAppVersion.getVersionNumber().then(function(versionNumber){$("#app-info-app-version",$thisPage).html(versionNumber)});$("#app-info-copyright",$thisPage).html((new Date).getFullYear());$("#loader-modal").get(0).hide()}},pageShow:function pageShow(event){var $thisPage=$(event.target);$("ons-splitter-side").attr("swipeable",true)},appInfoMenuListClicked:function appInfoMenuListClicked(label){if(label=="privacy policy"){$("#privacy-policy-fixed-modal").modal("open");return}if(label=="terms of use"){$("#terms-of-use-fixed-modal").modal("open");return}}}),_utopiasoftware$saveu);